=== НАЧАЛО ОБУЧЕНИЯ 2025-09-02 20:49:15 ===

[2025-09-02 20:49:15] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-09-02 20:49:15] Пользователей: все
[2025-09-02 20:49:15] Данных: 100.0%
[2025-09-02 20:49:15] === ЗАГРУЗКА ДАННЫХ ===
[2025-09-02 20:49:15] Загружаем данные...
[2025-09-02 20:49:15] orders: найдено 5 файлов, используем 5
[2025-09-02 20:49:16] orders: 18,887,122 строк (использовано 5 файлов), ~828.1 MB
[2025-09-02 20:49:16] tracker: найдено 200 файлов, используем 200
[2025-09-02 20:49:35] tracker: 1,644,982,482 строк (использовано 200 файлов), ~65693.4 MB
[2025-09-02 20:49:35] items: найдено 100 файлов, используем 100
[2025-09-02 20:49:41] items: 6,439,422 строк (использовано 100 файлов), ~1134.2 MB
[2025-09-02 20:49:41] categories: найдено 1 файлов, используем 1
[2025-09-02 20:49:41] categories: 7,012 строк (использовано 1 файлов), ~1.7 MB
[2025-09-02 20:49:41] test_users: найдено 1 файлов, используем 1
[2025-09-02 20:49:41] test_users: 470,347 строк (использовано 1 файлов), ~1.8 MB
[2025-09-02 20:49:41] Данные загружены
[2025-09-02 20:49:41] Фильтрация данных...
[2025-09-02 20:49:41] Фильтрация завершена
[2025-09-02 20:49:41] Загрузка данных завершена за 0:00:25.673023
[2025-09-02 20:49:41] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-09-02 20:49:41] Оптимизированная потоковая загрузка эмбеддингов... без PCA
[2025-09-02 20:50:02] Загружено эмбеддингов для 6342024 товаров
[2025-09-02 20:50:03] Загружено сырых эмбеддингов: 6342024
[2025-09-02 20:50:03] Размерность исходных эмбеддингов: 512
[2025-09-02 20:50:03] Анализ дисперсии эмбеддингов...
[2025-09-02 20:50:52] Оптимальное число компонент PCA: 354
[2025-09-02 20:50:52] Объясненная дисперсия: 95.033%
[2025-09-02 20:51:28] График PCA сохранен: /home/root6/python/e_cup/rec_system/pca_variance.png
[2025-09-02 20:51:28] Используем 100 компонент PCA (оптимально: 354, лимит: 100)
[2025-09-02 20:51:39] Обучение PCA на выборке из 100000 эмбеддингов...
[2025-09-02 20:51:45] PCA: сохранено 65.92% дисперсии в 100 компонентах
[2025-09-02 20:51:45] Применение PCA ко всем 6342024 эмбеддингам батчами...
[2025-09-02 20:52:16] PCA трансформация завершена
[2025-09-02 20:52:40] Модель PCA сохранена: /home/root6/python/e_cup/rec_system/data/processed/embeddings_pca_pca.pkl
[2025-09-02 20:52:40] Модель Scaler сохранена: /home/root6/python/e_cup/rec_system/data/processed/embeddings_pca_scaler.pkl
[2025-09-02 20:52:40] Пример ключей в embeddings_dict: [16450600, 26171495, 32624500, 50387994, 87041801]
[2025-09-02 20:52:40] Пример значения после PCA: [1.773178   0.19312248 1.4446566  5.2885127  3.7086885 ]
[2025-09-02 20:52:40] Размерность после PCA: 100
[2025-09-02 20:52:40] Загрузка эмбеддингов с PCA завершена за 0:02:59.215692
[2025-09-02 20:52:40] Загружено эмбеддингов: 6342024
[2025-09-02 20:52:41] === SPLIT ДАННЫХ ===
[2025-09-02 20:52:53] Split данных завершен за 0:00:12.310947
[2025-09-02 20:52:53] Train orders: 13755583, Test orders: 3438892
[2025-09-02 20:52:53] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-09-02 20:52:53] Формируем матрицу взаимодействий по батчам...
[2025-09-02 20:52:53] ... обработка orders
[2025-09-02 20:52:53] Сохранен orders-батч 0-1000000
[2025-09-02 20:52:54] Сохранен orders-батч 1000000-2000000
[2025-09-02 20:52:54] Сохранен orders-батч 2000000-3000000
[2025-09-02 20:52:54] Сохранен orders-батч 3000000-4000000
[2025-09-02 20:52:54] Сохранен orders-батч 4000000-5000000
[2025-09-02 20:52:54] Сохранен orders-батч 5000000-6000000
[2025-09-02 20:52:55] Сохранен orders-батч 6000000-7000000
[2025-09-02 20:52:55] Сохранен orders-батч 7000000-8000000
[2025-09-02 20:52:55] Сохранен orders-батч 8000000-9000000
[2025-09-02 20:52:55] Сохранен orders-батч 9000000-10000000
[2025-09-02 20:52:55] Сохранен orders-батч 10000000-11000000
[2025-09-02 20:52:56] Сохранен orders-батч 11000000-12000000
[2025-09-02 20:52:56] Сохранен orders-батч 12000000-13000000
[2025-09-02 20:52:56] Сохранен orders-батч 13000000-13755583
[2025-09-02 20:52:56] ... обработка tracker
[2025-09-02 20:52:56] Обрабатываем 10 файлов tracker
[2025-09-02 20:52:57] Обработан tracker файл 0: 5204228 строк
[2025-09-02 20:52:58] Обработан tracker файл 1: 5088402 строк
[2025-09-02 20:53:00] Обработан tracker файл 2: 5045487 строк
[2025-09-02 20:53:01] Обработан tracker файл 3: 4987285 строк
[2025-09-02 20:53:02] Обработан tracker файл 4: 4989096 строк
[2025-09-02 20:53:03] Обработан tracker файл 5: 5219465 строк
[2025-09-02 20:53:05] Обработан tracker файл 6: 5030300 строк
[2025-09-02 20:53:06] Обработан tracker файл 7: 5186810 строк
[2025-09-02 20:53:07] Обработан tracker файл 8: 5120177 строк
[2025-09-02 20:53:08] Обработан tracker файл 9: 5067673 строк
[2025-09-02 20:53:08] ✅ Все файлы успешно созданы
[2025-09-02 20:53:08] Всего файлов взаимодействий: 24
[2025-09-02 20:53:08] Подготовка взаимодействий завершена за 0:00:15.244645
[2025-09-02 20:53:08] Создано файлов взаимодействий: 24
[2025-09-02 20:53:08] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-09-02 20:53:26] Словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/recent_items_map.pkl
[2025-09-02 20:53:26] Построение recent items map завершено за 0:00:17.531707
[2025-09-02 20:53:26] Пользователей с recent items: 960818
[2025-09-02 20:53:26] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-09-02 20:53:26] Первый проход: построение маппингов...
[2025-09-02 20:53:29] Маппинги построены. Уников: users=960818, items=3972133
[2025-09-02 20:53:29] item_map сохранен: /home/root6/python/e_cup/rec_system/data/processed/item_map.pkl
[2025-09-02 20:53:29] Сохранение батчей на диск...
[2025-09-02 20:53:31] Обучение als_model...
[2025-09-02 20:53:44] Очистка временных файлов...
[2025-09-02 20:53:44] Директория батчей удалена
[2025-09-02 20:53:44] Обучение завершено!
[2025-09-02 20:53:44] Считаем глобальную популярность на основе тренировочных данных...
[2025-09-02 20:53:45] Глобальная популярность рассчитана на 13755580 тренировочных заказах
[2025-09-02 20:53:45] Обучение ALS завершено за 0:00:19.485582
[2025-09-02 20:53:45] Пользователей: 960818, Товаров: 3972133
[2025-09-02 20:53:45] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-09-02 20:53:45] Строим co-purchase матрицу для топ-N товаров...
[2025-09-02 20:53:46] Топ-1000 популярных товаров определены
[2025-09-02 20:55:27] Обрабатываем 15477 корзин с популярными товарами
[2025-09-02 20:55:27] Уникальных популярных товаров: 1000
[2025-09-02 20:55:27] Создаем sparse матрицу из 42752 взаимодействий...
[2025-09-02 20:55:27] Sparse матрица построена: torch.Size([1000, 1000]), ненулевых элементов: 17546
[2025-09-02 20:55:27] Формируем рекомендации...
[2025-09-02 20:55:29] Co-purchase словарь построен для 996 товаров
[2025-09-02 20:55:29] В среднем 12.9 рекомендаций на товар
[2025-09-02 20:55:29] Co-purchase map построен: 996 товаров
[2025-09-02 20:55:39] Построение категорийных маппингов...
[2025-09-02 20:55:41] Категорийные маппинги построены: 6342024 товаров, 478 категорий
[2025-09-02 20:55:41] Построение дополнительных данных завершено за 0:01:55.858268
[2025-09-02 20:55:41] === ПРЕДВАРИТЕЛЬНЫЙ РАСЧЕТ ПРИЗНАКОВ ДЛЯ LGBM ===
[2025-09-02 20:55:41] Построение словаря пользовательских признаков из ТРЕНИРОВОЧНЫХ данных...
[2025-09-02 20:55:42] Агрегация по ЗАКАЗАМ (train)...
[2025-09-02 20:55:43] Словарь пользовательских признаков построен. Записей: 960818
[2025-09-02 20:55:44] User features построены за 0:00:02.390119: 960818 пользователей
[2025-09-02 20:55:44] Построение словаря товарных признаков из ТРЕНИРОВОЧНЫХ данных...
[2025-09-02 20:55:46] Обработка ЗАКАЗОВ (train)...
[2025-09-02 20:55:50] Словарь товарных признаков построен. Записей: 3972133
[2025-09-02 20:55:53] Item features: 3972133 товаров, размер вектора: 6 признаков
[2025-09-02 20:55:53] Порядок признаков: ['item_count', 'item_sum', 'item_orders_count', 'item_max', 'item_mean', 'item_min']
[2025-09-02 20:55:53] item_features_dict[251658241] type=<class 'numpy.ndarray'>, shape=(6,), example=[ 27.        154.25311     1.         27.725887    5.7130785]
[2025-09-02 20:55:53] item_features_dict[192937988] type=<class 'numpy.ndarray'>, shape=(6,), example=[ 1.       16.479185  1.       16.479185 16.479185]
[2025-09-02 20:55:53] item_features_dict[184549381] type=<class 'numpy.ndarray'>, shape=(6,), example=[ 1.       14.722195  1.       14.722195 14.722195]
[2025-09-02 20:55:53] item_features_dict[75497478] type=<class 'numpy.ndarray'>, shape=(6,), example=[ 1.       15.545305  1.       15.545305 15.545305]
[2025-09-02 20:55:53] item_features_dict[25165834] type=<class 'numpy.ndarray'>, shape=(6,), example=[1.        4.7775574 1.        4.7775574 4.7775574]
[2025-09-02 20:56:02] Item features построены за 0:00:18.625132
[2025-09-02 20:56:02] === ПОДГОТОВКА ДАННЫХ ДЛЯ МОДЕЛИ ===
[2025-09-02 20:56:02] Подготовка данных для модели (streaming, polars lazy, батчи)...
[2025-09-02 20:56:02] Тестовые заказы отсутствуют, используем только тренировочные
[2025-09-02 20:56:06] Разделение данных по времени: 2024-12-05 06:00:08 -> 2025-04-22 19:41:17.896000 (train) | 2025-04-22 19:41:17.896000 -> 2025-05-27 11:06:35.370000 (val)
[2025-09-02 20:56:42] ✅ Данные подготовлены. Train: 13896566 строк, Val: 5360460 строк
[2025-09-02 20:56:43] Размер train: 13896566, validation: 5360460
[2025-09-02 20:56:43] Признаки: 112
[2025-09-02 20:56:43] Подготовка данных для модели завершена за 0:00:40.300960
[2025-09-02 20:56:43] === ДЕТАЛЬНАЯ ПРОВЕРКА FEATURE GENERATION ===
[2025-09-02 20:56:43] --- ПРОВЕРКА USER FEATURES ---
[2025-09-02 20:56:43] Пример user features для пользователя 1350920:
[2025-09-02 20:56:43]   user_count: 87
[2025-09-02 20:56:43]   user_mean: 7.303332261685499
[2025-09-02 20:56:43]   user_sum: 635.3899067666384
[2025-09-02 20:56:43]   user_max: 32.347491740244905
[2025-09-02 20:56:43]   user_min: 2.4475508632442313
[2025-09-02 20:56:43]   user_orders_count: 9
[2025-09-02 20:56:43] Пользователей с features: 960818
[2025-09-02 20:56:43] Пользователей с НЕнулевыми features: 960818
[2025-09-02 20:56:43] --- ПРОВЕРКА ITEM FEATURES ---
[2025-09-02 20:56:43] Пример item features для товара 251658241:
[2025-09-02 20:56:43]   emb_0: 27.0
[2025-09-02 20:56:43]   emb_1: 154.25311279296875
[2025-09-02 20:56:43]   emb_2: 1.0
[2025-09-02 20:56:43]   emb_3: 27.725887298583984
[2025-09-02 20:56:43]   emb_4: 5.713078498840332
[2025-09-02 20:56:43]   emb_5: 1.576914668083191
[2025-09-02 20:56:50] Товаров с features: 3972133
[2025-09-02 20:56:50] Товаров с НЕнулевыми features: 3972133
[2025-09-02 20:56:50] --- ПРОВЕРКА ЭМБЕДДИНГОВ ---
[2025-09-02 20:56:50] Пример эмбеддинга для товара 16450600: shape (100,)
[2025-09-02 20:56:50] Эмбеддингов загружено: 6342024
[2025-09-02 20:56:50] Пример значений: [1.773178   0.19312248 1.4446566  5.2885127  3.7086885 ]
[2025-09-02 20:56:50] --- ПРОВЕРКА CO-PURCHASE MAP ---
[2025-09-02 20:56:50] Пример co-purchase для товара 51974017: 20 товаров
[2025-09-02 20:56:50] Co-purchase записей: 996
[2025-09-02 20:56:50] --- ПРОВЕРКА КАТЕГОРИЙНЫХ МАППИНГОВ ---
[2025-09-02 20:56:50] Товар 5264590 -> категория 36517
[2025-09-02 20:56:50] Категория 36517 -> 12044 товаров
[2025-09-02 20:56:50] Товаров в маппинге: 6342024
[2025-09-02 20:56:50] Категорий в маппинге: 478
[2025-09-02 20:56:50] Проверка признаков завершена за 0:00:07.264957
[2025-09-02 20:56:50] === ОБУЧЕНИЕ МОДЕЛИ ===
[2025-09-02 20:56:59] === ДЕБАГ ИНФОРМАЦИЯ: TRAIN ===
[2025-09-02 20:56:59] Размер: 13896566 строк
[2025-09-02 20:56:59] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'timestamp', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'item_feat_0', 'item_feat_1', 'item_feat_2', 'item_feat_3', 'item_feat_4', 'item_feat_5', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'emb_12', 'emb_13', 'emb_14', 'emb_15', 'emb_16', 'emb_17', 'emb_18', 'emb_19', 'emb_20', 'emb_21', 'emb_22', 'emb_23', 'emb_24', 'emb_25', 'emb_26', 'emb_27', 'emb_28', 'emb_29', 'emb_30', 'emb_31', 'emb_32', 'emb_33', 'emb_34', 'emb_35', 'emb_36', 'emb_37', 'emb_38', 'emb_39', 'emb_40', 'emb_41', 'emb_42', 'emb_43', 'emb_44', 'emb_45', 'emb_46', 'emb_47', 'emb_48', 'emb_49', 'emb_50', 'emb_51', 'emb_52', 'emb_53', 'emb_54', 'emb_55', 'emb_56', 'emb_57', 'emb_58', 'emb_59', 'emb_60', 'emb_61', 'emb_62', 'emb_63', 'emb_64', 'emb_65', 'emb_66', 'emb_67', 'emb_68', 'emb_69', 'emb_70', 'emb_71', 'emb_72', 'emb_73', 'emb_74', 'emb_75', 'emb_76', 'emb_77', 'emb_78', 'emb_79', 'emb_80', 'emb_81', 'emb_82', 'emb_83', 'emb_84', 'emb_85', 'emb_86', 'emb_87', 'emb_88', 'emb_89', 'emb_90', 'emb_91', 'emb_92', 'emb_93', 'emb_94', 'emb_95', 'emb_96', 'emb_97', 'emb_98', 'emb_99']
[2025-09-02 20:56:59] ✅ Все признаки присутствуют
[2025-09-02 20:56:59] Целевая переменная: {1: np.int64(7852347), 0: np.int64(6044219)}
[2025-09-02 20:56:59] Пример первой строки:
[2025-09-02 20:56:59]   item_id: 85504661
[2025-09-02 20:56:59]   user_id: 716900
[2025-09-02 20:56:59]   created_timestamp: 2025-02-03 11:37:54.956000
[2025-09-02 20:56:59]   last_status: canceled_orders
[2025-09-02 20:56:59]   target: 0
[2025-09-02 20:56:59]   timestamp: 2025-02-03 11:37:54.956000
[2025-09-02 20:56:59]   weight: 15.763680458068848
[2025-09-02 20:56:59]   user_count: 496.0
[2025-09-02 20:56:59]   user_mean: 6.689961172281077
[2025-09-02 20:56:59]   user_sum: 3318.220741451414
[2025-09-02 20:56:59]   user_max: 33.67295829986474
[2025-09-02 20:56:59]   user_min: 0.36464311358790924
[2025-09-02 20:56:59]   user_orders_count: 82.0
[2025-09-02 20:56:59]   item_feat_0: 1.0
[2025-09-02 20:56:59]   item_feat_1: 15.763680458068848
[2025-09-02 20:56:59]   item_feat_2: 1.0
[2025-09-02 20:56:59]   item_feat_3: 15.763680458068848
[2025-09-02 20:56:59]   item_feat_4: 15.763680458068848
[2025-09-02 20:56:59]   item_feat_5: 15.763680458068848
[2025-09-02 20:56:59]   emb_0: 1.4707049131393433
[2025-09-02 20:56:59]   emb_1: -8.740730285644531
[2025-09-02 20:56:59]   emb_2: 1.4995918273925781
[2025-09-02 20:56:59]   emb_3: -5.170537948608398
[2025-09-02 20:56:59]   emb_4: 0.3304349184036255
[2025-09-02 20:56:59]   emb_5: -0.29514437913894653
[2025-09-02 20:56:59]   emb_6: -0.34892621636390686
[2025-09-02 20:56:59]   emb_7: 6.594141483306885
[2025-09-02 20:56:59]   emb_8: 7.2822418212890625
[2025-09-02 20:56:59]   emb_9: 0.04680861160159111
[2025-09-02 20:56:59]   emb_10: 1.2794077396392822
[2025-09-02 20:56:59]   emb_11: -0.8315637111663818
[2025-09-02 20:56:59]   emb_12: -2.0542197227478027
[2025-09-02 20:56:59]   emb_13: -1.4410057067871094
[2025-09-02 20:56:59]   emb_14: -1.5437291860580444
[2025-09-02 20:56:59]   emb_15: 1.5755552053451538
[2025-09-02 20:56:59]   emb_16: 3.0432088375091553
[2025-09-02 20:56:59]   emb_17: 0.5812583565711975
[2025-09-02 20:56:59]   emb_18: 2.862295150756836
[2025-09-02 20:56:59]   emb_19: 3.6831130981445312
[2025-09-02 20:56:59]   emb_20: 0.45250463485717773
[2025-09-02 20:56:59]   emb_21: -2.1408627033233643
[2025-09-02 20:56:59]   emb_22: 2.231489419937134
[2025-09-02 20:56:59]   emb_23: -1.4406867027282715
[2025-09-02 20:56:59]   emb_24: -1.0290545225143433
[2025-09-02 20:56:59]   emb_25: 1.9169080257415771
[2025-09-02 20:56:59]   emb_26: 1.0454894304275513
[2025-09-02 20:56:59]   emb_27: -2.1220946311950684
[2025-09-02 20:56:59]   emb_28: -1.7863249778747559
[2025-09-02 20:56:59]   emb_29: -0.8485526442527771
[2025-09-02 20:56:59]   emb_30: -3.3723301887512207
[2025-09-02 20:56:59]   emb_31: -0.14653299748897552
[2025-09-02 20:56:59]   emb_32: 0.44978517293930054
[2025-09-02 20:56:59]   emb_33: -0.4868934750556946
[2025-09-02 20:56:59]   emb_34: -1.2498646974563599
[2025-09-02 20:56:59]   emb_35: -1.475280523300171
[2025-09-02 20:56:59]   emb_36: 0.7262014150619507
[2025-09-02 20:56:59]   emb_37: -0.02229217439889908
[2025-09-02 20:56:59]   emb_38: -0.6656146049499512
[2025-09-02 20:56:59]   emb_39: -1.4595582485198975
[2025-09-02 20:56:59]   emb_40: -0.8350205421447754
[2025-09-02 20:56:59]   emb_41: 3.29453182220459
[2025-09-02 20:56:59]   emb_42: 0.821083664894104
[2025-09-02 20:56:59]   emb_43: 1.930247187614441
[2025-09-02 20:56:59]   emb_44: 2.2065083980560303
[2025-09-02 20:56:59]   emb_45: -0.9742640852928162
[2025-09-02 20:56:59]   emb_46: -0.32380378246307373
[2025-09-02 20:56:59]   emb_47: 2.455275058746338
[2025-09-02 20:56:59]   emb_48: 0.05380041152238846
[2025-09-02 20:56:59]   emb_49: -1.1529403924942017
[2025-09-02 20:56:59]   emb_50: 2.1825530529022217
[2025-09-02 20:56:59]   emb_51: 1.8952960968017578
[2025-09-02 20:56:59]   emb_52: 0.8876428604125977
[2025-09-02 20:56:59]   emb_53: 0.08791259676218033
[2025-09-02 20:56:59]   emb_54: -0.48749682307243347
[2025-09-02 20:56:59]   emb_55: 0.7111715078353882
[2025-09-02 20:56:59]   emb_56: -0.05459057539701462
[2025-09-02 20:56:59]   emb_57: 1.9262863397598267
[2025-09-02 20:56:59]   emb_58: 1.2179709672927856
[2025-09-02 20:56:59]   emb_59: -0.3023562431335449
[2025-09-02 20:56:59]   emb_60: 0.9502768516540527
[2025-09-02 20:56:59]   emb_61: -1.8442142009735107
[2025-09-02 20:56:59]   emb_62: 0.35566407442092896
[2025-09-02 20:56:59]   emb_63: 0.9315341114997864
[2025-09-02 20:56:59]   emb_64: 0.16677507758140564
[2025-09-02 20:56:59]   emb_65: -0.27286991477012634
[2025-09-02 20:56:59]   emb_66: -0.7680991291999817
[2025-09-02 20:56:59]   emb_67: 1.2226213216781616
[2025-09-02 20:56:59]   emb_68: 0.33213165402412415
[2025-09-02 20:56:59]   emb_69: -1.0222177505493164
[2025-09-02 20:56:59]   emb_70: 1.015533685684204
[2025-09-02 20:56:59]   emb_71: -0.38286319375038147
[2025-09-02 20:56:59]   emb_72: 0.4229549765586853
[2025-09-02 20:56:59]   emb_73: -0.6699120402336121
[2025-09-02 20:56:59]   emb_74: -0.3467006981372833
[2025-09-02 20:56:59]   emb_75: 0.030098946765065193
[2025-09-02 20:56:59]   emb_76: 0.19395245611667633
[2025-09-02 20:56:59]   emb_77: -0.2594981789588928
[2025-09-02 20:56:59]   emb_78: 0.5090214014053345
[2025-09-02 20:56:59]   emb_79: -0.28408870100975037
[2025-09-02 20:56:59]   emb_80: -0.6075162887573242
[2025-09-02 20:56:59]   emb_81: 0.6993895173072815
[2025-09-02 20:56:59]   emb_82: -1.4827661514282227
[2025-09-02 20:56:59]   emb_83: 0.06407008320093155
[2025-09-02 20:56:59]   emb_84: -0.07833395153284073
[2025-09-02 20:56:59]   emb_85: 0.7316877841949463
[2025-09-02 20:56:59]   emb_86: 0.37794381380081177
[2025-09-02 20:56:59]   emb_87: -0.33279263973236084
[2025-09-02 20:56:59]   emb_88: 0.14542905986309052
[2025-09-02 20:56:59]   emb_89: -0.9690290093421936
[2025-09-02 20:56:59]   emb_90: -0.00800995621830225
[2025-09-02 20:56:59]   emb_91: -0.9328984022140503
[2025-09-02 20:56:59]   emb_92: 0.3410501182079315
[2025-09-02 20:56:59]   emb_93: 0.4621694087982178
[2025-09-02 20:56:59]   emb_94: 0.24132798612117767
[2025-09-02 20:56:59]   emb_95: 0.1715281754732132
[2025-09-02 20:56:59]   emb_96: 0.13635557889938354
[2025-09-02 20:56:59]   emb_97: 0.10853356868028641
[2025-09-02 20:56:59]   emb_98: -0.23787237703800201
[2025-09-02 20:56:59]   emb_99: 0.13733302056789398
[2025-09-02 20:56:59] === ДЕБАГ ИНФОРМАЦИЯ: VAL ===
[2025-09-02 20:56:59] Размер: 5360460 строк
[2025-09-02 20:56:59] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'timestamp', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'item_feat_0', 'item_feat_1', 'item_feat_2', 'item_feat_3', 'item_feat_4', 'item_feat_5', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'emb_12', 'emb_13', 'emb_14', 'emb_15', 'emb_16', 'emb_17', 'emb_18', 'emb_19', 'emb_20', 'emb_21', 'emb_22', 'emb_23', 'emb_24', 'emb_25', 'emb_26', 'emb_27', 'emb_28', 'emb_29', 'emb_30', 'emb_31', 'emb_32', 'emb_33', 'emb_34', 'emb_35', 'emb_36', 'emb_37', 'emb_38', 'emb_39', 'emb_40', 'emb_41', 'emb_42', 'emb_43', 'emb_44', 'emb_45', 'emb_46', 'emb_47', 'emb_48', 'emb_49', 'emb_50', 'emb_51', 'emb_52', 'emb_53', 'emb_54', 'emb_55', 'emb_56', 'emb_57', 'emb_58', 'emb_59', 'emb_60', 'emb_61', 'emb_62', 'emb_63', 'emb_64', 'emb_65', 'emb_66', 'emb_67', 'emb_68', 'emb_69', 'emb_70', 'emb_71', 'emb_72', 'emb_73', 'emb_74', 'emb_75', 'emb_76', 'emb_77', 'emb_78', 'emb_79', 'emb_80', 'emb_81', 'emb_82', 'emb_83', 'emb_84', 'emb_85', 'emb_86', 'emb_87', 'emb_88', 'emb_89', 'emb_90', 'emb_91', 'emb_92', 'emb_93', 'emb_94', 'emb_95', 'emb_96', 'emb_97', 'emb_98', 'emb_99']
[2025-09-02 20:56:59] ✅ Все признаки присутствуют
[2025-09-02 20:56:59] Целевая переменная: {1: np.int64(2965348), 0: np.int64(2395112)}
[2025-09-02 20:56:59] Пример первой строки:
[2025-09-02 20:56:59]   item_id: 66297784
[2025-09-02 20:56:59]   user_id: 4652091
[2025-09-02 20:56:59]   created_timestamp: 2025-05-25 20:00:44.200000
[2025-09-02 20:56:59]   last_status: canceled_orders
[2025-09-02 20:56:59]   target: 0
[2025-09-02 20:56:59]   timestamp: 2025-05-25 20:00:44.200000
[2025-09-02 20:56:59]   weight: 0.9116078019142151
[2025-09-02 20:56:59]   user_count: 103.0
[2025-09-02 20:56:59]   user_mean: 6.941105764464006
[2025-09-02 20:56:59]   user_sum: 714.9338937397927
[2025-09-02 20:56:59]   user_max: 28.094026953624972
[2025-09-02 20:56:59]   user_min: 0.6729444732424259
[2025-09-02 20:56:59]   user_orders_count: 37.0
[2025-09-02 20:56:59]   item_feat_0: 1.0
[2025-09-02 20:56:59]   item_feat_1: 0.9116078019142151
[2025-09-02 20:56:59]   item_feat_2: 1.0
[2025-09-02 20:56:59]   item_feat_3: 0.9116078019142151
[2025-09-02 20:56:59]   item_feat_4: 0.9116078019142151
[2025-09-02 20:56:59]   item_feat_5: 0.9116078019142151
[2025-09-02 20:56:59]   emb_0: -1.8059720993041992
[2025-09-02 20:56:59]   emb_1: -5.6486077308654785
[2025-09-02 20:56:59]   emb_2: 2.5272626876831055
[2025-09-02 20:56:59]   emb_3: -1.6091281175613403
[2025-09-02 20:56:59]   emb_4: -0.29519712924957275
[2025-09-02 20:56:59]   emb_5: -6.030242919921875
[2025-09-02 20:56:59]   emb_6: 0.3599841594696045
[2025-09-02 20:56:59]   emb_7: 6.168976783752441
[2025-09-02 20:56:59]   emb_8: 1.2688125371932983
[2025-09-02 20:56:59]   emb_9: -0.9276689291000366
[2025-09-02 20:56:59]   emb_10: -1.863680124282837
[2025-09-02 20:56:59]   emb_11: -3.554293155670166
[2025-09-02 20:56:59]   emb_12: -1.7256733179092407
[2025-09-02 20:56:59]   emb_13: -0.4303957223892212
[2025-09-02 20:56:59]   emb_14: 2.1859941482543945
[2025-09-02 20:56:59]   emb_15: -0.7180168628692627
[2025-09-02 20:56:59]   emb_16: -2.842073917388916
[2025-09-02 20:56:59]   emb_17: 0.3865481913089752
[2025-09-02 20:56:59]   emb_18: 2.415562152862549
[2025-09-02 20:56:59]   emb_19: 0.7208105325698853
[2025-09-02 20:56:59]   emb_20: -2.358342170715332
[2025-09-02 20:56:59]   emb_21: 0.4306977391242981
[2025-09-02 20:56:59]   emb_22: 2.0895512104034424
[2025-09-02 20:56:59]   emb_23: -2.203268051147461
[2025-09-02 20:56:59]   emb_24: 2.752732992172241
[2025-09-02 20:56:59]   emb_25: -1.0717543363571167
[2025-09-02 20:56:59]   emb_26: -0.5418018102645874
[2025-09-02 20:56:59]   emb_27: -1.8728500604629517
[2025-09-02 20:56:59]   emb_28: 1.0961182117462158
[2025-09-02 20:56:59]   emb_29: 0.3573046922683716
[2025-09-02 20:56:59]   emb_30: 4.547506332397461
[2025-09-02 20:56:59]   emb_31: 0.23334334790706635
[2025-09-02 20:56:59]   emb_32: -0.4160667657852173
[2025-09-02 20:56:59]   emb_33: -0.7347527146339417
[2025-09-02 20:56:59]   emb_34: 1.0637762546539307
[2025-09-02 20:56:59]   emb_35: 0.7386796474456787
[2025-09-02 20:56:59]   emb_36: -0.18347279727458954
[2025-09-02 20:56:59]   emb_37: -0.6502373218536377
[2025-09-02 20:56:59]   emb_38: 0.06505794078111649
[2025-09-02 20:56:59]   emb_39: 0.4656664729118347
[2025-09-02 20:56:59]   emb_40: 0.09682078659534454
[2025-09-02 20:56:59]   emb_41: 0.55963134765625
[2025-09-02 20:56:59]   emb_42: -1.157637357711792
[2025-09-02 20:56:59]   emb_43: -0.00010834822751348838
[2025-09-02 20:56:59]   emb_44: 1.5597991943359375
[2025-09-02 20:56:59]   emb_45: -1.39298415184021
[2025-09-02 20:56:59]   emb_46: -0.8029770255088806
[2025-09-02 20:56:59]   emb_47: 1.244349479675293
[2025-09-02 20:56:59]   emb_48: -0.4424670338630676
[2025-09-02 20:56:59]   emb_49: -0.9872400760650635
[2025-09-02 20:56:59]   emb_50: -1.1866509914398193
[2025-09-02 20:56:59]   emb_51: -0.583649754524231
[2025-09-02 20:56:59]   emb_52: -2.0695481300354004
[2025-09-02 20:56:59]   emb_53: 0.10724923759698868
[2025-09-02 20:56:59]   emb_54: 0.5903207659721375
[2025-09-02 20:56:59]   emb_55: 1.2589821815490723
[2025-09-02 20:56:59]   emb_56: -0.2925429046154022
[2025-09-02 20:56:59]   emb_57: 1.0498123168945312
[2025-09-02 20:56:59]   emb_58: 0.4849494695663452
[2025-09-02 20:56:59]   emb_59: 2.4537792205810547
[2025-09-02 20:56:59]   emb_60: 0.4367280900478363
[2025-09-02 20:56:59]   emb_61: -0.18911871314048767
[2025-09-02 20:56:59]   emb_62: 0.5568954944610596
[2025-09-02 20:56:59]   emb_63: -0.6076654195785522
[2025-09-02 20:56:59]   emb_64: -0.3718556761741638
[2025-09-02 20:56:59]   emb_65: -0.19345879554748535
[2025-09-02 20:56:59]   emb_66: 0.42903733253479004
[2025-09-02 20:56:59]   emb_67: 0.6378456354141235
[2025-09-02 20:56:59]   emb_68: 0.4485538899898529
[2025-09-02 20:56:59]   emb_69: 0.9108060598373413
[2025-09-02 20:56:59]   emb_70: -0.06939621269702911
[2025-09-02 20:56:59]   emb_71: -0.9453636407852173
[2025-09-02 20:56:59]   emb_72: -0.39413613080978394
[2025-09-02 20:56:59]   emb_73: 1.2722855806350708
[2025-09-02 20:56:59]   emb_74: -2.740135669708252
[2025-09-02 20:56:59]   emb_75: 0.7368042469024658
[2025-09-02 20:56:59]   emb_76: 1.6628952026367188
[2025-09-02 20:56:59]   emb_77: -0.25794562697410583
[2025-09-02 20:56:59]   emb_78: 0.41098839044570923
[2025-09-02 20:56:59]   emb_79: 0.41415590047836304
[2025-09-02 20:56:59]   emb_80: -0.42638131976127625
[2025-09-02 20:56:59]   emb_81: 0.7036243677139282
[2025-09-02 20:56:59]   emb_82: -0.12631791830062866
[2025-09-02 20:56:59]   emb_83: -0.34949639439582825
[2025-09-02 20:56:59]   emb_84: 0.20767226815223694
[2025-09-02 20:56:59]   emb_85: 0.8810520172119141
[2025-09-02 20:56:59]   emb_86: 0.37186199426651
[2025-09-02 20:56:59]   emb_87: -2.0853285789489746
[2025-09-02 20:56:59]   emb_88: 0.005140854977071285
[2025-09-02 20:56:59]   emb_89: -1.7131181955337524
[2025-09-02 20:56:59]   emb_90: -1.010206937789917
[2025-09-02 20:56:59]   emb_91: 1.392741084098816
[2025-09-02 20:56:59]   emb_92: 1.3283015489578247
[2025-09-02 20:56:59]   emb_93: 1.0301895141601562
[2025-09-02 20:56:59]   emb_94: -1.425842523574829
[2025-09-02 20:56:59]   emb_95: 1.799600601196289
[2025-09-02 20:56:59]   emb_96: 1.3056203126907349
[2025-09-02 20:56:59]   emb_97: 0.358967661857605
[2025-09-02 20:56:59]   emb_98: 0.691774308681488
[2025-09-02 20:56:59]   emb_99: -0.9984518885612488
[2025-09-02 20:56:59] Feature columns: ['user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'item_feat_0', 'item_feat_1', 'item_feat_2', 'item_feat_3', 'item_feat_4', 'item_feat_5', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'emb_12', 'emb_13', 'emb_14', 'emb_15', 'emb_16', 'emb_17', 'emb_18', 'emb_19', 'emb_20', 'emb_21', 'emb_22', 'emb_23', 'emb_24', 'emb_25', 'emb_26', 'emb_27', 'emb_28', 'emb_29', 'emb_30', 'emb_31', 'emb_32', 'emb_33', 'emb_34', 'emb_35', 'emb_36', 'emb_37', 'emb_38', 'emb_39', 'emb_40', 'emb_41', 'emb_42', 'emb_43', 'emb_44', 'emb_45', 'emb_46', 'emb_47', 'emb_48', 'emb_49', 'emb_50', 'emb_51', 'emb_52', 'emb_53', 'emb_54', 'emb_55', 'emb_56', 'emb_57', 'emb_58', 'emb_59', 'emb_60', 'emb_61', 'emb_62', 'emb_63', 'emb_64', 'emb_65', 'emb_66', 'emb_67', 'emb_68', 'emb_69', 'emb_70', 'emb_71', 'emb_72', 'emb_73', 'emb_74', 'emb_75', 'emb_76', 'emb_77', 'emb_78', 'emb_79', 'emb_80', 'emb_81', 'emb_82', 'emb_83', 'emb_84', 'emb_85', 'emb_86', 'emb_87', 'emb_88', 'emb_89', 'emb_90', 'emb_91', 'emb_92', 'emb_93', 'emb_94', 'emb_95', 'emb_96', 'emb_97', 'emb_98', 'emb_99']
[2025-09-02 20:56:59] 📊 Всего данных для обработки: 13896566 строк
[2025-09-02 20:57:00] 📦 Чанк 1/14 (1000000 строк)
[2025-09-02 20:57:48] 💾 Модель сохранена после чанка 1
[2025-09-02 20:57:48] 📦 Чанк 2/14 (1000000 строк)
[2025-09-02 20:58:02] 💾 Модель сохранена после чанка 2
[2025-09-02 20:58:02] 📦 Чанк 3/14 (1000000 строк)
[2025-09-02 20:58:20] 💾 Модель сохранена после чанка 3
[2025-09-02 20:58:20] 📦 Чанк 4/14 (1000000 строк)
[2025-09-02 20:59:05] 💾 Модель сохранена после чанка 4
[2025-09-02 20:59:05] 📦 Чанк 5/14 (1000000 строк)
[2025-09-02 20:59:19] 💾 Модель сохранена после чанка 5
[2025-09-02 20:59:20] 📦 Чанк 6/14 (1000000 строк)
[2025-09-02 20:59:32] 💾 Модель сохранена после чанка 6
[2025-09-02 20:59:32] 📦 Чанк 7/14 (1000000 строк)
[2025-09-02 21:00:02] 💾 Модель сохранена после чанка 7
[2025-09-02 21:00:02] 📦 Чанк 8/14 (1000000 строк)
[2025-09-02 21:00:18] 💾 Модель сохранена после чанка 8
[2025-09-02 21:00:18] 📦 Чанк 9/14 (1000000 строк)
[2025-09-02 21:00:54] 💾 Модель сохранена после чанка 9
[2025-09-02 21:00:54] 📦 Чанк 10/14 (1000000 строк)
[2025-09-02 21:01:18] 💾 Модель сохранена после чанка 10
[2025-09-02 21:01:18] 📦 Чанк 11/14 (1000000 строк)
[2025-09-02 21:01:45] 💾 Модель сохранена после чанка 11
[2025-09-02 21:01:45] 📦 Чанк 12/14 (1000000 строк)
[2025-09-02 21:02:19] 💾 Модель сохранена после чанка 12
[2025-09-02 21:02:19] 📦 Чанк 13/14 (1000000 строк)
[2025-09-02 21:02:48] 💾 Модель сохранена после чанка 13
[2025-09-02 21:02:48] 📦 Чанк 14/14 (896566 строк)
[2025-09-02 21:03:31] 💾 Модель сохранена после чанка 14
[2025-09-02 21:06:28] 🎯 Финальный NDCG@100 на валидации: 0.903989
[2025-09-02 21:06:28] Обучение модели завершено за 0:09:37.967879
[2025-09-02 21:06:28] === ОЦЕНКА МОДЕЛИ ===
[2025-09-02 21:15:10] NDCG@100 train: 0.9201
[2025-09-02 21:15:10] NDCG@100 val: 0.9040
[2025-09-02 21:15:10] === СОХРАНЕНИЕ МОДЕЛИ И ПРИЗНАКОВ ===
[2025-09-02 21:15:51] Сохранение модели завершено за 0:00:40.852790
[2025-09-02 21:15:51] Модель сохранена в: /home/root6/python/e_cup/rec_system/src/models/model.pkl
[2025-09-02 21:15:51] === ОБУЧЕНИЕ И ПРЕДСКАЗАНИЯ ЗАВЕРШЕНЫ УСПЕШНО ===
[2025-09-02 21:15:51] Общее время выполнения: 0:26:35.286826
[2025-09-02 21:15:51] Пользователей: 960818
[2025-09-02 21:15:51] Товаров: 3972133
[2025-09-02 21:15:51] Признаков: 112
[2025-09-02 21:15:51] === СИСТЕМНАЯ ИНФОРМАЦИЯ ===
[2025-09-02 21:15:51] Видеокарта: NVIDIA GeForce RTX 4090
[2025-09-02 21:15:51] Память GPU: 24.0 GB
[2025-09-02 21:15:51] Процессор: 19.1% загрузки
[2025-09-02 21:15:51] Ядра CPU: 32
[2025-09-02 21:15:51] Частота CPU: 2995.2 MHz
[2025-09-02 21:15:51] Оперативная память: 94.2 GB всего, 59.7 GB использовано
[2025-09-02 21:15:51] ==========================================
[2025-09-02 21:15:51] ВСЕ ЭТАПЫ ВЫПОЛНЕНЫ УСПЕШНО!
[2025-09-02 21:15:51] ==========================================

=== ОБЩЕЕ ВРЕМЯ ВЫПОЛНЕНИЯ: 0:26:35.318667 ===
