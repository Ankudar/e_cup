=== НАЧАЛО ОБУЧЕНИЯ 2025-08-26 17:57:30 ===

[2025-08-26 17:57:30] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-08-26 17:57:30] Пользователей: все
[2025-08-26 17:57:30] Данных: 100.0%
[2025-08-26 17:57:30] === ЗАГРУЗКА ДАННЫХ ===
[2025-08-26 17:57:30] Загружаем данные...
[2025-08-26 17:57:30] orders: 1,000,000 строк (использовано 28 из 28 партиций), ~2.0 MB
[2025-08-26 17:57:31] tracker: 1,000,000 строк (использовано 298 из 298 партиций), ~32.3 MB
[2025-08-26 17:57:31] items: 1,000,000 строк (использовано 200 из 200 партиций), ~7.4 MB
[2025-08-26 17:57:31] categories: 7,012 строк (использовано 1 из 1 партиций), ~1.7 MB
[2025-08-26 17:57:31] test_users: 470,347 строк (использовано 1 из 1 партиций), ~1.8 MB
[2025-08-26 17:57:31] Данные загружены
[2025-08-26 17:57:31] Фильтрация данных...
[2025-08-26 17:57:31] Фильтрация завершена
[2025-08-26 17:57:31] Загрузка данных завершена за 0:00:01.700003
[2025-08-26 17:57:31] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-08-26 17:57:31] Оптимизированная потоковая загрузка эмбеддингов...
[2025-08-26 17:57:32] Загружено эмбеддингов для 43059 товаров
[2025-08-26 17:57:32] Загрузка эмбеддингов завершена за 0:00:00.822670
[2025-08-26 17:57:32] Загружено эмбеддингов: 43059
[2025-08-26 17:57:32] === SPLIT ДАННЫХ ===
[2025-08-26 17:57:32] Split данных завершен за 0:00:00.035190
[2025-08-26 17:57:32] Train orders: 37867, Test orders: 9461
[2025-08-26 17:57:32] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-08-26 17:57:32] Формируем матрицу взаимодействий по батчам...
[2025-08-26 17:57:32] ... для orders
[2025-08-26 17:57:32] Сохранен orders-батч 0-37867
[2025-08-26 17:57:32] ... для tracker
[2025-08-26 17:57:33] Сохранен tracker-партиция 0
[2025-08-26 17:57:33] Все батчи сохранены на диск.
[2025-08-26 17:57:33] Подготовка взаимодействий завершена за 0:00:01.123348
[2025-08-26 17:57:33] Создано файлов взаимодействий: 2
[2025-08-26 17:57:33] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-08-26 17:57:34] Построение recent items map завершено за 0:00:00.323783
[2025-08-26 17:57:34] Пользователей с recent items: 289891
[2025-08-26 17:57:34] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-08-26 17:57:34] Первый проход: построение маппингов...
[2025-08-26 17:57:34] Маппинги построены. Уников: users=289891, items=35645
[2025-08-26 17:57:34] Сохранение батчей на диск...
[2025-08-26 17:57:34] Постепенное обучение...
[2025-08-26 17:57:35] Очистка временных файлов...
[2025-08-26 17:57:35] Директория батчей удалена
[2025-08-26 17:57:35] Обучение завершено!
[2025-08-26 17:57:35] Считаем глобальную популярность на основе тренировочных данных...
[2025-08-26 17:57:35] Глобальная популярность рассчитана на 37861 тренировочных заказах
[2025-08-26 17:57:35] Обучение ALS завершено за 0:00:01.009609
[2025-08-26 17:57:35] Пользователей: 289891, Товаров: 35645
[2025-08-26 17:57:35] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-08-26 17:57:35] Строим co-purchase матрицу для топ-N товаров...
[2025-08-26 17:57:35] Топ-32739 популярных товаров определены
[2025-08-26 17:57:35] Обрабатываем 4229 корзин с популярными товарами
[2025-08-26 17:57:35] Уникальных популярных товаров: 32739
[2025-08-26 17:57:35] Создаем sparse матрицу из 21600 взаимодействий...
[2025-08-26 17:57:35] Sparse матрица построена: torch.Size([32739, 32739]), ненулевых элементов: 21438
[2025-08-26 17:57:35] Формируем рекомендации...
[2025-08-26 17:57:43] Co-purchase словарь построен для 10097 товаров
[2025-08-26 17:57:43] В среднем 2.1 рекомендаций на товар
[2025-08-26 17:57:43] Co-purchase map построен: 10097 товаров
[2025-08-26 17:57:43] Построение категорийных маппингов...
[2025-08-26 17:57:43] Категорийные маппинги построены: 63318 товаров, 419 категорий
[2025-08-26 17:57:43] Построение дополнительных данных завершено за 0:00:08.396330
[2025-08-26 17:57:43] === ПРЕДВАРИТЕЛЬНЫЙ РАСЧЕТ ПРИЗНАКОВ ДЛЯ LGBM ===
[2025-08-26 17:57:43] Построение словаря пользовательских признаков...
[2025-08-26 17:57:43] Агрегация по заказам...
[2025-08-26 17:57:44] Словарь пользовательских признаков построен. Записей: 289892
[2025-08-26 17:57:44] User features построены за 0:00:00.585620: 289892 пользователей
[2025-08-26 17:57:44] Построение словаря товарных признаков...
[2025-08-26 17:57:44] Добавление данных из items_df...
[2025-08-26 17:57:44] Добавление эмбеддингов...
[2025-08-26 17:57:44] Словарь товарных признаков построен. Записей: 35646
[2025-08-26 17:57:44] Item features построены за 0:00:00.378565: 35646 товаров
[2025-08-26 17:57:44] Создание UI-признаков (данные остаются на диске)
[2025-08-26 17:57:44] Создано 2 файлов UI-признаков в: /home/root6/python/e_cup/rec_system/data/processed/ui_features_distributed
[2025-08-26 17:57:44] User-Item features созданы в: /home/root6/python/e_cup/rec_system/data/processed/ui_features_distributed
[2025-08-26 17:57:44] Количество файлов: 2
[2025-08-26 17:57:44] User-Item features построены за 0:00:00.066951
[2025-08-26 17:57:44] Предварительный расчет признаков завершен за 0:00:01.031430
[2025-08-26 17:57:44] === ПОДГОТОВКА ДАННЫХ ДЛЯ LightGBM ===
[2025-08-26 17:57:44] Подготовка данных для LightGBM (streaming)...
