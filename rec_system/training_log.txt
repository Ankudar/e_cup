=== НАЧАЛО ОБУЧЕНИЯ 2025-08-28 16:57:19 ===

[2025-08-28 16:57:19] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-08-28 16:57:19] Пользователей: все
[2025-08-28 16:57:19] Данных: 100.0%
[2025-08-28 16:57:19] === ЗАГРУЗКА ДАННЫХ ===
[2025-08-28 16:57:19] Загружаем данные...
[2025-08-28 16:57:20] orders: 18,887,122 строк (использовано 5 из 5 партиций), ~828.1 MB
[2025-08-28 16:57:21] tracker: 500,000,000 строк (использовано 200 из 200 партиций), ~270.0 MB
[2025-08-28 16:57:27] items: 6,439,422 строк (использовано 200 из 200 партиций), ~1134.2 MB
[2025-08-28 16:57:27] categories: 7,012 строк (использовано 1 из 1 партиций), ~1.7 MB
[2025-08-28 16:57:27] test_users: 470,347 строк (использовано 1 из 1 партиций), ~1.8 MB
[2025-08-28 16:57:27] Данные загружены
[2025-08-28 16:57:27] Фильтрация данных...
[2025-08-28 16:57:28] Фильтрация завершена
[2025-08-28 16:57:28] Загрузка данных завершена за 0:00:08.386478
[2025-08-28 16:57:28] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-08-28 16:57:28] Оптимизированная потоковая загрузка эмбеддингов...
[2025-08-28 16:57:47] Загружено эмбеддингов для 6342024 товаров
[2025-08-28 16:58:31] Пример ключей в embeddings_dict: [400301, 678602, 746401, 872829, 893255]
[2025-08-28 16:58:31] Пример значения: [ 0.32023853  0.11766258 -0.784552    0.4168199  -0.24610527]
[2025-08-28 16:58:31] Загрузка эмбеддингов завершена за 0:01:03.664024
[2025-08-28 16:58:31] Загружено эмбеддингов: 6342024
[2025-08-28 16:58:31] === SPLIT ДАННЫХ ===
[2025-08-28 16:58:39] Split данных завершен за 0:00:07.991547
[2025-08-28 16:58:39] Train orders: 14341462, Test orders: 3585364
[2025-08-28 16:58:39] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-08-28 16:58:39] Формируем матрицу взаимодействий по батчам...
[2025-08-28 16:58:39] ... для orders
[2025-08-28 16:58:41] Сохранен orders-батч 0-14341462
[2025-08-28 16:58:41] ... для tracker
[2025-08-28 16:58:43] Сохранен tracker-партиция 0
[2025-08-28 16:58:43] Все батчи сохранены на диск.
[2025-08-28 16:58:43] Подготовка взаимодействий завершена за 0:00:03.847433
[2025-08-28 16:58:43] Создано файлов взаимодействий: 2
[2025-08-28 16:58:43] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-08-28 16:58:48] Словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/recent_items_map.pkl
[2025-08-28 16:58:48] Построение recent items map завершено за 0:00:04.691740
[2025-08-28 16:58:48] Пользователей с recent items: 872198
[2025-08-28 16:58:48] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-08-28 16:58:48] Первый проход: построение маппингов...
[2025-08-28 16:58:49] Маппинги построены. Уников: users=872198, items=3938327
[2025-08-28 16:58:49] item_map сохранен: /home/root6/python/e_cup/rec_system/data/processed/item_map.pkl
[2025-08-28 16:58:49] Сохранение батчей на диск...
[2025-08-28 16:58:50] Постепенное обучение...
[2025-08-28 16:59:05] Очистка временных файлов...
[2025-08-28 16:59:05] Директория батчей удалена
[2025-08-28 16:59:05] Обучение завершено!
[2025-08-28 16:59:05] Считаем глобальную популярность на основе тренировочных данных...
[2025-08-28 16:59:06] Глобальная популярность рассчитана на 14341460 тренировочных заказах
[2025-08-28 16:59:06] Обучение ALS завершено за 0:00:18.654356
[2025-08-28 16:59:06] Пользователей: 872198, Товаров: 3938327
[2025-08-28 16:59:06] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-08-28 16:59:06] Строим co-purchase матрицу для топ-N товаров...
[2025-08-28 16:59:07] Топ-500 популярных товаров определены
[2025-08-28 17:00:48] Обрабатываем 18158 корзин с популярными товарами
[2025-08-28 17:00:48] Уникальных популярных товаров: 500
[2025-08-28 17:00:48] Создаем sparse матрицу из 191808 взаимодействий...
[2025-08-28 17:00:48] Sparse матрица построена: torch.Size([500, 500]), ненулевых элементов: 9247
[2025-08-28 17:00:48] Формируем рекомендации...
[2025-08-28 17:00:49] Co-purchase словарь построен для 500 товаров
[2025-08-28 17:00:49] В среднем 8.8 рекомендаций на товар
[2025-08-28 17:00:49] Co-purchase map построен: 500 товаров
[2025-08-28 17:00:55] Построение категорийных маппингов...
[2025-08-28 17:00:57] Категорийные маппинги построены: 6342024 товаров, 478 категорий
[2025-08-28 17:00:57] Построение дополнительных данных завершено за 0:01:51.002849
[2025-08-28 17:00:57] === ПРЕДВАРИТЕЛЬНЫЙ РАСЧЕТ ПРИЗНАКОВ ДЛЯ LGBM ===
[2025-08-28 17:00:57] Построение словаря пользовательских признаков...
[2025-08-28 17:00:58] Агрегация по заказам...
[2025-08-28 17:01:02] Словарь пользовательских признаков построен и сохранён в /home/root6/python/e_cup/rec_system/data/processed/cat_to_items.pkl. Записей: 872199
[2025-08-28 17:01:02] User features построены за 0:00:04.938692: 872199 пользователей
[2025-08-28 17:01:02] Построение словаря товарных признаков...
[2025-08-28 17:01:09] Добавление данных из items_df...
[2025-08-28 17:01:41] Добавление эмбеддингов...
[2025-08-28 17:01:51] Словарь товарных признаков построен. Записей: 3938328
[2025-08-28 17:01:57] Item features: 3938328 товаров, размер вектора: 12 признаков
[2025-08-28 17:01:57] Порядок признаков: ['item_count', 'item_mean', 'item_sum', 'item_max', 'item_min', 'item_orders_count', 'item_category', 'fclip_embed_0', 'fclip_embed_1', 'fclip_embed_2']...
[2025-08-28 17:01:58] item_features_dict[293365914] type=<class 'numpy.ndarray'>, shape=(12,), example=[1.        3.1207716 3.1207716 3.1207716 3.1207716]
[2025-08-28 17:01:58] item_features_dict[314627074] type=<class 'numpy.ndarray'>, shape=(12,), example=[1.       8.243293 8.243293 8.243293 8.243293]
[2025-08-28 17:01:58] item_features_dict[319663297] type=<class 'numpy.ndarray'>, shape=(12,), example=[1.       8.178776 8.178776 8.178776 8.178776]
[2025-08-28 17:01:58] item_features_dict[80967937] type=<class 'numpy.ndarray'>, shape=(12,), example=[ 2.         8.3522415 16.704483   8.493345   8.211139 ]
[2025-08-28 17:01:58] item_features_dict[202079503] type=<class 'numpy.ndarray'>, shape=(12,), example=[ 8.         5.2679863 42.14389    7.702225   3.465736 ]
[2025-08-28 17:02:07] Item features построены за 0:01:05.134762
[2025-08-28 17:02:07] === ПОДГОТОВКА ДАННЫХ ДЛЯ LightGBM ===
[2025-08-28 17:02:07] Подготовка данных для LightGBM (streaming, polars lazy, векторно)...
[2025-08-28 17:02:24] Negatives к positive: 0
[2025-08-28 17:02:34] ✅ Данные подготовлены (streaming lazy polars, векторно)
[2025-08-28 17:02:35] Размер train: 17092384, validation: 4257573
[2025-08-28 17:02:35] Признаки: 19
[2025-08-28 17:02:35] Подготовка данных для LightGBM завершена за 0:00:27.429922
[2025-08-28 17:02:35] === ДЕТАЛЬНАЯ ПРОВЕРКА FEATURE GENERATION ===
[2025-08-28 17:02:35] --- ПРОВЕРКА USER FEATURES ---
[2025-08-28 17:02:35] Пример user features для пользователя 364801:
[2025-08-28 17:02:35]   user_count: 41
[2025-08-28 17:02:35]   user_mean: 4.010392175641036
[2025-08-28 17:02:35]   user_sum: 164.42607920128248
[2025-08-28 17:02:35]   user_max: 12.622417124499117
[2025-08-28 17:02:35]   user_min: 0.3083013596545166
[2025-08-28 17:02:35]   user_orders_count: 40
[2025-08-28 17:02:35] Пользователей с features: 872199
[2025-08-28 17:02:35] Пользователей с НЕнулевыми features: 872199
[2025-08-28 17:02:35] --- ПРОВЕРКА ITEM FEATURES ---
[2025-08-28 17:02:35] Пример item features для товара 293365914:
[2025-08-28 17:02:35]   emb_0: 1.0
[2025-08-28 17:02:35]   emb_1: 3.120771646499634
[2025-08-28 17:02:35]   emb_2: 3.120771646499634
[2025-08-28 17:02:35]   emb_3: 3.120771646499634
[2025-08-28 17:02:35]   emb_4: 3.120771646499634
[2025-08-28 17:02:35]   emb_5: 1.0
[2025-08-28 17:02:35]   emb_6: 7502.0
[2025-08-28 17:02:35]   emb_7: -0.1235107034444809
[2025-08-28 17:02:35]   emb_8: 1.014237880706787
[2025-08-28 17:02:35]   emb_9: -0.3997610807418823
[2025-08-28 17:02:35]   emb_10: -0.20177316665649414
[2025-08-28 17:02:35]   emb_11: -0.07670427858829498
[2025-08-28 17:02:42] Товаров с features: 3938328
[2025-08-28 17:02:42] Товаров с НЕнулевыми features: 3938328
[2025-08-28 17:02:42] --- ПРОВЕРКА ЭМБЕДДИНГОВ ---
[2025-08-28 17:02:42] Пример эмбеддинга для товара 400301: shape (512,)
[2025-08-28 17:02:42] Эмбеддингов загружено: 6342024
[2025-08-28 17:02:42] Пример значений: [ 0.32023853  0.11766258 -0.784552    0.4168199  -0.24610527]
[2025-08-28 17:02:42] --- ПРОВЕРКА CO-PURCHASE MAP ---
[2025-08-28 17:02:42] Пример co-purchase для товара 51974017: 10 товаров
[2025-08-28 17:02:42] Co-purchase записей: 500
[2025-08-28 17:02:42] --- ПРОВЕРКА КАТЕГОРИЙНЫХ МАППИНГОВ ---
[2025-08-28 17:02:42] Товар 400301 -> категория 17080
[2025-08-28 17:02:42] Категория 17080 -> 16555 товаров
[2025-08-28 17:02:42] Товаров в маппинге: 6342024
[2025-08-28 17:02:42] Категорий в маппинге: 478
[2025-08-28 17:02:42] Проверка признаков завершена за 0:00:07.451697
[2025-08-28 17:02:42] === ОБУЧЕНИЕ LightGBM ===
[2025-08-28 17:02:45] === ДЕБАГ ИНФОРМАЦИЯ: TRAIN ===
[2025-08-28 17:02:45] Размер: 17092384 строк
[2025-08-28 17:02:45] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'user_count_right', 'user_mean_right', 'user_sum_right', 'user_max_right', 'user_min_right', 'user_orders_count_right', 'emb_0_right', 'emb_1_right', 'emb_2_right', 'emb_3_right', 'emb_4_right', 'emb_5_right', 'emb_6_right', 'emb_7_right', 'emb_8_right', 'emb_9_right', 'emb_10_right', 'emb_11_right', 'copurchase_count']
[2025-08-28 17:02:45] ✅ Все признаки присутствуют
[2025-08-28 17:02:45] Целевая переменная: {1: np.int64(9352544), 0: np.int64(7739840)}
[2025-08-28 17:02:45] Пример первой строки:
[2025-08-28 17:02:45]   item_id: 152295075
[2025-08-28 17:02:45]   user_id: 1546450
[2025-08-28 17:02:45]   created_timestamp: 2025-01-14 12:16:46.776000
[2025-08-28 17:02:45]   last_status: canceled_orders
[2025-08-28 17:02:45]   target: 0
[2025-08-28 17:02:45]   weight: 8.431994767851144
[2025-08-28 17:02:45]   user_count: 19.0
[2025-08-28 17:02:45]   user_mean: 3.603577602500829
[2025-08-28 17:02:45]   user_sum: 68.46797444751574
[2025-08-28 17:02:45]   user_max: 8.789289587761868
[2025-08-28 17:02:45]   user_min: 0.4727775561284608
[2025-08-28 17:02:45]   user_orders_count: 12.0
[2025-08-28 17:02:45]   emb_0: 167.0
[2025-08-28 17:02:45]   emb_1: 6.967241287231445
[2025-08-28 17:02:45]   emb_2: 1163.529296875
[2025-08-28 17:02:45]   emb_3: 8.84643268585205
[2025-08-28 17:02:45]   emb_4: 4.0174760818481445
[2025-08-28 17:02:45]   emb_5: 167.0
[2025-08-28 17:02:45]   emb_6: 17128.0
[2025-08-28 17:02:45]   emb_7: 0.36088550090789795
[2025-08-28 17:02:45]   emb_8: 0.5335151553153992
[2025-08-28 17:02:45]   emb_9: -2.1202502250671387
[2025-08-28 17:02:45]   emb_10: 0.061143577098846436
[2025-08-28 17:02:45]   emb_11: 0.030507177114486694
[2025-08-28 17:02:45]   user_count_right: 19.0
[2025-08-28 17:02:45]   user_mean_right: 3.603577602500829
[2025-08-28 17:02:45]   user_sum_right: 68.46797444751574
[2025-08-28 17:02:45]   user_max_right: 8.789289587761868
[2025-08-28 17:02:45]   user_min_right: 0.4727775561284608
[2025-08-28 17:02:45]   user_orders_count_right: 12.0
[2025-08-28 17:02:45]   emb_0_right: 167.0
[2025-08-28 17:02:45]   emb_1_right: 6.967241287231445
[2025-08-28 17:02:45]   emb_2_right: 1163.529296875
[2025-08-28 17:02:45]   emb_3_right: 8.84643268585205
[2025-08-28 17:02:45]   emb_4_right: 4.0174760818481445
[2025-08-28 17:02:45]   emb_5_right: 167.0
[2025-08-28 17:02:45]   emb_6_right: 17128.0
[2025-08-28 17:02:45]   emb_7_right: 0.36088550090789795
[2025-08-28 17:02:45]   emb_8_right: 0.5335151553153992
[2025-08-28 17:02:45]   emb_9_right: -2.1202502250671387
[2025-08-28 17:02:45]   emb_10_right: 0.061143577098846436
[2025-08-28 17:02:45]   emb_11_right: 0.030507177114486694
[2025-08-28 17:02:45]   copurchase_count: 0.0
[2025-08-28 17:02:45] === ДЕБАГ ИНФОРМАЦИЯ: VAL ===
[2025-08-28 17:02:45] Размер: 4257573 строк
[2025-08-28 17:02:45] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'user_count_right', 'user_mean_right', 'user_sum_right', 'user_max_right', 'user_min_right', 'user_orders_count_right', 'emb_0_right', 'emb_1_right', 'emb_2_right', 'emb_3_right', 'emb_4_right', 'emb_5_right', 'emb_6_right', 'emb_7_right', 'emb_8_right', 'emb_9_right', 'emb_10_right', 'emb_11_right', 'copurchase_count']
[2025-08-28 17:02:45] ✅ Все признаки присутствуют
[2025-08-28 17:02:45] Целевая переменная: {1: np.int64(2277657), 0: np.int64(1979916)}
[2025-08-28 17:02:45] Пример первой строки:
[2025-08-28 17:02:45]   item_id: 197446442
[2025-08-28 17:02:45]   user_id: 25090
[2025-08-28 17:02:45]   created_timestamp: 2025-02-01 14:11:14.713000
[2025-08-28 17:02:45]   last_status: delivered_orders
[2025-08-28 17:02:45]   target: 1
[2025-08-28 17:02:45]   weight: 0.6729444732424259
[2025-08-28 17:02:45]   user_count: 33
[2025-08-28 17:02:45]   user_mean: 4.57175932949514
[2025-08-28 17:02:45]   user_sum: 150.8680578733396
[2025-08-28 17:02:45]   user_max: 15.75536360758419
[2025-08-28 17:02:45]   user_min: 0.16394911411495436
[2025-08-28 17:02:45]   user_orders_count: 39
[2025-08-28 17:02:45]   emb_0: 382.0
[2025-08-28 17:02:45]   emb_1: 2.8787224292755127
[2025-08-28 17:02:45]   emb_2: 1099.6719970703125
[2025-08-28 17:02:45]   emb_3: 15.755363464355469
[2025-08-28 17:02:45]   emb_4: 0.06557964533567429
[2025-08-28 17:02:45]   emb_5: 4.0
[2025-08-28 17:02:45]   emb_6: 7502.0
[2025-08-28 17:02:45]   emb_7: 0.05241811275482178
[2025-08-28 17:02:45]   emb_8: 1.7371025085449219
[2025-08-28 17:02:45]   emb_9: 0.7646299600601196
[2025-08-28 17:02:45]   emb_10: -0.3653416335582733
[2025-08-28 17:02:45]   emb_11: -0.2654132544994354
[2025-08-28 17:02:45]   user_count_right: 33
[2025-08-28 17:02:45]   user_mean_right: 4.57175932949514
[2025-08-28 17:02:45]   user_sum_right: 150.8680578733396
[2025-08-28 17:02:45]   user_max_right: 15.75536360758419
[2025-08-28 17:02:45]   user_min_right: 0.16394911411495436
[2025-08-28 17:02:45]   user_orders_count_right: 39
[2025-08-28 17:02:45]   emb_0_right: 382.0
[2025-08-28 17:02:45]   emb_1_right: 2.8787224292755127
[2025-08-28 17:02:45]   emb_2_right: 1099.6719970703125
[2025-08-28 17:02:45]   emb_3_right: 15.755363464355469
[2025-08-28 17:02:45]   emb_4_right: 0.06557964533567429
[2025-08-28 17:02:45]   emb_5_right: 4.0
[2025-08-28 17:02:45]   emb_6_right: 7502.0
[2025-08-28 17:02:45]   emb_7_right: 0.05241811275482178
[2025-08-28 17:02:45]   emb_8_right: 1.7371025085449219
[2025-08-28 17:02:45]   emb_9_right: 0.7646299600601196
[2025-08-28 17:02:45]   emb_10_right: -0.3653416335582733
[2025-08-28 17:02:45]   emb_11_right: -0.2654132544994354
[2025-08-28 17:02:45]   copurchase_count: 0.0
[2025-08-28 17:02:45] Feature columns: ['copurchase_count', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11']
[2025-08-28 17:02:50] Размер train: 17092384
[2025-08-28 17:02:50] Используемые признаки: ['copurchase_count', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11']
[2025-08-28 17:02:50] Пример данных: {'copurchase_count': 0.0, 'user_count': 19.0, 'user_mean': 3.603577602500829, 'user_sum': 68.46797444751574, 'user_max': 8.789289587761868, 'user_min': 0.4727775561284608, 'user_orders_count': 12.0, 'emb_0': 167.0, 'emb_1': 6.967241287231445, 'emb_2': 1163.529296875, 'emb_3': 8.84643268585205, 'emb_4': 4.0174760818481445, 'emb_5': 167.0, 'emb_6': 17128.0, 'emb_7': 0.36088550090789795, 'emb_8': 0.5335151553153992, 'emb_9': -2.1202502250671387, 'emb_10': 0.061143577098846436, 'emb_11': 0.030507177114486694}
[2025-08-28 17:02:50] Категориальные признаки: ['user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count']
[2025-08-28 17:02:50] Размер val: 4257573
[2025-08-28 17:02:53] [Iter 0] train_binary_logloss:0.6867, valid_binary_logloss:0.6895
[2025-08-28 17:03:12] [Iter 50] train_binary_logloss:0.6139, valid_binary_logloss:0.6250
[2025-08-28 17:03:34] [Iter 100] train_binary_logloss:0.5894, valid_binary_logloss:0.6023
[2025-08-28 17:03:52] [Iter 150] train_binary_logloss:0.5789, valid_binary_logloss:0.5920
[2025-08-28 17:04:11] [Iter 200] train_binary_logloss:0.5729, valid_binary_logloss:0.5863
[2025-08-28 17:04:28] [Iter 250] train_binary_logloss:0.5690, valid_binary_logloss:0.5825
[2025-08-28 17:04:47] [Iter 300] train_binary_logloss:0.5662, valid_binary_logloss:0.5801
[2025-08-28 17:05:02] [Iter 350] train_binary_logloss:0.5639, valid_binary_logloss:0.5783
[2025-08-28 17:05:20] [Iter 400] train_binary_logloss:0.5620, valid_binary_logloss:0.5768
[2025-08-28 17:05:33] [Iter 450] train_binary_logloss:0.5604, valid_binary_logloss:0.5756
[2025-08-28 17:05:50] [Iter 500] train_binary_logloss:0.5590, valid_binary_logloss:0.5744
[2025-08-28 17:06:04] [Iter 550] train_binary_logloss:0.5577, valid_binary_logloss:0.5734
[2025-08-28 17:06:21] [Iter 600] train_binary_logloss:0.5564, valid_binary_logloss:0.5723
[2025-08-28 17:06:35] [Iter 650] train_binary_logloss:0.5551, valid_binary_logloss:0.5713
[2025-08-28 17:06:52] [Iter 700] train_binary_logloss:0.5541, valid_binary_logloss:0.5705
[2025-08-28 17:07:04] [Iter 750] train_binary_logloss:0.5531, valid_binary_logloss:0.5699
[2025-08-28 17:07:17] [Iter 800] train_binary_logloss:0.5522, valid_binary_logloss:0.5692
[2025-08-28 17:07:33] [Iter 850] train_binary_logloss:0.5513, valid_binary_logloss:0.5685
[2025-08-28 17:07:45] [Iter 900] train_binary_logloss:0.5505, valid_binary_logloss:0.5679
[2025-08-28 17:08:01] [Iter 950] train_binary_logloss:0.5497, valid_binary_logloss:0.5673
[2025-08-28 17:08:14] [Iter 1000] train_binary_logloss:0.5490, valid_binary_logloss:0.5669
[2025-08-28 17:08:27] [Iter 1050] train_binary_logloss:0.5483, valid_binary_logloss:0.5665
[2025-08-28 17:08:43] [Iter 1100] train_binary_logloss:0.5477, valid_binary_logloss:0.5659
[2025-08-28 17:08:55] [Iter 1150] train_binary_logloss:0.5471, valid_binary_logloss:0.5656
[2025-08-28 17:09:07] [Iter 1200] train_binary_logloss:0.5465, valid_binary_logloss:0.5651
[2025-08-28 17:09:22] [Iter 1250] train_binary_logloss:0.5459, valid_binary_logloss:0.5647
[2025-08-28 17:09:34] [Iter 1300] train_binary_logloss:0.5454, valid_binary_logloss:0.5643
[2025-08-28 17:09:48] [Iter 1350] train_binary_logloss:0.5449, valid_binary_logloss:0.5640
[2025-08-28 17:10:02] [Iter 1400] train_binary_logloss:0.5443, valid_binary_logloss:0.5636
[2025-08-28 17:10:16] [Iter 1450] train_binary_logloss:0.5439, valid_binary_logloss:0.5632
[2025-08-28 17:10:30] [Iter 1500] train_binary_logloss:0.5435, valid_binary_logloss:0.5629
[2025-08-28 17:10:42] [Iter 1550] train_binary_logloss:0.5431, valid_binary_logloss:0.5627
[2025-08-28 17:10:58] [Iter 1600] train_binary_logloss:0.5427, valid_binary_logloss:0.5625
[2025-08-28 17:11:09] [Iter 1650] train_binary_logloss:0.5423, valid_binary_logloss:0.5622
[2025-08-28 17:11:21] [Iter 1700] train_binary_logloss:0.5419, valid_binary_logloss:0.5620
[2025-08-28 17:11:36] [Iter 1750] train_binary_logloss:0.5416, valid_binary_logloss:0.5618
[2025-08-28 17:11:48] [Iter 1800] train_binary_logloss:0.5412, valid_binary_logloss:0.5615
[2025-08-28 17:12:03] [Iter 1850] train_binary_logloss:0.5409, valid_binary_logloss:0.5613
[2025-08-28 17:12:16] [Iter 1900] train_binary_logloss:0.5406, valid_binary_logloss:0.5612
[2025-08-28 17:12:28] [Iter 1950] train_binary_logloss:0.5403, valid_binary_logloss:0.5610
[2025-08-28 17:12:43] [Iter 2000] train_binary_logloss:0.5400, valid_binary_logloss:0.5608
[2025-08-28 17:12:55] [Iter 2050] train_binary_logloss:0.5398, valid_binary_logloss:0.5606
[2025-08-28 17:13:07] [Iter 2100] train_binary_logloss:0.5395, valid_binary_logloss:0.5604
[2025-08-28 17:13:22] [Iter 2150] train_binary_logloss:0.5392, valid_binary_logloss:0.5602
[2025-08-28 17:13:34] [Iter 2200] train_binary_logloss:0.5390, valid_binary_logloss:0.5602
[2025-08-28 17:13:49] [Iter 2250] train_binary_logloss:0.5388, valid_binary_logloss:0.5601
[2025-08-28 17:14:01] [Iter 2300] train_binary_logloss:0.5385, valid_binary_logloss:0.5599
[2025-08-28 17:14:14] [Iter 2350] train_binary_logloss:0.5383, valid_binary_logloss:0.5598
[2025-08-28 17:14:28] [Iter 2400] train_binary_logloss:0.5381, valid_binary_logloss:0.5596
[2025-08-28 17:14:41] [Iter 2450] train_binary_logloss:0.5379, valid_binary_logloss:0.5595
[2025-08-28 17:14:53] [Iter 2500] train_binary_logloss:0.5377, valid_binary_logloss:0.5594
[2025-08-28 17:15:06] [Iter 2550] train_binary_logloss:0.5375, valid_binary_logloss:0.5593
[2025-08-28 17:15:17] [Iter 2600] train_binary_logloss:0.5373, valid_binary_logloss:0.5592
[2025-08-28 17:15:33] [Iter 2650] train_binary_logloss:0.5371, valid_binary_logloss:0.5590
[2025-08-28 17:15:45] [Iter 2700] train_binary_logloss:0.5369, valid_binary_logloss:0.5589
[2025-08-28 17:15:58] [Iter 2750] train_binary_logloss:0.5367, valid_binary_logloss:0.5588
[2025-08-28 17:16:12] [Iter 2800] train_binary_logloss:0.5366, valid_binary_logloss:0.5587
[2025-08-28 17:16:23] [Iter 2850] train_binary_logloss:0.5364, valid_binary_logloss:0.5586
[2025-08-28 17:16:35] [Iter 2900] train_binary_logloss:0.5362, valid_binary_logloss:0.5585
[2025-08-28 17:16:50] [Iter 2950] train_binary_logloss:0.5361, valid_binary_logloss:0.5584
[2025-08-28 17:17:00] [Iter 3000] train_binary_logloss:0.5359, valid_binary_logloss:0.5583
[2025-08-28 17:17:12] [Iter 3050] train_binary_logloss:0.5358, valid_binary_logloss:0.5582
[2025-08-28 17:17:27] [Iter 3100] train_binary_logloss:0.5357, valid_binary_logloss:0.5581
[2025-08-28 17:17:40] [Iter 3150] train_binary_logloss:0.5355, valid_binary_logloss:0.5580
[2025-08-28 17:17:54] [Iter 3200] train_binary_logloss:0.5354, valid_binary_logloss:0.5580
[2025-08-28 17:18:06] [Iter 3250] train_binary_logloss:0.5352, valid_binary_logloss:0.5579
[2025-08-28 17:18:17] [Iter 3300] train_binary_logloss:0.5351, valid_binary_logloss:0.5579
[2025-08-28 17:18:31] [Iter 3350] train_binary_logloss:0.5350, valid_binary_logloss:0.5579
[2025-08-28 17:18:43] [Iter 3400] train_binary_logloss:0.5348, valid_binary_logloss:0.5578
[2025-08-28 17:18:55] [Iter 3450] train_binary_logloss:0.5347, valid_binary_logloss:0.5577
[2025-08-28 17:19:09] [Iter 3500] train_binary_logloss:0.5346, valid_binary_logloss:0.5577
[2025-08-28 17:19:21] [Iter 3550] train_binary_logloss:0.5345, valid_binary_logloss:0.5576
[2025-08-28 17:19:35] [Iter 3600] train_binary_logloss:0.5343, valid_binary_logloss:0.5576
[2025-08-28 17:19:47] [Iter 3650] train_binary_logloss:0.5342, valid_binary_logloss:0.5576
[2025-08-28 17:19:58] [Iter 3700] train_binary_logloss:0.5341, valid_binary_logloss:0.5575
[2025-08-28 17:20:12] [Iter 3750] train_binary_logloss:0.5339, valid_binary_logloss:0.5574
[2025-08-28 17:20:23] [Iter 3800] train_binary_logloss:0.5338, valid_binary_logloss:0.5573
[2025-08-28 17:20:35] [Iter 3850] train_binary_logloss:0.5337, valid_binary_logloss:0.5572
[2025-08-28 17:20:49] [Iter 3900] train_binary_logloss:0.5336, valid_binary_logloss:0.5572
[2025-08-28 17:21:02] [Iter 3950] train_binary_logloss:0.5335, valid_binary_logloss:0.5572
[2025-08-28 17:21:14] [Iter 4000] train_binary_logloss:0.5334, valid_binary_logloss:0.5571
[2025-08-28 17:21:28] [Iter 4050] train_binary_logloss:0.5332, valid_binary_logloss:0.5571
[2025-08-28 17:21:39] [Iter 4100] train_binary_logloss:0.5331, valid_binary_logloss:0.5571
[2025-08-28 17:21:53] [Iter 4150] train_binary_logloss:0.5330, valid_binary_logloss:0.5570
[2025-08-28 17:22:04] [Iter 4200] train_binary_logloss:0.5329, valid_binary_logloss:0.5570
[2025-08-28 17:22:15] [Iter 4250] train_binary_logloss:0.5328, valid_binary_logloss:0.5569
[2025-08-28 17:22:29] [Iter 4300] train_binary_logloss:0.5327, valid_binary_logloss:0.5569
[2025-08-28 17:22:41] [Iter 4350] train_binary_logloss:0.5326, valid_binary_logloss:0.5568
[2025-08-28 17:22:53] [Iter 4400] train_binary_logloss:0.5325, valid_binary_logloss:0.5568
[2025-08-28 17:23:08] [Iter 4450] train_binary_logloss:0.5324, valid_binary_logloss:0.5567
[2025-08-28 17:23:19] [Iter 4500] train_binary_logloss:0.5323, valid_binary_logloss:0.5567
[2025-08-28 17:23:30] [Iter 4550] train_binary_logloss:0.5322, valid_binary_logloss:0.5567
[2025-08-28 17:23:43] [Iter 4600] train_binary_logloss:0.5322, valid_binary_logloss:0.5567
[2025-08-28 17:23:54] [Iter 4650] train_binary_logloss:0.5321, valid_binary_logloss:0.5565
[2025-08-28 17:24:05] [Iter 4700] train_binary_logloss:0.5320, valid_binary_logloss:0.5565
[2025-08-28 17:24:20] [Iter 4750] train_binary_logloss:0.5319, valid_binary_logloss:0.5565
[2025-08-28 17:24:32] [Iter 4800] train_binary_logloss:0.5318, valid_binary_logloss:0.5564
[2025-08-28 17:24:47] [Iter 4850] train_binary_logloss:0.5317, valid_binary_logloss:0.5564
[2025-08-28 17:24:59] [Iter 4900] train_binary_logloss:0.5316, valid_binary_logloss:0.5563
[2025-08-28 17:25:10] [Iter 4950] train_binary_logloss:0.5315, valid_binary_logloss:0.5563
[2025-08-28 17:25:23] [Iter 5000] train_binary_logloss:0.5314, valid_binary_logloss:0.5563
[2025-08-28 17:25:34] [Iter 5050] train_binary_logloss:0.5314, valid_binary_logloss:0.5562
[2025-08-28 17:25:45] [Iter 5100] train_binary_logloss:0.5313, valid_binary_logloss:0.5562
[2025-08-28 17:26:00] [Iter 5150] train_binary_logloss:0.5312, valid_binary_logloss:0.5562
[2025-08-28 17:26:12] [Iter 5200] train_binary_logloss:0.5311, valid_binary_logloss:0.5561
[2025-08-28 17:26:25] [Iter 5250] train_binary_logloss:0.5310, valid_binary_logloss:0.5561
[2025-08-28 17:32:40] NDCG@100 на валидации: 0.7674
[2025-08-28 17:32:40] Обучение LightGBM завершено за 0:29:57.678454
[2025-08-28 17:32:40] === ВАЖНОСТЬ ПРИЗНАКОВ ===
[2025-08-28 17:32:40] Топ-20 важных признаков:
[2025-08-28 17:32:40]   user_sum: 60224
[2025-08-28 17:32:40]   user_count: 59245
[2025-08-28 17:32:40]   user_orders_count: 58128
[2025-08-28 17:32:40]   emb_6: 21791
[2025-08-28 17:32:40]   emb_3: 13952
[2025-08-28 17:32:40]   emb_8: 11652
[2025-08-28 17:32:40]   emb_0: 11334
[2025-08-28 17:32:40]   emb_9: 10487
[2025-08-28 17:32:40]   emb_2: 10164
[2025-08-28 17:32:40]   emb_10: 9817
[2025-08-28 17:32:40]   emb_1: 9043
[2025-08-28 17:32:40]   emb_7: 9014
[2025-08-28 17:32:40]   emb_5: 8835
[2025-08-28 17:32:40]   emb_11: 8609
[2025-08-28 17:32:40]   emb_4: 7916
[2025-08-28 17:32:40]   user_max: 7567
[2025-08-28 17:32:40]   user_mean: 3225
[2025-08-28 17:32:40]   user_min: 2472
[2025-08-28 17:32:40]   copurchase_count: 847
[2025-08-28 17:32:40] Анализ важности признаков завершен за 0:00:00.004778
[2025-08-28 17:32:40] === СОХРАНЕНИЕ МОДЕЛИ И ПРИЗНАКОВ ===
[2025-08-28 17:32:59] Сохранение модели завершено за 0:00:18.869963
[2025-08-28 17:32:59] Модель сохранена в: /home/root6/python/e_cup/rec_system/src/models/lgbm_model_full.pkl
[2025-08-28 17:32:59] === ОБУЧЕНИЕ И ПРЕДСКАЗАНИЯ ЗАВЕРШЕНЫ УСПЕШНО ===
[2025-08-28 17:32:59] Общее время выполнения: 0:35:39.748481
[2025-08-28 17:32:59] Пользователей: 872198
[2025-08-28 17:32:59] Товаров: 3938327
[2025-08-28 17:32:59] Признаков: 19
[2025-08-28 17:32:59] === СИСТЕМНАЯ ИНФОРМАЦИЯ ===
[2025-08-28 17:32:59] Видеокарта: NVIDIA GeForce RTX 4090
[2025-08-28 17:32:59] Память GPU: 24.0 GB
[2025-08-28 17:32:59] Процессор: 39.2% загрузки
[2025-08-28 17:32:59] Ядра CPU: 32
[2025-08-28 17:32:59] Частота CPU: 2995.2 MHz
[2025-08-28 17:32:59] Оперативная память: 94.2 GB всего, 83.8 GB использовано
[2025-08-28 17:32:59] Частота RAM: информация требует дополнительных библиотек
[2025-08-28 17:32:59] ==========================================
[2025-08-28 17:32:59] ВСЕ ЭТАПЫ ВЫПОЛНЕНЫ УСПЕШНО!
[2025-08-28 17:32:59] ==========================================

=== ОБЩЕЕ ВРЕМЯ ВЫПОЛНЕНИЯ: 0:35:39.764274 ===
