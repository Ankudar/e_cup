=== НАЧАЛО ОБУЧЕНИЯ 2025-08-28 10:38:33 ===

[2025-08-28 10:38:33] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-08-28 10:38:33] Пользователей: все
[2025-08-28 10:38:33] Данных: 100.0%
[2025-08-28 10:38:33] === ЗАГРУЗКА ДАННЫХ ===
[2025-08-28 10:38:33] Загружаем данные...
[2025-08-28 10:38:33] orders: 5,000,000 строк (использовано 5 из 5 партиций), ~142.9 MB
[2025-08-28 10:38:34] tracker: 5,000,000 строк (использовано 200 из 200 партиций), ~161.5 MB
[2025-08-28 10:38:35] items: 5,000,000 строк (использовано 200 из 200 партиций), ~7.4 MB
[2025-08-28 10:38:35] categories: 7,012 строк (использовано 1 из 1 партиций), ~1.7 MB
[2025-08-28 10:38:35] test_users: 470,347 строк (использовано 1 из 1 партиций), ~1.8 MB
[2025-08-28 10:38:35] Данные загружены
[2025-08-28 10:38:35] Фильтрация данных...
[2025-08-28 10:38:35] Фильтрация завершена
[2025-08-28 10:38:35] Загрузка данных завершена за 0:00:02.026182
[2025-08-28 10:38:35] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-08-28 10:38:35] Оптимизированная потоковая загрузка эмбеддингов...
[2025-08-28 10:38:36] Загружено эмбеддингов для 43059 товаров
[2025-08-28 10:38:36] Пример ключей в embeddings_dict: [400301, 678602, 746401, 872829, 893255]
[2025-08-28 10:38:36] Пример значения: [ 0.32023853  0.11766258 -0.784552    0.4168199  -0.24610527]
[2025-08-28 10:38:36] Загрузка эмбеддингов завершена за 0:00:01.126410
[2025-08-28 10:38:36] Загружено эмбеддингов: 43059
[2025-08-28 10:38:36] === SPLIT ДАННЫХ ===
[2025-08-28 10:38:38] Split данных завершен за 0:00:01.666929
[2025-08-28 10:38:38] Train orders: 2872564, Test orders: 718140
[2025-08-28 10:38:38] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-08-28 10:38:38] Формируем матрицу взаимодействий по батчам...
[2025-08-28 10:38:38] ... для orders
[2025-08-28 10:38:38] Сохранен orders-батч 0-2872564
[2025-08-28 10:38:38] ... для tracker
[2025-08-28 10:38:40] Сохранен tracker-партиция 0
[2025-08-28 10:38:40] Все батчи сохранены на диск.
[2025-08-28 10:38:40] Подготовка взаимодействий завершена за 0:00:02.677949
[2025-08-28 10:38:40] Создано файлов взаимодействий: 2
[2025-08-28 10:38:40] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-08-28 10:38:42] Словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/recent_items_map.pkl
[2025-08-28 10:38:42] Построение recent items map завершено за 0:00:01.590857
[2025-08-28 10:38:42] Пользователей с recent items: 735144
[2025-08-28 10:38:42] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-08-28 10:38:42] Первый проход: построение маппингов...
[2025-08-28 10:38:42] Маппинги построены. Уников: users=735144, items=790719
[2025-08-28 10:38:42] item_map сохранен: /home/root6/python/e_cup/rec_system/data/processed/item_map.pkl
[2025-08-28 10:38:42] Сохранение батчей на диск...
[2025-08-28 10:38:43] Постепенное обучение...
[2025-08-28 10:38:44] Очистка временных файлов...
[2025-08-28 10:38:44] Директория батчей удалена
[2025-08-28 10:38:44] Обучение завершено!
[2025-08-28 10:38:44] Считаем глобальную популярность на основе тренировочных данных...
[2025-08-28 10:38:44] Глобальная популярность рассчитана на 2872563 тренировочных заказах
[2025-08-28 10:38:44] Обучение ALS завершено за 0:00:02.278922
[2025-08-28 10:38:44] Пользователей: 735144, Товаров: 790719
[2025-08-28 10:38:44] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-08-28 10:38:44] Строим co-purchase матрицу для топ-N товаров...
[2025-08-28 10:38:44] Топ-500 популярных товаров определены
[2025-08-28 10:39:07] Обрабатываем 5287 корзин с популярными товарами
[2025-08-28 10:39:07] Уникальных популярных товаров: 500
[2025-08-28 10:39:07] Создаем sparse матрицу из 44348 взаимодействий...
[2025-08-28 10:39:07] Sparse матрица построена: torch.Size([500, 500]), ненулевых элементов: 2344
[2025-08-28 10:39:07] Формируем рекомендации...
[2025-08-28 10:39:07] Co-purchase словарь построен для 483 товаров
[2025-08-28 10:39:07] В среднем 4.4 рекомендаций на товар
[2025-08-28 10:39:07] Co-purchase map построен: 483 товаров
[2025-08-28 10:39:08] Построение категорийных маппингов...
[2025-08-28 10:39:08] Категорийные маппинги построены: 63318 товаров, 419 категорий
[2025-08-28 10:39:08] Построение дополнительных данных завершено за 0:00:23.211944
[2025-08-28 10:39:08] === ПРЕДВАРИТЕЛЬНЫЙ РАСЧЕТ ПРИЗНАКОВ ДЛЯ LGBM ===
[2025-08-28 10:39:08] Построение словаря пользовательских признаков...
[2025-08-28 10:39:08] Агрегация по заказам...
[2025-08-28 10:39:09] Словарь пользовательских признаков построен и сохранён в /home/root6/python/e_cup/rec_system/data/processed/cat_to_items.pkl. Записей: 735145
[2025-08-28 10:39:09] User features построены за 0:00:01.818188: 735145 пользователей
[2025-08-28 10:39:09] Построение словаря товарных признаков...
[2025-08-28 10:39:11] Добавление данных из items_df...
[2025-08-28 10:39:12] Добавление эмбеддингов...
[2025-08-28 10:39:12] Словарь товарных признаков построен. Записей: 790720
[2025-08-28 10:39:13] Item features: 790720 товаров, размер вектора: 7 признаков
[2025-08-28 10:39:13] Порядок признаков: ['item_count', 'item_mean', 'item_sum', 'item_max', 'item_min', 'item_orders_count', 'item_category']
[2025-08-28 10:39:13] item_features_dict[293614577] type=<class 'numpy.ndarray'>, shape=(7,), example=[1.       7.520387 7.520387 7.520387 7.520387]
[2025-08-28 10:39:13] item_features_dict[313738878] type=<class 'numpy.ndarray'>, shape=(7,), example=[1.        7.7731485 7.7731485 7.7731485 7.7731485]
[2025-08-28 10:39:13] item_features_dict[185499980] type=<class 'numpy.ndarray'>, shape=(7,), example=[ 4.         5.051655  20.20662    8.760471   1.1819439]
[2025-08-28 10:39:13] item_features_dict[210100798] type=<class 'numpy.ndarray'>, shape=(7,), example=[4.        2.2625024 9.05001   6.4507527 0.3226926]
[2025-08-28 10:39:13] item_features_dict[146381803] type=<class 'numpy.ndarray'>, shape=(7,), example=[1.       4.091552 4.091552 4.091552 4.091552]
[2025-08-28 10:39:15] Item features построены за 0:00:05.379066
[2025-08-28 10:39:15] === ПОДГОТОВКА ДАННЫХ ДЛЯ LightGBM ===
[2025-08-28 10:39:15] Подготовка данных для LightGBM (streaming, polars lazy, векторно)...
[2025-08-28 10:39:18] Negatives к positive: 0
[2025-08-28 10:39:20] ✅ Данные подготовлены (streaming lazy polars, векторно)
[2025-08-28 10:39:20] Размер train: 3565466, validation: 881241
[2025-08-28 10:39:20] Признаки: 14
[2025-08-28 10:39:20] Подготовка данных для LightGBM завершена за 0:00:04.991507
[2025-08-28 10:39:20] === ДЕТАЛЬНАЯ ПРОВЕРКА FEATURE GENERATION ===
[2025-08-28 10:39:20] --- ПРОВЕРКА USER FEATURES ---
[2025-08-28 10:39:20] Пример user features для пользователя 191121:
[2025-08-28 10:39:20]   user_count: 6
[2025-08-28 10:39:20]   user_mean: 1.6931227709791143
[2025-08-28 10:39:20]   user_sum: 10.158736625874687
[2025-08-28 10:39:20]   user_max: 2.387844936944869
[2025-08-28 10:39:20]   user_min: 0.06557964564598175
[2025-08-28 10:39:20]   user_orders_count: 1
[2025-08-28 10:39:20] Пользователей с features: 735145
[2025-08-28 10:39:20] Пользователей с НЕнулевыми features: 735145
[2025-08-28 10:39:20] --- ПРОВЕРКА ITEM FEATURES ---
[2025-08-28 10:39:20] Пример item features для товара 293614577:
[2025-08-28 10:39:20]   emb_0: 1.0
[2025-08-28 10:39:20]   emb_1: 7.520387172698975
[2025-08-28 10:39:20]   emb_2: 7.520387172698975
[2025-08-28 10:39:20]   emb_3: 7.520387172698975
[2025-08-28 10:39:20]   emb_4: 7.520387172698975
[2025-08-28 10:39:20]   emb_5: 1.0
[2025-08-28 10:39:20]   emb_6: 0.0
[2025-08-28 10:39:21] Товаров с features: 790720
[2025-08-28 10:39:21] Товаров с НЕнулевыми features: 790720
[2025-08-28 10:39:21] --- ПРОВЕРКА ЭМБЕДДИНГОВ ---
[2025-08-28 10:39:21] Пример эмбеддинга для товара 400301: shape (512,)
[2025-08-28 10:39:21] Эмбеддингов загружено: 43059
[2025-08-28 10:39:21] Пример значений: [ 0.32023853  0.11766258 -0.784552    0.4168199  -0.24610527]
[2025-08-28 10:39:21] --- ПРОВЕРКА CO-PURCHASE MAP ---
[2025-08-28 10:39:21] Пример co-purchase для товара 187052809: 10 товаров
[2025-08-28 10:39:21] Co-purchase записей: 483
[2025-08-28 10:39:21] --- ПРОВЕРКА КАТЕГОРИЙНЫХ МАППИНГОВ ---
[2025-08-28 10:39:21] Товар 400301 -> категория 17080
[2025-08-28 10:39:21] Категория 17080 -> 173 товаров
[2025-08-28 10:39:21] Товаров в маппинге: 63318
[2025-08-28 10:39:21] Категорий в маппинге: 419
[2025-08-28 10:39:21] Проверка признаков завершена за 0:00:01.269660
[2025-08-28 10:39:21] === ОБУЧЕНИЕ LightGBM ===
[2025-08-28 10:39:21] === ДЕБАГ ИНФОРМАЦИЯ: TRAIN ===
[2025-08-28 10:39:21] Размер: 3565466 строк
[2025-08-28 10:39:21] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'copurchase_count']
[2025-08-28 10:39:21] ✅ Все признаки присутствуют
[2025-08-28 10:39:21] Целевая переменная: {1: np.int64(1953526), 0: np.int64(1611940)}
[2025-08-28 10:39:21] Пример первой строки:
[2025-08-28 10:39:21]   item_id: 318657213
[2025-08-28 10:39:21]   user_id: 2302310
[2025-08-28 10:39:21]   created_timestamp: 2025-04-03 18:37:56.960000
[2025-08-28 10:39:21]   last_status: delivered_orders
[2025-08-28 10:39:21]   target: 1
[2025-08-28 10:39:21]   weight: 5.088216130672213
[2025-08-28 10:39:21]   user_count: 6.0
[2025-08-28 10:39:21]   user_mean: 3.1846620012271827
[2025-08-28 10:39:21]   user_sum: 19.107972007363095
[2025-08-28 10:39:21]   user_max: 5.088216130672213
[2025-08-28 10:39:21]   user_min: 2.262804222982201
[2025-08-28 10:39:21]   user_orders_count: 2.0
[2025-08-28 10:39:21]   emb_0: 22.0
[2025-08-28 10:39:21]   emb_1: 4.289678573608398
[2025-08-28 10:39:21]   emb_2: 94.37293243408203
[2025-08-28 10:39:21]   emb_3: 8.673005104064941
[2025-08-28 10:39:21]   emb_4: 0.6258156895637512
[2025-08-28 10:39:21]   emb_5: 26.0
[2025-08-28 10:39:21]   emb_6: 0.0
[2025-08-28 10:39:21]   copurchase_count: 0.0
[2025-08-28 10:39:21] === ДЕБАГ ИНФОРМАЦИЯ: VAL ===
[2025-08-28 10:39:21] Размер: 881241 строк
[2025-08-28 10:39:21] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'copurchase_count']
[2025-08-28 10:39:21] ✅ Все признаки присутствуют
[2025-08-28 10:39:21] Целевая переменная: {1: np.int64(473605), 0: np.int64(407636)}
[2025-08-28 10:39:21] Пример первой строки:
[2025-08-28 10:39:21]   item_id: 133313282
[2025-08-28 10:39:21]   user_id: 2923120
[2025-08-28 10:39:21]   created_timestamp: 2025-04-29 13:48:58.696000
[2025-08-28 10:39:21]   last_status: delivered_orders
[2025-08-28 10:39:21]   target: 1
[2025-08-28 10:39:21]   weight: 3.209269430861974
[2025-08-28 10:39:21]   user_count: 8
[2025-08-28 10:39:21]   user_mean: 5.069254396420378
[2025-08-28 10:39:21]   user_sum: 40.554035171363026
[2025-08-28 10:39:21]   user_max: 8.613832988705518
[2025-08-28 10:39:21]   user_min: 2.027325540540822
[2025-08-28 10:39:21]   user_orders_count: 9
[2025-08-28 10:39:21]   emb_0: 16.0
[2025-08-28 10:39:21]   emb_1: 4.168355464935303
[2025-08-28 10:39:21]   emb_2: 66.69368743896484
[2025-08-28 10:39:21]   emb_3: 8.178775787353516
[2025-08-28 10:39:21]   emb_4: 0.163949117064476
[2025-08-28 10:39:21]   emb_5: 21.0
[2025-08-28 10:39:21]   emb_6: 0.0
[2025-08-28 10:39:21]   copurchase_count: 0.0
[2025-08-28 10:39:21] Feature columns: ['copurchase_count', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6']
[2025-08-28 10:39:21] Размер train: 3565466
[2025-08-28 10:39:21] Используемые признаки: ['copurchase_count', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6']
[2025-08-28 10:39:21] Пример данных: {'copurchase_count': 0.0, 'user_count': 6.0, 'user_mean': 3.1846620012271827, 'user_sum': 19.107972007363095, 'user_max': 5.088216130672213, 'user_min': 2.262804222982201, 'user_orders_count': 2.0, 'emb_0': 22.0, 'emb_1': 4.289678573608398, 'emb_2': 94.37293243408203, 'emb_3': 8.673005104064941, 'emb_4': 0.6258156895637512, 'emb_5': 26.0, 'emb_6': 0.0}
[2025-08-28 10:39:21] Категориальные признаки: ['user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count']
[2025-08-28 10:39:21] Размер val: 881241
[2025-08-28 10:39:22] [Iter 0] train_binary_logloss:0.6866, valid_binary_logloss:0.6889
[2025-08-28 10:39:22] [Iter 10] train_binary_logloss:0.6714, valid_binary_logloss:0.6760
[2025-08-28 10:39:23] [Iter 20] train_binary_logloss:0.6595, valid_binary_logloss:0.6665
[2025-08-28 10:39:23] [Iter 30] train_binary_logloss:0.6508, valid_binary_logloss:0.6596
[2025-08-28 10:39:24] [Iter 40] train_binary_logloss:0.6446, valid_binary_logloss:0.6547
[2025-08-28 10:39:24] [Iter 50] train_binary_logloss:0.6396, valid_binary_logloss:0.6509
[2025-08-28 10:39:25] [Iter 60] train_binary_logloss:0.6356, valid_binary_logloss:0.6480
[2025-08-28 10:39:26] [Iter 70] train_binary_logloss:0.6323, valid_binary_logloss:0.6455
[2025-08-28 10:39:26] [Iter 80] train_binary_logloss:0.6297, valid_binary_logloss:0.6436
[2025-08-28 10:39:27] [Iter 90] train_binary_logloss:0.6274, valid_binary_logloss:0.6420
[2025-08-28 10:39:28] [Iter 100] train_binary_logloss:0.6252, valid_binary_logloss:0.6407
[2025-08-28 10:39:28] [Iter 110] train_binary_logloss:0.6233, valid_binary_logloss:0.6395
[2025-08-28 10:39:28] [Iter 120] train_binary_logloss:0.6219, valid_binary_logloss:0.6385
[2025-08-28 10:39:29] [Iter 130] train_binary_logloss:0.6204, valid_binary_logloss:0.6376
[2025-08-28 10:39:29] [Iter 140] train_binary_logloss:0.6191, valid_binary_logloss:0.6369
[2025-08-28 10:39:30] [Iter 150] train_binary_logloss:0.6180, valid_binary_logloss:0.6361
[2025-08-28 10:39:30] [Iter 160] train_binary_logloss:0.6168, valid_binary_logloss:0.6354
[2025-08-28 10:39:31] [Iter 170] train_binary_logloss:0.6158, valid_binary_logloss:0.6348
[2025-08-28 10:39:31] [Iter 180] train_binary_logloss:0.6148, valid_binary_logloss:0.6342
[2025-08-28 10:39:32] [Iter 190] train_binary_logloss:0.6139, valid_binary_logloss:0.6337
[2025-08-28 10:39:33] [Iter 200] train_binary_logloss:0.6131, valid_binary_logloss:0.6332
[2025-08-28 10:39:33] [Iter 210] train_binary_logloss:0.6122, valid_binary_logloss:0.6328
[2025-08-28 10:39:34] [Iter 220] train_binary_logloss:0.6115, valid_binary_logloss:0.6324
[2025-08-28 10:39:34] [Iter 230] train_binary_logloss:0.6107, valid_binary_logloss:0.6321
[2025-08-28 10:39:34] [Iter 240] train_binary_logloss:0.6100, valid_binary_logloss:0.6318
[2025-08-28 10:39:35] [Iter 250] train_binary_logloss:0.6094, valid_binary_logloss:0.6315
[2025-08-28 10:39:35] [Iter 260] train_binary_logloss:0.6088, valid_binary_logloss:0.6311
[2025-08-28 10:39:36] [Iter 270] train_binary_logloss:0.6082, valid_binary_logloss:0.6308
[2025-08-28 10:39:36] [Iter 280] train_binary_logloss:0.6077, valid_binary_logloss:0.6304
[2025-08-28 10:39:37] [Iter 290] train_binary_logloss:0.6072, valid_binary_logloss:0.6302
[2025-08-28 10:39:37] [Iter 300] train_binary_logloss:0.6068, valid_binary_logloss:0.6300
[2025-08-28 10:39:38] [Iter 310] train_binary_logloss:0.6062, valid_binary_logloss:0.6297
[2025-08-28 10:39:38] [Iter 320] train_binary_logloss:0.6058, valid_binary_logloss:0.6295
[2025-08-28 10:39:39] [Iter 330] train_binary_logloss:0.6053, valid_binary_logloss:0.6293
[2025-08-28 10:39:39] [Iter 340] train_binary_logloss:0.6049, valid_binary_logloss:0.6291
[2025-08-28 10:39:40] [Iter 350] train_binary_logloss:0.6045, valid_binary_logloss:0.6289
[2025-08-28 10:39:40] [Iter 360] train_binary_logloss:0.6041, valid_binary_logloss:0.6287
[2025-08-28 10:39:41] [Iter 370] train_binary_logloss:0.6037, valid_binary_logloss:0.6285
[2025-08-28 10:39:41] [Iter 380] train_binary_logloss:0.6033, valid_binary_logloss:0.6284
[2025-08-28 10:39:41] [Iter 390] train_binary_logloss:0.6030, valid_binary_logloss:0.6283
[2025-08-28 10:39:42] [Iter 400] train_binary_logloss:0.6026, valid_binary_logloss:0.6281
[2025-08-28 10:39:42] [Iter 410] train_binary_logloss:0.6023, valid_binary_logloss:0.6279
[2025-08-28 10:39:43] [Iter 420] train_binary_logloss:0.6020, valid_binary_logloss:0.6278
[2025-08-28 10:39:43] [Iter 430] train_binary_logloss:0.6016, valid_binary_logloss:0.6277
[2025-08-28 10:39:44] [Iter 440] train_binary_logloss:0.6013, valid_binary_logloss:0.6276
[2025-08-28 10:39:44] [Iter 450] train_binary_logloss:0.6009, valid_binary_logloss:0.6274
[2025-08-28 10:39:45] [Iter 460] train_binary_logloss:0.6005, valid_binary_logloss:0.6273
[2025-08-28 10:39:46] [Iter 470] train_binary_logloss:0.6002, valid_binary_logloss:0.6271
[2025-08-28 10:39:47] [Iter 480] train_binary_logloss:0.5999, valid_binary_logloss:0.6270
[2025-08-28 10:39:47] [Iter 490] train_binary_logloss:0.5996, valid_binary_logloss:0.6269
[2025-08-28 10:39:47] [Iter 500] train_binary_logloss:0.5993, valid_binary_logloss:0.6268
[2025-08-28 10:39:48] [Iter 510] train_binary_logloss:0.5990, valid_binary_logloss:0.6267
[2025-08-28 10:39:48] [Iter 520] train_binary_logloss:0.5988, valid_binary_logloss:0.6266
[2025-08-28 10:39:49] [Iter 530] train_binary_logloss:0.5985, valid_binary_logloss:0.6264
[2025-08-28 10:39:49] [Iter 540] train_binary_logloss:0.5982, valid_binary_logloss:0.6263
[2025-08-28 10:39:50] [Iter 550] train_binary_logloss:0.5980, valid_binary_logloss:0.6262
[2025-08-28 10:39:50] [Iter 560] train_binary_logloss:0.5977, valid_binary_logloss:0.6261
[2025-08-28 10:39:51] [Iter 570] train_binary_logloss:0.5975, valid_binary_logloss:0.6261
[2025-08-28 10:39:51] [Iter 580] train_binary_logloss:0.5972, valid_binary_logloss:0.6260
[2025-08-28 10:39:52] [Iter 590] train_binary_logloss:0.5970, valid_binary_logloss:0.6258
[2025-08-28 10:39:52] [Iter 600] train_binary_logloss:0.5967, valid_binary_logloss:0.6257
[2025-08-28 10:39:53] [Iter 610] train_binary_logloss:0.5965, valid_binary_logloss:0.6256
[2025-08-28 10:39:53] [Iter 620] train_binary_logloss:0.5963, valid_binary_logloss:0.6255
[2025-08-28 10:39:54] [Iter 630] train_binary_logloss:0.5960, valid_binary_logloss:0.6254
[2025-08-28 10:39:54] [Iter 640] train_binary_logloss:0.5958, valid_binary_logloss:0.6253
[2025-08-28 10:39:55] [Iter 650] train_binary_logloss:0.5956, valid_binary_logloss:0.6252
[2025-08-28 10:39:55] [Iter 660] train_binary_logloss:0.5954, valid_binary_logloss:0.6251
[2025-08-28 10:39:55] [Iter 670] train_binary_logloss:0.5952, valid_binary_logloss:0.6251
[2025-08-28 10:39:56] [Iter 680] train_binary_logloss:0.5950, valid_binary_logloss:0.6250
[2025-08-28 10:39:56] [Iter 690] train_binary_logloss:0.5949, valid_binary_logloss:0.6249
[2025-08-28 10:39:57] [Iter 700] train_binary_logloss:0.5947, valid_binary_logloss:0.6248
[2025-08-28 10:39:57] [Iter 710] train_binary_logloss:0.5944, valid_binary_logloss:0.6247
[2025-08-28 10:39:58] [Iter 720] train_binary_logloss:0.5942, valid_binary_logloss:0.6246
[2025-08-28 10:39:58] [Iter 730] train_binary_logloss:0.5940, valid_binary_logloss:0.6245
[2025-08-28 10:39:59] [Iter 740] train_binary_logloss:0.5939, valid_binary_logloss:0.6244
[2025-08-28 10:39:59] [Iter 750] train_binary_logloss:0.5937, valid_binary_logloss:0.6244
[2025-08-28 10:40:00] [Iter 760] train_binary_logloss:0.5935, valid_binary_logloss:0.6243
[2025-08-28 10:40:00] [Iter 770] train_binary_logloss:0.5933, valid_binary_logloss:0.6243
[2025-08-28 10:40:01] [Iter 780] train_binary_logloss:0.5931, valid_binary_logloss:0.6242
[2025-08-28 10:40:01] [Iter 790] train_binary_logloss:0.5929, valid_binary_logloss:0.6241
[2025-08-28 10:40:01] [Iter 800] train_binary_logloss:0.5927, valid_binary_logloss:0.6240
[2025-08-28 10:40:02] [Iter 810] train_binary_logloss:0.5925, valid_binary_logloss:0.6240
[2025-08-28 10:40:02] [Iter 820] train_binary_logloss:0.5924, valid_binary_logloss:0.6239
[2025-08-28 10:40:02] [Iter 830] train_binary_logloss:0.5922, valid_binary_logloss:0.6239
[2025-08-28 10:40:03] [Iter 840] train_binary_logloss:0.5921, valid_binary_logloss:0.6238
[2025-08-28 10:40:03] [Iter 850] train_binary_logloss:0.5919, valid_binary_logloss:0.6238
[2025-08-28 10:40:04] [Iter 860] train_binary_logloss:0.5917, valid_binary_logloss:0.6237
[2025-08-28 10:40:04] [Iter 870] train_binary_logloss:0.5916, valid_binary_logloss:0.6237
[2025-08-28 10:40:05] [Iter 880] train_binary_logloss:0.5914, valid_binary_logloss:0.6236
[2025-08-28 10:40:05] [Iter 890] train_binary_logloss:0.5913, valid_binary_logloss:0.6236
[2025-08-28 10:40:05] [Iter 900] train_binary_logloss:0.5911, valid_binary_logloss:0.6235
[2025-08-28 10:40:06] [Iter 910] train_binary_logloss:0.5910, valid_binary_logloss:0.6234
[2025-08-28 10:40:06] [Iter 920] train_binary_logloss:0.5908, valid_binary_logloss:0.6234
[2025-08-28 10:40:07] [Iter 930] train_binary_logloss:0.5907, valid_binary_logloss:0.6233
[2025-08-28 10:40:07] [Iter 940] train_binary_logloss:0.5905, valid_binary_logloss:0.6232
[2025-08-28 10:40:08] [Iter 950] train_binary_logloss:0.5904, valid_binary_logloss:0.6231
[2025-08-28 10:40:08] [Iter 960] train_binary_logloss:0.5902, valid_binary_logloss:0.6231
[2025-08-28 10:40:08] [Iter 970] train_binary_logloss:0.5900, valid_binary_logloss:0.6230
[2025-08-28 10:40:09] [Iter 980] train_binary_logloss:0.5899, valid_binary_logloss:0.6229
[2025-08-28 10:40:09] [Iter 990] train_binary_logloss:0.5897, valid_binary_logloss:0.6229
[2025-08-28 10:40:20] NDCG@100 на валидации: 0.6586
[2025-08-28 10:40:20] Обучение LightGBM завершено за 0:00:58.946306
[2025-08-28 10:40:20] === ОЦЕНКА МОДЕЛИ ===
[2025-08-28 10:40:56] NDCG@100 train: 0.7325
[2025-08-28 10:40:56] NDCG@100 val: 0.6586
[2025-08-28 10:40:56] Оценка модели завершена за 0:00:35.702546
[2025-08-28 10:40:56] === ВАЖНОСТЬ ПРИЗНАКОВ ===
[2025-08-28 10:40:56] Топ-20 важных признаков:
[2025-08-28 10:40:56]   user_sum: 15000
[2025-08-28 10:40:56]   user_count: 11866
[2025-08-28 10:40:56]   user_orders_count: 10310
[2025-08-28 10:40:56]   emb_6: 3844
[2025-08-28 10:40:56]   emb_0: 3375
[2025-08-28 10:40:56]   emb_3: 2894
[2025-08-28 10:40:56]   emb_2: 2548
[2025-08-28 10:40:56]   emb_1: 2525
[2025-08-28 10:40:56]   emb_5: 2435
[2025-08-28 10:40:56]   user_max: 2304
[2025-08-28 10:40:56]   emb_4: 2125
[2025-08-28 10:40:56]   user_min: 990
[2025-08-28 10:40:56]   user_mean: 978
[2025-08-28 10:40:56]   copurchase_count: 806
[2025-08-28 10:40:56] Анализ важности признаков завершен за 0:00:00.001920
[2025-08-28 10:40:56] === СОХРАНЕНИЕ МОДЕЛИ И ПРИЗНАКОВ ===
[2025-08-28 10:40:59] Сохранение модели завершено за 0:00:03.251337
[2025-08-28 10:40:59] Модель сохранена в: /home/root6/python/e_cup/rec_system/src/models/lgbm_model_full.pkl
[2025-08-28 10:40:59] === ОБУЧЕНИЕ И ПРЕДСКАЗАНИЯ ЗАВЕРШЕНЫ УСПЕШНО ===
[2025-08-28 10:40:59] Общее время выполнения: 0:02:25.941248
[2025-08-28 10:40:59] Пользователей: 735144
[2025-08-28 10:40:59] Товаров: 790719
[2025-08-28 10:40:59] Признаков: 14
[2025-08-28 10:40:59] NDCG@100 train: 0.7325
[2025-08-28 10:40:59] NDCG@100 val: 0.6586
[2025-08-28 10:40:59] === СИСТЕМНАЯ ИНФОРМАЦИЯ ===
[2025-08-28 10:40:59] Видеокарта: NVIDIA GeForce RTX 4090
[2025-08-28 10:40:59] Память GPU: 24.0 GB
[2025-08-28 10:40:59] Процессор: 28.0% загрузки
[2025-08-28 10:40:59] Ядра CPU: 32
[2025-08-28 10:40:59] Частота CPU: 2995.2 MHz
[2025-08-28 10:40:59] Оперативная память: 94.2 GB всего, 13.8 GB использовано
[2025-08-28 10:40:59] Частота RAM: информация требует дополнительных библиотек
[2025-08-28 10:40:59] ==========================================
[2025-08-28 10:40:59] ВСЕ ЭТАПЫ ВЫПОЛНЕНЫ УСПЕШНО!
[2025-08-28 10:40:59] ==========================================

=== ОБЩЕЕ ВРЕМЯ ВЫПОЛНЕНИЯ: 0:02:25.942299 ===
