=== НАЧАЛО ОБУЧЕНИЯ 2025-08-28 11:39:32 ===

[2025-08-28 11:39:32] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-08-28 11:39:32] Пользователей: все
[2025-08-28 11:39:32] Данных: 100.0%
[2025-08-28 11:39:32] === ЗАГРУЗКА ДАННЫХ ===
[2025-08-28 11:39:32] Загружаем данные...
[2025-08-28 11:39:32] orders: 18,887,122 строк (использовано 5 из 5 партиций), ~828.1 MB
[2025-08-28 11:39:33] tracker: 500,000,000 строк (использовано 200 из 200 партиций), ~270.0 MB
[2025-08-28 11:39:42] items: 6,439,422 строк (использовано 200 из 200 партиций), ~1134.2 MB
[2025-08-28 11:39:42] categories: 7,012 строк (использовано 1 из 1 партиций), ~1.7 MB
[2025-08-28 11:39:42] test_users: 470,347 строк (использовано 1 из 1 партиций), ~1.8 MB
[2025-08-28 11:39:42] Данные загружены
[2025-08-28 11:39:42] Фильтрация данных...
[2025-08-28 11:39:42] Фильтрация завершена
[2025-08-28 11:39:42] Загрузка данных завершена за 0:00:10.269612
[2025-08-28 11:39:42] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-08-28 11:39:42] Оптимизированная потоковая загрузка эмбеддингов...
[2025-08-28 11:40:04] Загружено эмбеддингов для 6342024 товаров
[2025-08-28 11:40:46] Пример ключей в embeddings_dict: [400301, 678602, 746401, 872829, 893255]
[2025-08-28 11:40:46] Пример значения: [ 0.32023853  0.11766258 -0.784552    0.4168199  -0.24610527]
[2025-08-28 11:40:46] Загрузка эмбеддингов завершена за 0:01:04.126817
[2025-08-28 11:40:46] Загружено эмбеддингов: 6342024
[2025-08-28 11:40:46] === SPLIT ДАННЫХ ===
[2025-08-28 11:40:57] Split данных завершен за 0:00:10.457173
[2025-08-28 11:40:57] Train orders: 14341462, Test orders: 3585364
[2025-08-28 11:40:57] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-08-28 11:40:57] Формируем матрицу взаимодействий по батчам...
[2025-08-28 11:40:57] ... для orders
[2025-08-28 11:40:59] Сохранен orders-батч 0-14341462
[2025-08-28 11:40:59] ... для tracker
[2025-08-28 11:41:01] Сохранен tracker-партиция 0
[2025-08-28 11:41:01] Все батчи сохранены на диск.
[2025-08-28 11:41:01] Подготовка взаимодействий завершена за 0:00:03.976903
[2025-08-28 11:41:01] Создано файлов взаимодействий: 2
[2025-08-28 11:41:01] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-08-28 11:41:03] Словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/recent_items_map.pkl
[2025-08-28 11:41:03] Построение recent items map завершено за 0:00:02.621364
[2025-08-28 11:41:03] Пользователей с recent items: 872198
[2025-08-28 11:41:03] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-08-28 11:41:03] Первый проход: построение маппингов...
[2025-08-28 11:41:05] Маппинги построены. Уников: users=872198, items=3938327
[2025-08-28 11:41:05] item_map сохранен: /home/root6/python/e_cup/rec_system/data/processed/item_map.pkl
[2025-08-28 11:41:05] Сохранение батчей на диск...
[2025-08-28 11:41:05] Постепенное обучение...
[2025-08-28 11:41:25] Очистка временных файлов...
[2025-08-28 11:41:25] Директория батчей удалена
[2025-08-28 11:41:25] Обучение завершено!
[2025-08-28 11:41:25] Считаем глобальную популярность на основе тренировочных данных...
[2025-08-28 11:41:27] Глобальная популярность рассчитана на 14341460 тренировочных заказах
[2025-08-28 11:41:27] Обучение ALS завершено за 0:00:23.434381
[2025-08-28 11:41:27] Пользователей: 872198, Товаров: 3938327
[2025-08-28 11:41:27] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-08-28 11:41:27] Строим co-purchase матрицу для топ-N товаров...
[2025-08-28 11:41:27] Топ-500 популярных товаров определены
[2025-08-28 11:43:05] Обрабатываем 18158 корзин с популярными товарами
[2025-08-28 11:43:05] Уникальных популярных товаров: 500
[2025-08-28 11:43:05] Создаем sparse матрицу из 191808 взаимодействий...
[2025-08-28 11:43:07] Sparse матрица построена: torch.Size([500, 500]), ненулевых элементов: 9247
[2025-08-28 11:43:07] Формируем рекомендации...
[2025-08-28 11:43:08] Co-purchase словарь построен для 500 товаров
[2025-08-28 11:43:08] В среднем 8.8 рекомендаций на товар
[2025-08-28 11:43:08] Co-purchase map построен: 500 товаров
