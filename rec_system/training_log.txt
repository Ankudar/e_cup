=== НАЧАЛО ОБУЧЕНИЯ 2025-08-30 22:08:46 ===

[2025-08-30 22:08:46] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-08-30 22:08:46] Пользователей: все
[2025-08-30 22:08:46] Данных: 100.0%
[2025-08-30 22:08:46] === ЗАГРУЗКА ДАННЫХ ===
[2025-08-30 22:08:46] Загружаем данные...
[2025-08-30 22:08:46] orders: найдено 5 файлов, используем 5
[2025-08-30 22:08:46] orders: 18,887,122 строк (использовано 5 файлов), ~828.1 MB
[2025-08-30 22:08:46] tracker: найдено 200 файлов, используем 200
[2025-08-30 22:09:03] tracker: 1,644,982,482 строк (использовано 200 файлов), ~65693.4 MB
[2025-08-30 22:09:03] items: найдено 100 файлов, используем 100
[2025-08-30 22:09:10] items: 6,439,422 строк (использовано 100 файлов), ~1134.2 MB
[2025-08-30 22:09:10] categories: найдено 1 файлов, используем 1
[2025-08-30 22:09:10] categories: 7,012 строк (использовано 1 файлов), ~1.7 MB
[2025-08-30 22:09:10] test_users: найдено 1 файлов, используем 1
[2025-08-30 22:09:10] test_users: 470,347 строк (использовано 1 файлов), ~1.8 MB
[2025-08-30 22:09:10] Данные загружены
[2025-08-30 22:09:10] Фильтрация данных...
[2025-08-30 22:09:10] Фильтрация завершена
[2025-08-30 22:09:10] Загрузка данных завершена за 0:00:24.425214
[2025-08-30 22:09:10] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-08-30 22:09:10] Оптимизированная потоковая загрузка эмбеддингов...
[2025-08-30 22:09:32] Загружено эмбеддингов для 6342024 товаров
[2025-08-30 22:10:15] Пример ключей в embeddings_dict: [16450600, 26171495, 32624500, 50387994, 87041801]
[2025-08-30 22:10:15] Пример значения: [-0.43104303 -0.9422982   0.44703686 -0.16915502  0.00850192]
[2025-08-30 22:10:15] Загрузка эмбеддингов завершена за 0:01:04.209889
[2025-08-30 22:10:15] Загружено эмбеддингов: 6342024
[2025-08-30 22:10:15] === SPLIT ДАННЫХ ===
[2025-08-30 22:10:27] Split данных завершен за 0:00:12.060737
[2025-08-30 22:10:27] Train orders: 13755583, Test orders: 3438892
[2025-08-30 22:10:27] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-08-30 22:10:27] Формируем матрицу взаимодействий по батчам...
[2025-08-30 22:10:27] ... обработка orders
[2025-08-30 22:10:27] Сохранен orders-батч 0-1000000
[2025-08-30 22:10:27] Сохранен orders-батч 1000000-2000000
[2025-08-30 22:10:27] Сохранен orders-батч 2000000-3000000
[2025-08-30 22:10:27] Сохранен orders-батч 3000000-4000000
[2025-08-30 22:10:28] Сохранен orders-батч 4000000-5000000
[2025-08-30 22:10:28] Сохранен orders-батч 5000000-6000000
[2025-08-30 22:10:28] Сохранен orders-батч 6000000-7000000
[2025-08-30 22:10:28] Сохранен orders-батч 7000000-8000000
[2025-08-30 22:10:28] Сохранен orders-батч 8000000-9000000
[2025-08-30 22:10:29] Сохранен orders-батч 9000000-10000000
[2025-08-30 22:10:29] Сохранен orders-батч 10000000-11000000
[2025-08-30 22:10:29] Сохранен orders-батч 11000000-12000000
[2025-08-30 22:10:29] Сохранен orders-батч 12000000-13000000
[2025-08-30 22:10:29] Сохранен orders-батч 13000000-13755583
[2025-08-30 22:10:29] ... обработка tracker
[2025-08-30 22:10:29] Обрабатываем 10 файлов tracker
[2025-08-30 22:10:31] Обработан tracker файл 0: 5204228 строк
[2025-08-30 22:10:32] Обработан tracker файл 1: 5088402 строк
[2025-08-30 22:10:33] Обработан tracker файл 2: 5045487 строк
[2025-08-30 22:10:34] Обработан tracker файл 3: 4987285 строк
[2025-08-30 22:10:36] Обработан tracker файл 4: 4989096 строк
[2025-08-30 22:10:37] Обработан tracker файл 5: 5219465 строк
[2025-08-30 22:10:38] Обработан tracker файл 6: 5030300 строк
[2025-08-30 22:10:40] Обработан tracker файл 7: 5186810 строк
[2025-08-30 22:10:41] Обработан tracker файл 8: 5120177 строк
[2025-08-30 22:10:42] Обработан tracker файл 9: 5067673 строк
[2025-08-30 22:10:42] ✅ Все файлы успешно созданы
[2025-08-30 22:10:42] Всего файлов взаимодействий: 24
[2025-08-30 22:10:42] Подготовка взаимодействий завершена за 0:00:15.803773
[2025-08-30 22:10:42] Создано файлов взаимодействий: 24
[2025-08-30 22:10:42] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-08-30 22:10:58] Словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/recent_items_map.pkl
[2025-08-30 22:10:58] Построение recent items map завершено за 0:00:16.094832
[2025-08-30 22:10:58] Пользователей с recent items: 960818
[2025-08-30 22:10:58] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-08-30 22:10:58] Первый проход: построение маппингов...
[2025-08-30 22:11:02] Маппинги построены. Уников: users=960818, items=3972133
[2025-08-30 22:11:02] item_map сохранен: /home/root6/python/e_cup/rec_system/data/processed/item_map.pkl
[2025-08-30 22:11:02] Сохранение батчей на диск...
[2025-08-30 22:11:04] Обучение als_model...
[2025-08-30 22:11:17] Очистка временных файлов...
[2025-08-30 22:11:17] Директория батчей удалена
[2025-08-30 22:11:17] Обучение завершено!
[2025-08-30 22:11:17] Считаем глобальную популярность на основе тренировочных данных...
[2025-08-30 22:11:19] Глобальная популярность рассчитана на 13755580 тренировочных заказах
[2025-08-30 22:11:19] Обучение ALS завершено за 0:00:20.315733
[2025-08-30 22:11:19] Пользователей: 960818, Товаров: 3972133
[2025-08-30 22:11:19] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-08-30 22:11:19] Строим co-purchase матрицу для топ-N товаров...
[2025-08-30 22:11:19] Топ-500 популярных товаров определены
