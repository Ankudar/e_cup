=== НАЧАЛО ОБУЧЕНИЯ 2025-08-28 12:51:06 ===

[2025-08-28 12:51:06] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-08-28 12:51:06] Пользователей: все
[2025-08-28 12:51:06] Данных: 100.0%
[2025-08-28 12:51:06] === ЗАГРУЗКА ДАННЫХ ===
[2025-08-28 12:51:06] Загружаем данные...
[2025-08-28 12:51:06] orders: 100,000 строк (использовано 5 из 5 партиций), ~3.8 MB
[2025-08-28 12:51:07] tracker: 100,000 строк (использовано 200 из 200 партиций), ~3.2 MB
[2025-08-28 12:51:08] items: 100,000 строк (использовано 200 из 200 партиций), ~7.4 MB
[2025-08-28 12:51:08] categories: 7,012 строк (использовано 1 из 1 партиций), ~1.7 MB
[2025-08-28 12:51:08] test_users: 100,000 строк (использовано 1 из 1 партиций), ~0.4 MB
[2025-08-28 12:51:08] Данные загружены
[2025-08-28 12:51:08] Фильтрация данных...
[2025-08-28 12:51:08] Фильтрация завершена
[2025-08-28 12:51:08] Загрузка данных завершена за 0:00:02.008662
[2025-08-28 12:51:08] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-08-28 12:51:08] Оптимизированная потоковая загрузка эмбеддингов...
[2025-08-28 12:51:09] Загружено эмбеддингов для 43059 товаров
[2025-08-28 12:51:09] Пример ключей в embeddings_dict: [400301, 678602, 746401, 872829, 893255]
[2025-08-28 12:51:09] Пример значения: [ 0.32023853  0.11766258 -0.784552    0.4168199  -0.24610527]
[2025-08-28 12:51:09] Загрузка эмбеддингов завершена за 0:00:00.983320
[2025-08-28 12:51:09] Загружено эмбеддингов: 43059
[2025-08-28 12:51:09] === SPLIT ДАННЫХ ===
[2025-08-28 12:51:09] Split данных завершен за 0:00:00.330992
[2025-08-28 12:51:09] Train orders: 75737, Test orders: 18934
[2025-08-28 12:51:09] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-08-28 12:51:09] Формируем матрицу взаимодействий по батчам...
[2025-08-28 12:51:09] ... для orders
[2025-08-28 12:51:09] Сохранен orders-батч 0-75737
[2025-08-28 12:51:09] ... для tracker
[2025-08-28 12:51:10] Сохранен tracker-партиция 0
[2025-08-28 12:51:10] Все батчи сохранены на диск.
[2025-08-28 12:51:10] Подготовка взаимодействий завершена за 0:00:00.849025
[2025-08-28 12:51:10] Создано файлов взаимодействий: 2
[2025-08-28 12:51:10] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-08-28 12:51:10] Словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/recent_items_map.pkl
[2025-08-28 12:51:10] Построение recent items map завершено за 0:00:00.072673
[2025-08-28 12:51:10] Пользователей с recent items: 95951
[2025-08-28 12:51:10] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-08-28 12:51:10] Первый проход: построение маппингов...
[2025-08-28 12:51:10] Маппинги построены. Уников: users=95951, items=21340
[2025-08-28 12:51:10] item_map сохранен: /home/root6/python/e_cup/rec_system/data/processed/item_map.pkl
[2025-08-28 12:51:10] Сохранение батчей на диск...
[2025-08-28 12:51:10] Постепенное обучение...
[2025-08-28 12:51:11] Очистка временных файлов...
[2025-08-28 12:51:11] Директория батчей удалена
[2025-08-28 12:51:11] Обучение завершено!
[2025-08-28 12:51:11] Считаем глобальную популярность на основе тренировочных данных...
[2025-08-28 12:51:11] Глобальная популярность рассчитана на 75736 тренировочных заказах
[2025-08-28 12:51:11] Обучение ALS завершено за 0:00:00.850324
[2025-08-28 12:51:11] Пользователей: 95951, Товаров: 21340
[2025-08-28 12:51:11] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-08-28 12:51:11] Строим co-purchase матрицу для топ-N товаров...
[2025-08-28 12:51:11] Топ-500 популярных товаров определены
[2025-08-28 12:51:12] Обрабатываем 237 корзин с популярными товарами
[2025-08-28 12:51:12] Уникальных популярных товаров: 500
[2025-08-28 12:51:12] Создаем sparse матрицу из 4144 взаимодействий...
[2025-08-28 12:51:12] Sparse матрица построена: torch.Size([500, 500]), ненулевых элементов: 134
[2025-08-28 12:51:12] Формируем рекомендации...
[2025-08-28 12:51:12] Co-purchase словарь построен для 126 товаров
[2025-08-28 12:51:12] В среднем 1.1 рекомендаций на товар
[2025-08-28 12:51:12] Co-purchase map построен: 126 товаров
[2025-08-28 12:51:12] Построение категорийных маппингов...
[2025-08-28 12:51:12] Категорийные маппинги построены: 63318 товаров, 419 категорий
[2025-08-28 12:51:12] Построение дополнительных данных завершено за 0:00:01.201890
[2025-08-28 12:51:12] === ПРЕДВАРИТЕЛЬНЫЙ РАСЧЕТ ПРИЗНАКОВ ДЛЯ LGBM ===
[2025-08-28 12:51:12] Построение словаря пользовательских признаков...
[2025-08-28 12:51:12] Агрегация по заказам...
[2025-08-28 12:51:13] Словарь пользовательских признаков построен и сохранён в /home/root6/python/e_cup/rec_system/data/processed/cat_to_items.pkl. Записей: 95952
[2025-08-28 12:51:13] User features построены за 0:00:00.433582: 95952 пользователей
[2025-08-28 12:51:13] Построение словаря товарных признаков...
[2025-08-28 12:51:13] Добавление данных из items_df...
[2025-08-28 12:51:13] Добавление эмбеддингов...
[2025-08-28 12:51:13] Словарь товарных признаков построен. Записей: 21341
[2025-08-28 12:51:13] Item features: 21341 товаров, размер вектора: 12 признаков
[2025-08-28 12:51:13] Порядок признаков: ['item_count', 'item_mean', 'item_sum', 'item_max', 'item_min', 'item_orders_count', 'item_category', 'fclip_embed_0', 'fclip_embed_1', 'fclip_embed_2']...
[2025-08-28 12:51:13] item_features_dict[3091266] type=<class 'numpy.ndarray'>, shape=(12,), example=[1.        5.6570106 5.6570106 5.6570106 5.6570106]
[2025-08-28 12:51:13] item_features_dict[93907105] type=<class 'numpy.ndarray'>, shape=(12,), example=[ 7.        6.483945 45.38761   8.553952  3.030679]
[2025-08-28 12:51:13] item_features_dict[44404242] type=<class 'numpy.ndarray'>, shape=(12,), example=[2.        3.2858021 6.5716043 4.017476  2.5541282]
[2025-08-28 12:51:13] item_features_dict[316923595] type=<class 'numpy.ndarray'>, shape=(12,), example=[1.        3.8659494 3.8659494 3.8659494 3.8659494]
[2025-08-28 12:51:13] item_features_dict[299561531] type=<class 'numpy.ndarray'>, shape=(12,), example=[1.        3.2962282 3.2962282 3.2962282 3.2962282]
[2025-08-28 12:51:13] Item features построены за 0:00:00.633877
[2025-08-28 12:51:13] === ПОДГОТОВКА ДАННЫХ ДЛЯ LightGBM ===
[2025-08-28 12:51:13] Подготовка данных для LightGBM (streaming, polars lazy, векторно)...
[2025-08-28 12:51:14] Negatives к positive: 0
[2025-08-28 12:51:14] ✅ Данные подготовлены (streaming lazy polars, векторно)
[2025-08-28 12:51:14] Размер train: 92421, validation: 22761
[2025-08-28 12:51:14] Признаки: 19
[2025-08-28 12:51:14] Подготовка данных для LightGBM завершена за 0:00:00.546269
[2025-08-28 12:51:14] === ДЕТАЛЬНАЯ ПРОВЕРКА FEATURE GENERATION ===
[2025-08-28 12:51:14] --- ПРОВЕРКА USER FEATURES ---
[2025-08-28 12:51:14] Пример user features для пользователя 2536011:
[2025-08-28 12:51:14]   user_count: 2
[2025-08-28 12:51:14]   user_mean: 7.516577810972208
[2025-08-28 12:51:14]   user_sum: 15.033155621944417
[2025-08-28 12:51:14]   user_max: 12.52762968495368
[2025-08-28 12:51:14]   user_min: 2.505525936990736
[2025-08-28 12:51:14]   user_orders_count: 0
[2025-08-28 12:51:14] Пользователей с features: 95952
[2025-08-28 12:51:14] Пользователей с НЕнулевыми features: 95952
[2025-08-28 12:51:14] --- ПРОВЕРКА ITEM FEATURES ---
[2025-08-28 12:51:14] Пример item features для товара 3091266:
[2025-08-28 12:51:14]   emb_0: 1.0
[2025-08-28 12:51:14]   emb_1: 5.657010555267334
[2025-08-28 12:51:14]   emb_2: 5.657010555267334
[2025-08-28 12:51:14]   emb_3: 5.657010555267334
[2025-08-28 12:51:14]   emb_4: 5.657010555267334
[2025-08-28 12:51:14]   emb_5: 1.0
[2025-08-28 12:51:14]   emb_6: 17136.0
[2025-08-28 12:51:14]   emb_7: -0.08993222564458847
[2025-08-28 12:51:14]   emb_8: 0.44794946908950806
[2025-08-28 12:51:14]   emb_9: -0.6269813776016235
[2025-08-28 12:51:14]   emb_10: -0.11656562983989716
[2025-08-28 12:51:14]   emb_11: -0.012493699789047241
[2025-08-28 12:51:14] Товаров с features: 21341
[2025-08-28 12:51:14] Товаров с НЕнулевыми features: 21341
[2025-08-28 12:51:14] --- ПРОВЕРКА ЭМБЕДДИНГОВ ---
[2025-08-28 12:51:14] Пример эмбеддинга для товара 400301: shape (512,)
[2025-08-28 12:51:14] Эмбеддингов загружено: 43059
[2025-08-28 12:51:14] Пример значений: [ 0.32023853  0.11766258 -0.784552    0.4168199  -0.24610527]
[2025-08-28 12:51:14] --- ПРОВЕРКА CO-PURCHASE MAP ---
[2025-08-28 12:51:14] Пример co-purchase для товара 141204132: 1 товаров
[2025-08-28 12:51:14] Co-purchase записей: 126
[2025-08-28 12:51:14] --- ПРОВЕРКА КАТЕГОРИЙНЫХ МАППИНГОВ ---
[2025-08-28 12:51:14] Товар 400301 -> категория 17080
[2025-08-28 12:51:14] Категория 17080 -> 173 товаров
[2025-08-28 12:51:14] Товаров в маппинге: 63318
[2025-08-28 12:51:14] Категорий в маппинге: 419
[2025-08-28 12:51:14] Проверка признаков завершена за 0:00:00.054564
[2025-08-28 12:51:14] === ОБУЧЕНИЕ LightGBM ===
[2025-08-28 12:51:14] === ДЕБАГ ИНФОРМАЦИЯ: TRAIN ===
[2025-08-28 12:51:14] Размер: 92421 строк
[2025-08-28 12:51:14] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'user_count_right', 'user_mean_right', 'user_sum_right', 'user_max_right', 'user_min_right', 'user_orders_count_right', 'emb_0_right', 'emb_1_right', 'emb_2_right', 'emb_3_right', 'emb_4_right', 'emb_5_right', 'emb_6_right', 'emb_7_right', 'emb_8_right', 'emb_9_right', 'emb_10_right', 'emb_11_right', 'copurchase_count']
[2025-08-28 12:51:14] ✅ Все признаки присутствуют
[2025-08-28 12:51:14] Целевая переменная: {1: np.int64(49474), 0: np.int64(42947)}
[2025-08-28 12:51:14] Пример первой строки:
[2025-08-28 12:51:14]   item_id: 325362256
[2025-08-28 12:51:14]   user_id: 4384320
[2025-08-28 12:51:14]   created_timestamp: 2025-06-07 00:02:30.563000
[2025-08-28 12:51:14]   last_status: canceled_orders
[2025-08-28 12:51:14]   target: 0
[2025-08-28 12:51:14]   weight: 0.0
[2025-08-28 12:51:14]   user_count: nan
[2025-08-28 12:51:14]   user_mean: nan
[2025-08-28 12:51:14]   user_sum: nan
[2025-08-28 12:51:14]   user_max: nan
[2025-08-28 12:51:14]   user_min: nan
[2025-08-28 12:51:14]   user_orders_count: nan
[2025-08-28 12:51:14]   emb_0: 3.0
[2025-08-28 12:51:14]   emb_1: 4.960572719573975
[2025-08-28 12:51:14]   emb_2: 14.881718635559082
[2025-08-28 12:51:14]   emb_3: 6.63095235824585
[2025-08-28 12:51:14]   emb_4: 1.8000136613845825
[2025-08-28 12:51:14]   emb_5: 6.0
[2025-08-28 12:51:14]   emb_6: 7593.0
[2025-08-28 12:51:14]   emb_7: 0.49479612708091736
[2025-08-28 12:51:14]   emb_8: 1.4401195049285889
[2025-08-28 12:51:14]   emb_9: 0.3951679468154907
[2025-08-28 12:51:14]   emb_10: -0.33508893847465515
[2025-08-28 12:51:14]   emb_11: 0.31990957260131836
[2025-08-28 12:51:14]   user_count_right: nan
[2025-08-28 12:51:14]   user_mean_right: nan
[2025-08-28 12:51:14]   user_sum_right: nan
[2025-08-28 12:51:14]   user_max_right: nan
[2025-08-28 12:51:14]   user_min_right: nan
[2025-08-28 12:51:14]   user_orders_count_right: nan
[2025-08-28 12:51:14]   emb_0_right: 3.0
[2025-08-28 12:51:14]   emb_1_right: 4.960572719573975
[2025-08-28 12:51:14]   emb_2_right: 14.881718635559082
[2025-08-28 12:51:14]   emb_3_right: 6.63095235824585
[2025-08-28 12:51:14]   emb_4_right: 1.8000136613845825
[2025-08-28 12:51:14]   emb_5_right: 6.0
[2025-08-28 12:51:14]   emb_6_right: 7593.0
[2025-08-28 12:51:14]   emb_7_right: 0.49479612708091736
[2025-08-28 12:51:14]   emb_8_right: 1.4401195049285889
[2025-08-28 12:51:14]   emb_9_right: 0.3951679468154907
[2025-08-28 12:51:14]   emb_10_right: -0.33508893847465515
[2025-08-28 12:51:14]   emb_11_right: 0.31990957260131836
[2025-08-28 12:51:14]   copurchase_count: 0.0
[2025-08-28 12:51:14] === ДЕБАГ ИНФОРМАЦИЯ: VAL ===
[2025-08-28 12:51:14] Размер: 22761 строк
[2025-08-28 12:51:14] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'user_count_right', 'user_mean_right', 'user_sum_right', 'user_max_right', 'user_min_right', 'user_orders_count_right', 'emb_0_right', 'emb_1_right', 'emb_2_right', 'emb_3_right', 'emb_4_right', 'emb_5_right', 'emb_6_right', 'emb_7_right', 'emb_8_right', 'emb_9_right', 'emb_10_right', 'emb_11_right', 'copurchase_count']
[2025-08-28 12:51:14] ✅ Все признаки присутствуют
[2025-08-28 12:51:14] Целевая переменная: {1: np.int64(11943), 0: np.int64(10818)}
[2025-08-28 12:51:14] Пример первой строки:
[2025-08-28 12:51:14]   item_id: 76925862
[2025-08-28 12:51:14]   user_id: 4345490
[2025-08-28 12:51:14]   created_timestamp: 2025-05-26 10:19:30.740000
[2025-08-28 12:51:14]   last_status: delivered_orders
[2025-08-28 12:51:14]   target: 1
[2025-08-28 12:51:14]   weight: 0.16394911411495436
[2025-08-28 12:51:14]   user_count: 1
[2025-08-28 12:51:14]   user_mean: 0.16394911411495436
[2025-08-28 12:51:14]   user_sum: 0.16394911411495436
[2025-08-28 12:51:14]   user_max: 0.16394911411495436
[2025-08-28 12:51:14]   user_min: 0.16394911411495436
[2025-08-28 12:51:14]   user_orders_count: 1
[2025-08-28 12:51:14]   emb_0: 1.0
[2025-08-28 12:51:14]   emb_1: 0.163949117064476
[2025-08-28 12:51:14]   emb_2: 0.163949117064476
[2025-08-28 12:51:14]   emb_3: 0.163949117064476
[2025-08-28 12:51:14]   emb_4: 0.163949117064476
[2025-08-28 12:51:14]   emb_5: 1.0
[2025-08-28 12:51:14]   emb_6: 7559.0
[2025-08-28 12:51:14]   emb_7: 0.06157781556248665
[2025-08-28 12:51:14]   emb_8: 1.930505394935608
[2025-08-28 12:51:14]   emb_9: 0.14415627717971802
[2025-08-28 12:51:14]   emb_10: 0.24145019054412842
[2025-08-28 12:51:14]   emb_11: 0.16136065125465393
[2025-08-28 12:51:14]   user_count_right: 1
[2025-08-28 12:51:14]   user_mean_right: 0.16394911411495436
[2025-08-28 12:51:14]   user_sum_right: 0.16394911411495436
[2025-08-28 12:51:14]   user_max_right: 0.16394911411495436
[2025-08-28 12:51:14]   user_min_right: 0.16394911411495436
[2025-08-28 12:51:14]   user_orders_count_right: 1
[2025-08-28 12:51:14]   emb_0_right: 1.0
[2025-08-28 12:51:14]   emb_1_right: 0.163949117064476
[2025-08-28 12:51:14]   emb_2_right: 0.163949117064476
[2025-08-28 12:51:14]   emb_3_right: 0.163949117064476
[2025-08-28 12:51:14]   emb_4_right: 0.163949117064476
[2025-08-28 12:51:14]   emb_5_right: 1.0
[2025-08-28 12:51:14]   emb_6_right: 7559.0
[2025-08-28 12:51:14]   emb_7_right: 0.06157781556248665
[2025-08-28 12:51:14]   emb_8_right: 1.930505394935608
[2025-08-28 12:51:14]   emb_9_right: 0.14415627717971802
[2025-08-28 12:51:14]   emb_10_right: 0.24145019054412842
[2025-08-28 12:51:14]   emb_11_right: 0.16136065125465393
[2025-08-28 12:51:14]   copurchase_count: 0.0
[2025-08-28 12:51:14] Feature columns: ['copurchase_count', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11']
[2025-08-28 12:51:14] Размер train: 92421
[2025-08-28 12:51:14] Используемые признаки: ['copurchase_count', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11']
[2025-08-28 12:51:14] Пример данных: {'copurchase_count': 0.0, 'user_count': nan, 'user_mean': nan, 'user_sum': nan, 'user_max': nan, 'user_min': nan, 'user_orders_count': nan, 'emb_0': 3.0, 'emb_1': 4.960572719573975, 'emb_2': 14.881718635559082, 'emb_3': 6.63095235824585, 'emb_4': 1.8000136613845825, 'emb_5': 6.0, 'emb_6': 7593.0, 'emb_7': 0.49479612708091736, 'emb_8': 1.4401195049285889, 'emb_9': 0.3951679468154907, 'emb_10': -0.33508893847465515, 'emb_11': 0.31990957260131836}
[2025-08-28 12:51:14] Категориальные признаки: ['user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count']
[2025-08-28 12:51:14] Размер val: 22761
[2025-08-28 12:51:14] [Iter 0] train_binary_logloss:0.6882, valid_binary_logloss:0.6912
[2025-08-28 12:51:14] [Iter 50] train_binary_logloss:0.6015, valid_binary_logloss:0.6348
[2025-08-28 12:51:14] [Iter 100] train_binary_logloss:0.5695, valid_binary_logloss:0.6163
[2025-08-28 12:51:14] [Iter 150] train_binary_logloss:0.5539, valid_binary_logloss:0.6090
[2025-08-28 12:51:14] [Iter 200] train_binary_logloss:0.5435, valid_binary_logloss:0.6045
[2025-08-28 12:51:15] [Iter 250] train_binary_logloss:0.5361, valid_binary_logloss:0.6017
[2025-08-28 12:51:15] [Iter 300] train_binary_logloss:0.5298, valid_binary_logloss:0.6016
[2025-08-28 12:51:17] [Iter 350] train_binary_logloss:0.5242, valid_binary_logloss:0.6001
[2025-08-28 12:51:17] [Iter 400] train_binary_logloss:0.5192, valid_binary_logloss:0.5986
[2025-08-28 12:51:17] [Iter 450] train_binary_logloss:0.5144, valid_binary_logloss:0.5970
[2025-08-28 12:51:17] [Iter 500] train_binary_logloss:0.5101, valid_binary_logloss:0.5961
[2025-08-28 12:51:17] [Iter 550] train_binary_logloss:0.5062, valid_binary_logloss:0.5955
[2025-08-28 12:51:17] [Iter 600] train_binary_logloss:0.5023, valid_binary_logloss:0.5950
[2025-08-28 12:51:17] [Iter 650] train_binary_logloss:0.4986, valid_binary_logloss:0.5945
[2025-08-28 12:51:17] [Iter 700] train_binary_logloss:0.4951, valid_binary_logloss:0.5938
[2025-08-28 12:51:17] [Iter 750] train_binary_logloss:0.4917, valid_binary_logloss:0.5936
[2025-08-28 12:51:17] [Iter 800] train_binary_logloss:0.4885, valid_binary_logloss:0.5928
[2025-08-28 12:51:17] [Iter 850] train_binary_logloss:0.4854, valid_binary_logloss:0.5924
[2025-08-28 12:51:18] [Iter 900] train_binary_logloss:0.4824, valid_binary_logloss:0.5925
[2025-08-28 12:51:18] NDCG@100 на валидации: 0.5491
[2025-08-28 12:51:18] Обучение LightGBM завершено за 0:00:04.186675
[2025-08-28 12:51:18] === ВАЖНОСТЬ ПРИЗНАКОВ ===
[2025-08-28 12:51:18] Топ-20 важных признаков:
[2025-08-28 12:51:18]   emb_6: 6038
[2025-08-28 12:51:18]   emb_8: 4513
[2025-08-28 12:51:18]   user_sum: 4439
[2025-08-28 12:51:18]   emb_9: 4397
[2025-08-28 12:51:18]   emb_11: 4183
[2025-08-28 12:51:18]   emb_7: 4104
[2025-08-28 12:51:18]   emb_10: 3950
[2025-08-28 12:51:18]   emb_1: 3599
[2025-08-28 12:51:18]   emb_2: 3310
[2025-08-28 12:51:18]   emb_3: 3055
[2025-08-28 12:51:18]   emb_4: 3019
[2025-08-28 12:51:18]   emb_5: 2248
[2025-08-28 12:51:18]   emb_0: 2226
[2025-08-28 12:51:18]   user_count: 1562
[2025-08-28 12:51:18]   user_max: 1422
[2025-08-28 12:51:18]   user_min: 1103
[2025-08-28 12:51:18]   user_orders_count: 876
[2025-08-28 12:51:18]   user_mean: 622
[2025-08-28 12:51:18]   copurchase_count: 189
[2025-08-28 12:51:18] Анализ важности признаков завершен за 0:00:00.001657
[2025-08-28 12:51:18] === СОХРАНЕНИЕ МОДЕЛИ И ПРИЗНАКОВ ===
[2025-08-28 12:51:18] Сохранение модели завершено за 0:00:00.086858
[2025-08-28 12:51:18] Модель сохранена в: /home/root6/python/e_cup/rec_system/src/models/lgbm_model_full.pkl
[2025-08-28 12:51:18] === ОБУЧЕНИЕ И ПРЕДСКАЗАНИЯ ЗАВЕРШЕНЫ УСПЕШНО ===
[2025-08-28 12:51:18] Общее время выполнения: 0:00:12.241714
[2025-08-28 12:51:18] Пользователей: 95951
[2025-08-28 12:51:18] Товаров: 21340
[2025-08-28 12:51:18] Признаков: 19
[2025-08-28 12:51:18] === СИСТЕМНАЯ ИНФОРМАЦИЯ ===
[2025-08-28 12:51:18] Видеокарта: NVIDIA GeForce RTX 4090
[2025-08-28 12:51:18] Память GPU: 24.0 GB
[2025-08-28 12:51:18] Процессор: 15.6% загрузки
[2025-08-28 12:51:18] Ядра CPU: 32
[2025-08-28 12:51:18] Частота CPU: 2995.2 MHz
[2025-08-28 12:51:18] Оперативная память: 94.2 GB всего, 7.4 GB использовано
[2025-08-28 12:51:18] Частота RAM: информация требует дополнительных библиотек
[2025-08-28 12:51:18] ==========================================
[2025-08-28 12:51:18] ВСЕ ЭТАПЫ ВЫПОЛНЕНЫ УСПЕШНО!
[2025-08-28 12:51:18] ==========================================

=== ОБЩЕЕ ВРЕМЯ ВЫПОЛНЕНИЯ: 0:00:12.242655 ===
