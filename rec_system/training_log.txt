=== НАЧАЛО ОБУЧЕНИЯ 2025-08-31 11:46:32 ===

[2025-08-31 11:46:32] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-08-31 11:46:32] Пользователей: все
[2025-08-31 11:46:32] Данных: 100.0%
[2025-08-31 11:46:32] === ЗАГРУЗКА ДАННЫХ ===
[2025-08-31 11:46:32] Загружаем данные...
[2025-08-31 11:46:32] orders: найдено 5 файлов, используем 5
[2025-08-31 11:46:34] orders: ограничено 100,000 из 18,887,122 строк (семплирование 0.5%, использовано 5 файлов), ~4.5 MB
[2025-08-31 11:46:34] tracker: найдено 200 файлов, используем 200
[2025-08-31 11:48:30] tracker: ограничено 100,003 из 1,644,982,482 строк (семплирование 0.0%, использовано 200 файлов), ~4.0 MB
[2025-08-31 11:48:30] items: найдено 100 файлов, используем 100
[2025-08-31 11:48:42] items: ограничено 99,999 из 6,439,422 строк (семплирование 1.6%, использовано 100 файлов), ~17.6 MB
[2025-08-31 11:48:42] categories: найдено 1 файлов, используем 1
[2025-08-31 11:48:42] categories: 7,012 строк (использовано 1 файлов), ~1.7 MB
[2025-08-31 11:48:42] test_users: найдено 1 файлов, используем 1
[2025-08-31 11:48:42] test_users: ограничено 100,000 из 470,347 строк (семплирование 21.3%, использовано 1 файлов), ~1.1 MB
[2025-08-31 11:48:42] Данные загружены
[2025-08-31 11:48:42] Фильтрация данных...
[2025-08-31 11:48:42] Фильтрация завершена
[2025-08-31 11:48:42] Загрузка данных завершена за 0:02:10.742804
[2025-08-31 11:48:42] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-08-31 11:48:42] Оптимизированная потоковая загрузка эмбеддингов...
[2025-08-31 11:48:49] Загружено эмбеддингов для 99965 товаров
[2025-08-31 11:48:49] Пример ключей в embeddings_dict: [313302306, 323611609, 313930510, 20238674, 113158168]
[2025-08-31 11:48:49] Пример значения: [-0.43847105 -0.2937355  -0.29772258 -0.02423434  0.07749109]
[2025-08-31 11:48:49] Загрузка эмбеддингов завершена за 0:00:06.663148
[2025-08-31 11:48:49] Загружено эмбеддингов: 99965
[2025-08-31 11:48:49] === SPLIT ДАННЫХ ===
[2025-08-31 11:48:50] Split данных завершен за 0:00:00.785748
[2025-08-31 11:48:50] Train orders: 75927, Test orders: 18981
[2025-08-31 11:48:50] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-08-31 11:48:50] Формируем матрицу взаимодействий по батчам...
[2025-08-31 11:48:50] ... обработка orders
[2025-08-31 11:48:50] Сохранен orders-батч 0-75927
[2025-08-31 11:48:50] ... обработка tracker
[2025-08-31 11:48:50] Обрабатываем 10 файлов tracker
[2025-08-31 11:48:51] Обработан tracker файл 0: 5188929 строк
[2025-08-31 11:48:53] Обработан tracker файл 1: 5073468 строк
[2025-08-31 11:48:54] Обработан tracker файл 2: 5029377 строк
[2025-08-31 11:48:55] Обработан tracker файл 3: 4971688 строк
[2025-08-31 11:48:57] Обработан tracker файл 4: 4974471 строк
[2025-08-31 11:48:58] Обработан tracker файл 5: 5203839 строк
[2025-08-31 11:48:59] Обработан tracker файл 6: 5015217 строк
[2025-08-31 11:49:01] Обработан tracker файл 7: 5170396 строк
[2025-08-31 11:49:02] Обработан tracker файл 8: 5105038 строк
[2025-08-31 11:49:03] Обработан tracker файл 9: 5052613 строк
[2025-08-31 11:49:03] ✅ Все файлы успешно созданы
[2025-08-31 11:49:03] Всего файлов взаимодействий: 11
[2025-08-31 11:49:03] Подготовка взаимодействий завершена за 0:00:13.491053
[2025-08-31 11:49:03] Создано файлов взаимодействий: 11
[2025-08-31 11:49:03] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-08-31 11:49:12] Словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/recent_items_map.pkl
[2025-08-31 11:49:12] Построение recent items map завершено за 0:00:08.865789
[2025-08-31 11:49:12] Пользователей с recent items: 942062
[2025-08-31 11:49:12] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-08-31 11:49:12] Первый проход: построение маппингов...
[2025-08-31 11:49:13] Маппинги построены. Уников: users=942062, items=305026
[2025-08-31 11:49:13] item_map сохранен: /home/root6/python/e_cup/rec_system/data/processed/item_map.pkl
[2025-08-31 11:49:13] Сохранение батчей на диск...
[2025-08-31 11:49:14] Обучение als_model...
[2025-08-31 11:49:20] Очистка временных файлов...
[2025-08-31 11:49:21] Директория батчей удалена
[2025-08-31 11:49:21] Обучение завершено!
[2025-08-31 11:49:21] Считаем глобальную популярность на основе тренировочных данных...
[2025-08-31 11:49:21] Глобальная популярность рассчитана на 75926 тренировочных заказах
[2025-08-31 11:49:21] Обучение ALS завершено за 0:00:08.392523
[2025-08-31 11:49:21] Пользователей: 942062, Товаров: 305026
[2025-08-31 11:49:21] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-08-31 11:49:21] Строим co-purchase матрицу для топ-N товаров...
[2025-08-31 11:49:21] Топ-500 популярных товаров определены
[2025-08-31 11:49:22] Обрабатываем 1 корзин с популярными товарами
[2025-08-31 11:49:22] Уникальных популярных товаров: 500
[2025-08-31 11:49:22] Создаем sparse матрицу из 2 взаимодействий...
[2025-08-31 11:49:22] Sparse матрица построена: torch.Size([500, 500]), ненулевых элементов: 2
[2025-08-31 11:49:22] Формируем рекомендации...
[2025-08-31 11:49:22] Co-purchase словарь построен для 2 товаров
[2025-08-31 11:49:22] В среднем 1.0 рекомендаций на товар
[2025-08-31 11:49:22] Co-purchase map построен: 2 товаров
[2025-08-31 11:49:27] Построение категорийных маппингов...
[2025-08-31 11:49:27] Категорийные маппинги построены: 99965 товаров, 430 категорий
[2025-08-31 11:49:27] Построение дополнительных данных завершено за 0:00:06.768851
[2025-08-31 11:49:27] === ПРЕДВАРИТЕЛЬНЫЙ РАСЧЕТ ПРИЗНАКОВ ДЛЯ LGBM ===
[2025-08-31 11:49:27] Построение словаря пользовательских признаков...
[2025-08-31 11:49:28] Агрегация по заказам...
[2025-08-31 11:49:30] Словарь пользовательских признаков построен и сохранён в /home/root6/python/e_cup/rec_system/data/processed/cat_to_items.pkl. Записей: 942063
[2025-08-31 11:49:30] User features построены за 0:00:02.653454: 942063 пользователей
[2025-08-31 11:49:30] Построение словаря товарных признаков с батчевой обработкой...
[2025-08-31 11:49:30] Батчевая агрегация взаимодействий...
[2025-08-31 11:49:31] Объединение статистик...
[2025-08-31 11:49:31] Обработка заказов...
[2025-08-31 11:49:33] Ошибка обработки партиции 3: tuple index out of range
[2025-08-31 11:49:33] Ошибка обработки партиции 4: tuple index out of range
[2025-08-31 11:49:33] Обработка items...
[2025-08-31 11:49:34] Объединение всех данных...
[2025-08-31 11:49:34] Создание финального словаря...
[2025-08-31 11:49:34] Добавление эмбеддингов...
[2025-08-31 11:49:36] Очистка временных файлов...
[2025-08-31 11:49:36] Словарь товарных признаков построен. Записей: 416431
[2025-08-31 11:49:38] Item features: 416431 товаров, размер вектора: 107 признаков
[2025-08-31 11:49:38] Порядок признаков: ['item_category', 'item_count', 'item_max', 'item_orders_count', 'item_sum', 'item_mean', 'item_min', 'fclip_embed_0', 'fclip_embed_1', 'fclip_embed_2']...
[2025-08-31 11:49:38] item_features_dict[27262977] type=<class 'numpy.ndarray'>, shape=(107,), example=[  0.        78.        33.603752   0.       560.95593 ]
[2025-08-31 11:49:38] item_features_dict[298844161] type=<class 'numpy.ndarray'>, shape=(107,), example=[  0.        13.        31.945831   0.       105.68125 ]
[2025-08-31 11:49:38] item_features_dict[251658241] type=<class 'numpy.ndarray'>, shape=(107,), example=[  0.       26.       27.6001    0.      147.07137]
[2025-08-31 11:49:38] item_features_dict[286261250] type=<class 'numpy.ndarray'>, shape=(107,), example=[ 0.        1.       12.424533  1.       12.424533]
[2025-08-31 11:49:38] item_features_dict[300941313] type=<class 'numpy.ndarray'>, shape=(107,), example=[0. 0. 0. 1. 0.]
[2025-08-31 11:49:39] Item features построены за 0:00:08.748468
[2025-08-31 11:49:39] === ПОДГОТОВКА ДАННЫХ ДЛЯ LightGBM ===
[2025-08-31 11:49:39] Подготовка данных для LightGBM (streaming, polars lazy, векторно)...
[2025-08-31 11:49:50] ✅ Данные подготовлены без утечек памяти
[2025-08-31 11:49:51] Размер train: 124478, validation: 420
[2025-08-31 11:49:51] Признаки: 107
[2025-08-31 11:49:51] Подготовка данных для LightGBM завершена за 0:00:12.184049
[2025-08-31 11:49:51] === ДЕТАЛЬНАЯ ПРОВЕРКА FEATURE GENERATION ===
[2025-08-31 11:49:51] --- ПРОВЕРКА USER FEATURES ---
[2025-08-31 11:49:51] Пример user features для пользователя 595761:
[2025-08-31 11:49:51]   user_count: 5
[2025-08-31 11:49:51]   user_mean: 4.263153188875014
[2025-08-31 11:49:51]   user_sum: 21.31576594437507
[2025-08-31 11:49:51]   user_max: 6.089044875446846
[2025-08-31 11:49:51]   user_min: 2.8701690505786455
[2025-08-31 11:49:51]   user_orders_count: 0
[2025-08-31 11:49:51] Пользователей с features: 942063
[2025-08-31 11:49:51] Пользователей с НЕнулевыми features: 942063
[2025-08-31 11:49:51] --- ПРОВЕРКА ITEM FEATURES ---
[2025-08-31 11:49:51] Пример item features для товара 27262977:
[2025-08-31 11:49:51]   emb_0: 0.0
[2025-08-31 11:49:51]   emb_1: 78.0
[2025-08-31 11:49:51]   emb_2: 33.60375213623047
[2025-08-31 11:49:51]   emb_3: 0.0
[2025-08-31 11:49:51]   emb_4: 560.9559326171875
[2025-08-31 11:49:51]   emb_5: 7.191742897033691
[2025-08-31 11:49:51]   emb_6: 5.888877868652344
[2025-08-31 11:49:51]   emb_7: 0.0
[2025-08-31 11:49:51]   emb_8: 0.0
[2025-08-31 11:49:51]   emb_9: 0.0
[2025-08-31 11:49:51]   emb_10: 0.0
[2025-08-31 11:49:51]   emb_11: 0.0
[2025-08-31 11:49:51]   emb_12: 0.0
[2025-08-31 11:49:51]   emb_13: 0.0
[2025-08-31 11:49:51]   emb_14: 0.0
[2025-08-31 11:49:51]   emb_15: 0.0
[2025-08-31 11:49:51]   emb_16: 0.0
[2025-08-31 11:49:51]   emb_17: 0.0
[2025-08-31 11:49:51]   emb_18: 0.0
[2025-08-31 11:49:51]   emb_19: 0.0
[2025-08-31 11:49:51]   emb_20: 0.0
[2025-08-31 11:49:51]   emb_21: 0.0
[2025-08-31 11:49:51]   emb_22: 0.0
[2025-08-31 11:49:51]   emb_23: 0.0
[2025-08-31 11:49:51]   emb_24: 0.0
[2025-08-31 11:49:51]   emb_25: 0.0
[2025-08-31 11:49:51]   emb_26: 0.0
[2025-08-31 11:49:51]   emb_27: 0.0
[2025-08-31 11:49:51]   emb_28: 0.0
[2025-08-31 11:49:51]   emb_29: 0.0
[2025-08-31 11:49:51]   emb_30: 0.0
[2025-08-31 11:49:51]   emb_31: 0.0
[2025-08-31 11:49:51]   emb_32: 0.0
[2025-08-31 11:49:51]   emb_33: 0.0
[2025-08-31 11:49:51]   emb_34: 0.0
[2025-08-31 11:49:51]   emb_35: 0.0
[2025-08-31 11:49:51]   emb_36: 0.0
[2025-08-31 11:49:51]   emb_37: 0.0
[2025-08-31 11:49:51]   emb_38: 0.0
[2025-08-31 11:49:51]   emb_39: 0.0
[2025-08-31 11:49:51]   emb_40: 0.0
[2025-08-31 11:49:51]   emb_41: 0.0
[2025-08-31 11:49:51]   emb_42: 0.0
[2025-08-31 11:49:51]   emb_43: 0.0
[2025-08-31 11:49:51]   emb_44: 0.0
[2025-08-31 11:49:51]   emb_45: 0.0
[2025-08-31 11:49:51]   emb_46: 0.0
[2025-08-31 11:49:51]   emb_47: 0.0
[2025-08-31 11:49:51]   emb_48: 0.0
[2025-08-31 11:49:51]   emb_49: 0.0
[2025-08-31 11:49:51]   emb_50: 0.0
[2025-08-31 11:49:51]   emb_51: 0.0
[2025-08-31 11:49:51]   emb_52: 0.0
[2025-08-31 11:49:51]   emb_53: 0.0
[2025-08-31 11:49:51]   emb_54: 0.0
[2025-08-31 11:49:51]   emb_55: 0.0
[2025-08-31 11:49:51]   emb_56: 0.0
[2025-08-31 11:49:51]   emb_57: 0.0
[2025-08-31 11:49:51]   emb_58: 0.0
[2025-08-31 11:49:51]   emb_59: 0.0
[2025-08-31 11:49:51]   emb_60: 0.0
[2025-08-31 11:49:51]   emb_61: 0.0
[2025-08-31 11:49:51]   emb_62: 0.0
[2025-08-31 11:49:51]   emb_63: 0.0
[2025-08-31 11:49:51]   emb_64: 0.0
[2025-08-31 11:49:51]   emb_65: 0.0
[2025-08-31 11:49:51]   emb_66: 0.0
[2025-08-31 11:49:51]   emb_67: 0.0
[2025-08-31 11:49:51]   emb_68: 0.0
[2025-08-31 11:49:51]   emb_69: 0.0
[2025-08-31 11:49:51]   emb_70: 0.0
[2025-08-31 11:49:51]   emb_71: 0.0
[2025-08-31 11:49:51]   emb_72: 0.0
[2025-08-31 11:49:51]   emb_73: 0.0
[2025-08-31 11:49:51]   emb_74: 0.0
[2025-08-31 11:49:51]   emb_75: 0.0
[2025-08-31 11:49:51]   emb_76: 0.0
[2025-08-31 11:49:51]   emb_77: 0.0
[2025-08-31 11:49:51]   emb_78: 0.0
[2025-08-31 11:49:51]   emb_79: 0.0
[2025-08-31 11:49:51]   emb_80: 0.0
[2025-08-31 11:49:51]   emb_81: 0.0
[2025-08-31 11:49:51]   emb_82: 0.0
[2025-08-31 11:49:51]   emb_83: 0.0
[2025-08-31 11:49:51]   emb_84: 0.0
[2025-08-31 11:49:51]   emb_85: 0.0
[2025-08-31 11:49:51]   emb_86: 0.0
[2025-08-31 11:49:51]   emb_87: 0.0
[2025-08-31 11:49:51]   emb_88: 0.0
[2025-08-31 11:49:51]   emb_89: 0.0
[2025-08-31 11:49:51]   emb_90: 0.0
[2025-08-31 11:49:51]   emb_91: 0.0
[2025-08-31 11:49:51]   emb_92: 0.0
[2025-08-31 11:49:51]   emb_93: 0.0
[2025-08-31 11:49:51]   emb_94: 0.0
[2025-08-31 11:49:51]   emb_95: 0.0
[2025-08-31 11:49:51]   emb_96: 0.0
[2025-08-31 11:49:51]   emb_97: 0.0
[2025-08-31 11:49:51]   emb_98: 0.0
[2025-08-31 11:49:51]   emb_99: 0.0
[2025-08-31 11:49:55] Товаров с features: 416431
[2025-08-31 11:49:55] Товаров с НЕнулевыми features: 416431
[2025-08-31 11:49:55] --- ПРОВЕРКА ЭМБЕДДИНГОВ ---
[2025-08-31 11:49:55] Пример эмбеддинга для товара 313302306: shape (512,)
[2025-08-31 11:49:55] Эмбеддингов загружено: 99965
[2025-08-31 11:49:55] Пример значений: [-0.43847105 -0.2937355  -0.29772258 -0.02423434  0.07749109]
[2025-08-31 11:49:55] --- ПРОВЕРКА CO-PURCHASE MAP ---
[2025-08-31 11:49:55] Пример co-purchase для товара 229404153: 1 товаров
[2025-08-31 11:49:55] Co-purchase записей: 2
[2025-08-31 11:49:55] --- ПРОВЕРКА КАТЕГОРИЙНЫХ МАППИНГОВ ---
[2025-08-31 11:49:55] Товар 313302306 -> категория 7646
[2025-08-31 11:49:55] Категория 7646 -> 493 товаров
[2025-08-31 11:49:55] Товаров в маппинге: 99965
[2025-08-31 11:49:55] Категорий в маппинге: 430
[2025-08-31 11:49:55] Проверка признаков завершена за 0:00:04.169157
[2025-08-31 11:49:55] === ОБУЧЕНИЕ LightGBM ===
[2025-08-31 11:49:55] === ДЕБАГ ИНФОРМАЦИЯ: TRAIN ===
[2025-08-31 11:49:55] Размер: 124478 строк
[2025-08-31 11:49:55] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'emb_12', 'emb_13', 'emb_14', 'emb_15', 'emb_16', 'emb_17', 'emb_18', 'emb_19', 'emb_20', 'emb_21', 'emb_22', 'emb_23', 'emb_24', 'emb_25', 'emb_26', 'emb_27', 'emb_28', 'emb_29', 'emb_30', 'emb_31', 'emb_32', 'emb_33', 'emb_34', 'emb_35', 'emb_36', 'emb_37', 'emb_38', 'emb_39', 'emb_40', 'emb_41', 'emb_42', 'emb_43', 'emb_44', 'emb_45', 'emb_46', 'emb_47', 'emb_48', 'emb_49', 'emb_50', 'emb_51', 'emb_52', 'emb_53', 'emb_54', 'emb_55', 'emb_56', 'emb_57', 'emb_58', 'emb_59', 'emb_60', 'emb_61', 'emb_62', 'emb_63', 'emb_64', 'emb_65', 'emb_66', 'emb_67', 'emb_68', 'emb_69', 'emb_70', 'emb_71', 'emb_72', 'emb_73', 'emb_74', 'emb_75', 'emb_76', 'emb_77', 'emb_78', 'emb_79', 'emb_80', 'emb_81', 'emb_82', 'emb_83', 'emb_84', 'emb_85', 'emb_86', 'emb_87', 'emb_88', 'emb_89', 'emb_90', 'emb_91', 'emb_92', 'emb_93', 'emb_94', 'emb_95', 'emb_96', 'emb_97', 'emb_98', 'emb_99', 'copurchase_count']
[2025-08-31 11:49:55] ✅ Все признаки присутствуют
[2025-08-31 11:49:55] Целевая переменная: {1: np.int64(68276), 0: np.int64(56202)}
[2025-08-31 11:49:55] Пример первой строки:
[2025-08-31 11:49:55]   item_id: 300089455
[2025-08-31 11:49:55]   user_id: 1644830
[2025-08-31 11:49:55]   created_timestamp: 2025-06-12 07:41:37.380000
[2025-08-31 11:49:55]   last_status: canceled_orders
[2025-08-31 11:49:55]   target: 0
[2025-08-31 11:49:55]   weight: 0.0
[2025-08-31 11:49:55]   user_count: 84.0
[2025-08-31 11:49:55]   user_mean: 5.60012567437289
[2025-08-31 11:49:55]   user_sum: 470.4105566473228
[2025-08-31 11:49:55]   user_max: 33.250360206965915
[2025-08-31 11:49:55]   user_min: 0.36464311358790924
[2025-08-31 11:49:55]   user_orders_count: 1.0
[2025-08-31 11:49:55]   emb_0: 0.0
[2025-08-31 11:49:55]   emb_1: 0.0
[2025-08-31 11:49:55]   emb_2: 0.0
[2025-08-31 11:49:55]   emb_3: 1.0
[2025-08-31 11:49:55]   emb_4: 0.0
[2025-08-31 11:49:55]   emb_5: 0.0
[2025-08-31 11:49:55]   emb_6: 0.0
[2025-08-31 11:49:55]   emb_7: 0.0
[2025-08-31 11:49:55]   emb_8: 0.0
[2025-08-31 11:49:55]   emb_9: 0.0
[2025-08-31 11:49:55]   emb_10: 0.0
[2025-08-31 11:49:55]   emb_11: 0.0
[2025-08-31 11:49:55]   emb_12: 0.0
[2025-08-31 11:49:55]   emb_13: 0.0
[2025-08-31 11:49:55]   emb_14: 0.0
[2025-08-31 11:49:55]   emb_15: 0.0
[2025-08-31 11:49:55]   emb_16: 0.0
[2025-08-31 11:49:55]   emb_17: 0.0
[2025-08-31 11:49:55]   emb_18: 0.0
[2025-08-31 11:49:55]   emb_19: 0.0
[2025-08-31 11:49:55]   emb_20: 0.0
[2025-08-31 11:49:55]   emb_21: 0.0
[2025-08-31 11:49:55]   emb_22: 0.0
[2025-08-31 11:49:55]   emb_23: 0.0
[2025-08-31 11:49:55]   emb_24: 0.0
[2025-08-31 11:49:55]   emb_25: 0.0
[2025-08-31 11:49:55]   emb_26: 0.0
[2025-08-31 11:49:55]   emb_27: 0.0
[2025-08-31 11:49:55]   emb_28: 0.0
[2025-08-31 11:49:55]   emb_29: 0.0
[2025-08-31 11:49:55]   emb_30: 0.0
[2025-08-31 11:49:55]   emb_31: 0.0
[2025-08-31 11:49:55]   emb_32: 0.0
[2025-08-31 11:49:55]   emb_33: 0.0
[2025-08-31 11:49:55]   emb_34: 0.0
[2025-08-31 11:49:55]   emb_35: 0.0
[2025-08-31 11:49:55]   emb_36: 0.0
[2025-08-31 11:49:55]   emb_37: 0.0
[2025-08-31 11:49:55]   emb_38: 0.0
[2025-08-31 11:49:55]   emb_39: 0.0
[2025-08-31 11:49:55]   emb_40: 0.0
[2025-08-31 11:49:55]   emb_41: 0.0
[2025-08-31 11:49:55]   emb_42: 0.0
[2025-08-31 11:49:55]   emb_43: 0.0
[2025-08-31 11:49:55]   emb_44: 0.0
[2025-08-31 11:49:55]   emb_45: 0.0
[2025-08-31 11:49:55]   emb_46: 0.0
[2025-08-31 11:49:55]   emb_47: 0.0
[2025-08-31 11:49:55]   emb_48: 0.0
[2025-08-31 11:49:55]   emb_49: 0.0
[2025-08-31 11:49:55]   emb_50: 0.0
[2025-08-31 11:49:55]   emb_51: 0.0
[2025-08-31 11:49:55]   emb_52: 0.0
[2025-08-31 11:49:55]   emb_53: 0.0
[2025-08-31 11:49:55]   emb_54: 0.0
[2025-08-31 11:49:55]   emb_55: 0.0
[2025-08-31 11:49:55]   emb_56: 0.0
[2025-08-31 11:49:55]   emb_57: 0.0
[2025-08-31 11:49:55]   emb_58: 0.0
[2025-08-31 11:49:55]   emb_59: 0.0
[2025-08-31 11:49:55]   emb_60: 0.0
[2025-08-31 11:49:55]   emb_61: 0.0
[2025-08-31 11:49:55]   emb_62: 0.0
[2025-08-31 11:49:55]   emb_63: 0.0
[2025-08-31 11:49:55]   emb_64: 0.0
[2025-08-31 11:49:55]   emb_65: 0.0
[2025-08-31 11:49:55]   emb_66: 0.0
[2025-08-31 11:49:55]   emb_67: 0.0
[2025-08-31 11:49:55]   emb_68: 0.0
[2025-08-31 11:49:55]   emb_69: 0.0
[2025-08-31 11:49:55]   emb_70: 0.0
[2025-08-31 11:49:55]   emb_71: 0.0
[2025-08-31 11:49:55]   emb_72: 0.0
[2025-08-31 11:49:55]   emb_73: 0.0
[2025-08-31 11:49:55]   emb_74: 0.0
[2025-08-31 11:49:55]   emb_75: 0.0
[2025-08-31 11:49:55]   emb_76: 0.0
[2025-08-31 11:49:55]   emb_77: 0.0
[2025-08-31 11:49:55]   emb_78: 0.0
[2025-08-31 11:49:55]   emb_79: 0.0
[2025-08-31 11:49:55]   emb_80: 0.0
[2025-08-31 11:49:55]   emb_81: 0.0
[2025-08-31 11:49:55]   emb_82: 0.0
[2025-08-31 11:49:55]   emb_83: 0.0
[2025-08-31 11:49:55]   emb_84: 0.0
[2025-08-31 11:49:55]   emb_85: 0.0
[2025-08-31 11:49:55]   emb_86: 0.0
[2025-08-31 11:49:55]   emb_87: 0.0
[2025-08-31 11:49:55]   emb_88: 0.0
[2025-08-31 11:49:55]   emb_89: 0.0
[2025-08-31 11:49:55]   emb_90: 0.0
[2025-08-31 11:49:55]   emb_91: 0.0
[2025-08-31 11:49:55]   emb_92: 0.0
[2025-08-31 11:49:55]   emb_93: 0.0
[2025-08-31 11:49:55]   emb_94: 0.0
[2025-08-31 11:49:55]   emb_95: 0.0
[2025-08-31 11:49:55]   emb_96: 0.0
[2025-08-31 11:49:55]   emb_97: 0.0
[2025-08-31 11:49:55]   emb_98: 0.0
[2025-08-31 11:49:55]   emb_99: 0.0
[2025-08-31 11:49:55]   copurchase_count: 0.0
[2025-08-31 11:49:55] === ДЕБАГ ИНФОРМАЦИЯ: VAL ===
[2025-08-31 11:49:55] Размер: 420 строк
[2025-08-31 11:49:55] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'emb_12', 'emb_13', 'emb_14', 'emb_15', 'emb_16', 'emb_17', 'emb_18', 'emb_19', 'emb_20', 'emb_21', 'emb_22', 'emb_23', 'emb_24', 'emb_25', 'emb_26', 'emb_27', 'emb_28', 'emb_29', 'emb_30', 'emb_31', 'emb_32', 'emb_33', 'emb_34', 'emb_35', 'emb_36', 'emb_37', 'emb_38', 'emb_39', 'emb_40', 'emb_41', 'emb_42', 'emb_43', 'emb_44', 'emb_45', 'emb_46', 'emb_47', 'emb_48', 'emb_49', 'emb_50', 'emb_51', 'emb_52', 'emb_53', 'emb_54', 'emb_55', 'emb_56', 'emb_57', 'emb_58', 'emb_59', 'emb_60', 'emb_61', 'emb_62', 'emb_63', 'emb_64', 'emb_65', 'emb_66', 'emb_67', 'emb_68', 'emb_69', 'emb_70', 'emb_71', 'emb_72', 'emb_73', 'emb_74', 'emb_75', 'emb_76', 'emb_77', 'emb_78', 'emb_79', 'emb_80', 'emb_81', 'emb_82', 'emb_83', 'emb_84', 'emb_85', 'emb_86', 'emb_87', 'emb_88', 'emb_89', 'emb_90', 'emb_91', 'emb_92', 'emb_93', 'emb_94', 'emb_95', 'emb_96', 'emb_97', 'emb_98', 'emb_99', 'copurchase_count']
[2025-08-31 11:49:55] ✅ Все признаки присутствуют
[2025-08-31 11:49:55] Целевая переменная: {1: np.int64(210), 0: np.int64(210)}
[2025-08-31 11:49:55] Пример первой строки:
[2025-08-31 11:49:55]   item_id: 315679221
[2025-08-31 11:49:55]   user_id: 629560
[2025-08-31 11:49:55]   created_timestamp: 2025-05-26 21:38:20.290000
[2025-08-31 11:49:55]   last_status: delivered_orders
[2025-08-31 11:49:55]   target: 1
[2025-08-31 11:49:55]   weight: 0.9116077839697732
[2025-08-31 11:49:55]   user_count: 116
[2025-08-31 11:49:55]   user_mean: 4.944340058990521
[2025-08-31 11:49:55]   user_sum: 573.5434468429005
[2025-08-31 11:49:55]   user_max: 31.945831322991562
[2025-08-31 11:49:55]   user_min: 0.36464311358790924
[2025-08-31 11:49:55]   user_orders_count: 1
[2025-08-31 11:49:55]   emb_0: 0.0
[2025-08-31 11:49:55]   emb_1: 1.0
[2025-08-31 11:49:55]   emb_2: 0.9116078019142151
[2025-08-31 11:49:55]   emb_3: 1.0
[2025-08-31 11:49:55]   emb_4: 0.9116078019142151
[2025-08-31 11:49:55]   emb_5: 0.9116078019142151
[2025-08-31 11:49:55]   emb_6: 0.9116078019142151
[2025-08-31 11:49:55]   emb_7: 0.0
[2025-08-31 11:49:55]   emb_8: 0.0
[2025-08-31 11:49:55]   emb_9: 0.0
[2025-08-31 11:49:55]   emb_10: 0.0
[2025-08-31 11:49:55]   emb_11: 0.0
[2025-08-31 11:49:55]   emb_12: 0.0
[2025-08-31 11:49:55]   emb_13: 0.0
[2025-08-31 11:49:55]   emb_14: 0.0
[2025-08-31 11:49:55]   emb_15: 0.0
[2025-08-31 11:49:55]   emb_16: 0.0
[2025-08-31 11:49:55]   emb_17: 0.0
[2025-08-31 11:49:55]   emb_18: 0.0
[2025-08-31 11:49:55]   emb_19: 0.0
[2025-08-31 11:49:55]   emb_20: 0.0
[2025-08-31 11:49:55]   emb_21: 0.0
[2025-08-31 11:49:55]   emb_22: 0.0
[2025-08-31 11:49:55]   emb_23: 0.0
[2025-08-31 11:49:55]   emb_24: 0.0
[2025-08-31 11:49:55]   emb_25: 0.0
[2025-08-31 11:49:55]   emb_26: 0.0
[2025-08-31 11:49:55]   emb_27: 0.0
[2025-08-31 11:49:55]   emb_28: 0.0
[2025-08-31 11:49:55]   emb_29: 0.0
[2025-08-31 11:49:55]   emb_30: 0.0
[2025-08-31 11:49:55]   emb_31: 0.0
[2025-08-31 11:49:55]   emb_32: 0.0
[2025-08-31 11:49:55]   emb_33: 0.0
[2025-08-31 11:49:55]   emb_34: 0.0
[2025-08-31 11:49:55]   emb_35: 0.0
[2025-08-31 11:49:55]   emb_36: 0.0
[2025-08-31 11:49:55]   emb_37: 0.0
[2025-08-31 11:49:55]   emb_38: 0.0
[2025-08-31 11:49:55]   emb_39: 0.0
[2025-08-31 11:49:55]   emb_40: 0.0
[2025-08-31 11:49:55]   emb_41: 0.0
[2025-08-31 11:49:55]   emb_42: 0.0
[2025-08-31 11:49:55]   emb_43: 0.0
[2025-08-31 11:49:55]   emb_44: 0.0
[2025-08-31 11:49:55]   emb_45: 0.0
[2025-08-31 11:49:55]   emb_46: 0.0
[2025-08-31 11:49:55]   emb_47: 0.0
[2025-08-31 11:49:55]   emb_48: 0.0
[2025-08-31 11:49:55]   emb_49: 0.0
[2025-08-31 11:49:55]   emb_50: 0.0
[2025-08-31 11:49:55]   emb_51: 0.0
[2025-08-31 11:49:55]   emb_52: 0.0
[2025-08-31 11:49:55]   emb_53: 0.0
[2025-08-31 11:49:55]   emb_54: 0.0
[2025-08-31 11:49:55]   emb_55: 0.0
[2025-08-31 11:49:55]   emb_56: 0.0
[2025-08-31 11:49:55]   emb_57: 0.0
[2025-08-31 11:49:55]   emb_58: 0.0
[2025-08-31 11:49:55]   emb_59: 0.0
[2025-08-31 11:49:55]   emb_60: 0.0
[2025-08-31 11:49:55]   emb_61: 0.0
[2025-08-31 11:49:55]   emb_62: 0.0
[2025-08-31 11:49:55]   emb_63: 0.0
[2025-08-31 11:49:55]   emb_64: 0.0
[2025-08-31 11:49:55]   emb_65: 0.0
[2025-08-31 11:49:55]   emb_66: 0.0
[2025-08-31 11:49:55]   emb_67: 0.0
[2025-08-31 11:49:55]   emb_68: 0.0
[2025-08-31 11:49:55]   emb_69: 0.0
[2025-08-31 11:49:55]   emb_70: 0.0
[2025-08-31 11:49:55]   emb_71: 0.0
[2025-08-31 11:49:55]   emb_72: 0.0
[2025-08-31 11:49:55]   emb_73: 0.0
[2025-08-31 11:49:55]   emb_74: 0.0
[2025-08-31 11:49:55]   emb_75: 0.0
[2025-08-31 11:49:55]   emb_76: 0.0
[2025-08-31 11:49:55]   emb_77: 0.0
[2025-08-31 11:49:55]   emb_78: 0.0
[2025-08-31 11:49:55]   emb_79: 0.0
[2025-08-31 11:49:55]   emb_80: 0.0
[2025-08-31 11:49:55]   emb_81: 0.0
[2025-08-31 11:49:55]   emb_82: 0.0
[2025-08-31 11:49:55]   emb_83: 0.0
[2025-08-31 11:49:55]   emb_84: 0.0
[2025-08-31 11:49:55]   emb_85: 0.0
[2025-08-31 11:49:55]   emb_86: 0.0
[2025-08-31 11:49:55]   emb_87: 0.0
[2025-08-31 11:49:55]   emb_88: 0.0
[2025-08-31 11:49:55]   emb_89: 0.0
[2025-08-31 11:49:55]   emb_90: 0.0
[2025-08-31 11:49:55]   emb_91: 0.0
[2025-08-31 11:49:55]   emb_92: 0.0
[2025-08-31 11:49:55]   emb_93: 0.0
[2025-08-31 11:49:55]   emb_94: 0.0
[2025-08-31 11:49:55]   emb_95: 0.0
[2025-08-31 11:49:55]   emb_96: 0.0
[2025-08-31 11:49:55]   emb_97: 0.0
[2025-08-31 11:49:55]   emb_98: 0.0
[2025-08-31 11:49:55]   emb_99: 0.0
[2025-08-31 11:49:55]   copurchase_count: 0.0
[2025-08-31 11:49:55] Feature columns: ['copurchase_count', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'emb_12', 'emb_13', 'emb_14', 'emb_15', 'emb_16', 'emb_17', 'emb_18', 'emb_19', 'emb_20', 'emb_21', 'emb_22', 'emb_23', 'emb_24', 'emb_25', 'emb_26', 'emb_27', 'emb_28', 'emb_29', 'emb_30', 'emb_31', 'emb_32', 'emb_33', 'emb_34', 'emb_35', 'emb_36', 'emb_37', 'emb_38', 'emb_39', 'emb_40', 'emb_41', 'emb_42', 'emb_43', 'emb_44', 'emb_45', 'emb_46', 'emb_47', 'emb_48', 'emb_49', 'emb_50', 'emb_51', 'emb_52', 'emb_53', 'emb_54', 'emb_55', 'emb_56', 'emb_57', 'emb_58', 'emb_59', 'emb_60', 'emb_61', 'emb_62', 'emb_63', 'emb_64', 'emb_65', 'emb_66', 'emb_67', 'emb_68', 'emb_69', 'emb_70', 'emb_71', 'emb_72', 'emb_73', 'emb_74', 'emb_75', 'emb_76', 'emb_77', 'emb_78', 'emb_79', 'emb_80', 'emb_81', 'emb_82', 'emb_83', 'emb_84', 'emb_85', 'emb_86', 'emb_87', 'emb_88', 'emb_89', 'emb_90', 'emb_91', 'emb_92', 'emb_93', 'emb_94', 'emb_95', 'emb_96', 'emb_97', 'emb_98', 'emb_99']
[2025-08-31 11:49:55] Размер train: 124478
[2025-08-31 11:49:55] Количество пользователей в train: 80149
[2025-08-31 11:49:55] Размер val: 420
[2025-08-31 11:49:55] Количество пользователей в val: 377
[2025-08-31 11:50:10] [Iter 0] train_ndcg@100: 0.119378, valid_ndcg@100: 0.021220
[2025-08-31 11:50:10] ✅ [Iter 0] Новый лучший valid_ndcg@100: 0.021220
[2025-08-31 11:51:12] 🎯 Финальный NDCG@100 на валидации: 0.524730
[2025-08-31 11:51:12] 📈 Лучший NDCG@100: 0.021220 на итерации 0
[2025-08-31 11:51:12] Обучение LightGBM завершено за 0:01:16.616141
[2025-08-31 11:51:12] === ВАЖНОСТЬ ПРИЗНАКОВ ===
[2025-08-31 11:51:12] Топ-20 важных признаков:
[2025-08-31 11:51:12]   emb_1: 32
[2025-08-31 11:51:12]   emb_4: 22
[2025-08-31 11:51:12]   user_sum: 21
[2025-08-31 11:51:12]   user_count: 19
[2025-08-31 11:51:12]   emb_2: 15
[2025-08-31 11:51:12]   emb_5: 12
[2025-08-31 11:51:12]   emb_6: 12
[2025-08-31 11:51:12]   emb_3: 7
[2025-08-31 11:51:12]   user_max: 7
[2025-08-31 11:51:12]   user_orders_count: 3
[2025-08-31 11:51:12]   user_mean: 0
[2025-08-31 11:51:12]   emb_0: 0
[2025-08-31 11:51:12]   user_min: 0
[2025-08-31 11:51:12]   copurchase_count: 0
[2025-08-31 11:51:12]   emb_7: 0
[2025-08-31 11:51:12]   emb_8: 0
[2025-08-31 11:51:12]   emb_9: 0
[2025-08-31 11:51:12]   emb_10: 0
[2025-08-31 11:51:12]   emb_11: 0
[2025-08-31 11:51:12]   emb_12: 0
[2025-08-31 11:51:12] Анализ важности признаков завершен за 0:00:00.001736
[2025-08-31 11:51:12] === СОХРАНЕНИЕ МОДЕЛИ И ПРИЗНАКОВ ===
[2025-08-31 11:51:14] Сохранение модели завершено за 0:00:02.132740
[2025-08-31 11:51:14] Модель сохранена в: /home/root6/python/e_cup/rec_system/src/models/lgbm_model_full.pkl
[2025-08-31 11:51:14] === ОБУЧЕНИЕ И ПРЕДСКАЗАНИЯ ЗАВЕРШЕНЫ УСПЕШНО ===
[2025-08-31 11:51:14] Общее время выполнения: 0:04:42.217165
[2025-08-31 11:51:14] Пользователей: 942062
[2025-08-31 11:51:14] Товаров: 305026
[2025-08-31 11:51:14] Признаков: 107
[2025-08-31 11:51:14] === СИСТЕМНАЯ ИНФОРМАЦИЯ ===
[2025-08-31 11:51:14] Видеокарта: NVIDIA GeForce RTX 4090
[2025-08-31 11:51:14] Память GPU: 24.0 GB
[2025-08-31 11:51:14] Процессор: 21.8% загрузки
[2025-08-31 11:51:14] Ядра CPU: 32
[2025-08-31 11:51:14] Частота CPU: 2995.2 MHz
[2025-08-31 11:51:14] Оперативная память: 94.2 GB всего, 57.9 GB использовано
[2025-08-31 11:51:14] ==========================================
[2025-08-31 11:51:14] ВСЕ ЭТАПЫ ВЫПОЛНЕНЫ УСПЕШНО!
[2025-08-31 11:51:14] ==========================================

=== ОБЩЕЕ ВРЕМЯ ВЫПОЛНЕНИЯ: 0:04:42.218287 ===
