=== НАЧАЛО ОБУЧЕНИЯ 2025-08-27 12:09:07 ===

[2025-08-27 12:09:07] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-08-27 12:09:07] Пользователей: все
[2025-08-27 12:09:07] Данных: 100.0%
[2025-08-27 12:09:07] === ЗАГРУЗКА ДАННЫХ ===
[2025-08-27 12:09:07] Загружаем данные...
[2025-08-27 12:09:07] orders: 1,000 строк (использовано 5 из 5 партиций), ~0.0 MB
[2025-08-27 12:09:08] tracker: 1,000 строк (использовано 200 из 200 партиций), ~0.0 MB
[2025-08-27 12:09:09] items: 1,000 строк (использовано 200 из 200 партиций), ~0.2 MB
[2025-08-27 12:09:09] categories: 1,000 строк (использовано 1 из 1 партиций), ~0.2 MB
[2025-08-27 12:09:09] test_users: 1,000 строк (использовано 1 из 1 партиций), ~0.0 MB
[2025-08-27 12:09:09] Данные загружены
[2025-08-27 12:09:09] Фильтрация данных...
[2025-08-27 12:09:09] Фильтрация завершена
[2025-08-27 12:09:09] Загрузка данных завершена за 0:00:02.112753
[2025-08-27 12:09:09] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-08-27 12:09:09] Оптимизированная потоковая загрузка эмбеддингов...
[2025-08-27 12:09:10] Загружено эмбеддингов для 990 товаров
[2025-08-27 12:09:10] Загрузка эмбеддингов завершена за 0:00:00.770588
[2025-08-27 12:09:10] Загружено эмбеддингов: 990
[2025-08-27 12:09:10] === SPLIT ДАННЫХ ===
[2025-08-27 12:09:10] Split данных завершен за 0:00:00.290423
[2025-08-27 12:09:10] Train orders: 753, Test orders: 187
[2025-08-27 12:09:10] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-08-27 12:09:10] Формируем матрицу взаимодействий по батчам...
[2025-08-27 12:09:10] ... для orders
[2025-08-27 12:09:10] Сохранен orders-батч 0-753
[2025-08-27 12:09:10] ... для tracker
[2025-08-27 12:09:11] Сохранен tracker-партиция 0
[2025-08-27 12:09:11] Все батчи сохранены на диск.
[2025-08-27 12:09:11] Подготовка взаимодействий завершена за 0:00:00.834763
[2025-08-27 12:09:11] Создано файлов взаимодействий: 2
[2025-08-27 12:09:11] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-08-27 12:09:11] Словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/recent_items_map.pkl
[2025-08-27 12:09:11] Построение recent items map завершено за 0:00:00.028711
[2025-08-27 12:09:11] Пользователей с recent items: 1195
[2025-08-27 12:09:11] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-08-27 12:09:11] Первый проход: построение маппингов...
[2025-08-27 12:09:11] Маппинги построены. Уников: users=1195, items=207
[2025-08-27 12:09:11] item_map сохранен: /home/root6/python/e_cup/rec_system/data/processed/item_map.pkl
[2025-08-27 12:09:11] Сохранение батчей на диск...
[2025-08-27 12:09:11] Постепенное обучение...
[2025-08-27 12:09:12] Очистка временных файлов...
[2025-08-27 12:09:12] Директория батчей удалена
[2025-08-27 12:09:12] Обучение завершено!
[2025-08-27 12:09:12] Считаем глобальную популярность на основе тренировочных данных...
[2025-08-27 12:09:12] Глобальная популярность рассчитана на 752 тренировочных заказах
[2025-08-27 12:09:12] Обучение ALS завершено за 0:00:00.784917
[2025-08-27 12:09:12] Пользователей: 1195, Товаров: 207
[2025-08-27 12:09:12] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-08-27 12:09:12] Строим co-purchase матрицу для топ-N товаров...
[2025-08-27 12:09:12] Топ-207 популярных товаров определены
[2025-08-27 12:09:12] Обрабатываем 3 корзин с популярными товарами
[2025-08-27 12:09:12] Уникальных популярных товаров: 207
[2025-08-27 12:09:12] Создаем sparse матрицу из 6 взаимодействий...
[2025-08-27 12:09:12] Sparse матрица построена: torch.Size([207, 207]), ненулевых элементов: 3
[2025-08-27 12:09:12] Формируем рекомендации...
[2025-08-27 12:09:12] Co-purchase словарь построен для 3 товаров
[2025-08-27 12:09:12] В среднем 1.0 рекомендаций на товар
[2025-08-27 12:09:12] Co-purchase словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/copurchase_map.pkl
[2025-08-27 12:09:12] Co-purchase map построен: 3 товаров
[2025-08-27 12:09:12] Построение категорийных маппингов...
[2025-08-27 12:09:12] Сохранено: item_to_cat.pkl и extended_cat_to_items.pkl в /home/root6/python/e_cup/rec_system/data/processed/
[2025-08-27 12:09:12] Категорийные маппинги построены: 990 товаров, 223 категорий
[2025-08-27 12:09:12] Построение дополнительных данных завершено за 0:00:00.271641
[2025-08-27 12:09:12] === ПРЕДВАРИТЕЛЬНЫЙ РАСЧЕТ ПРИЗНАКОВ ДЛЯ LGBM ===
[2025-08-27 12:09:12] Построение словаря пользовательских признаков...
[2025-08-27 12:09:12] Агрегация по заказам...
[2025-08-27 12:09:13] Словарь пользовательских признаков построен и сохранён в /home/root6/python/e_cup/rec_system/data/processed/user_features_dict.pkl. Записей: 1196
[2025-08-27 12:09:13] User features построены за 0:00:01.510825: 1196 пользователей
[2025-08-27 12:09:13] Построение словаря товарных признаков...
[2025-08-27 12:09:14] Добавление данных из items_df...
[2025-08-27 12:09:14] Добавление эмбеддингов...
[2025-08-27 12:09:14] Словарь товарных признаков построен. Записей: 208
[2025-08-27 12:09:14] Словарь сохранён в /home/root6/python/e_cup/rec_system/data/processed/item_features_dict.pkl
[2025-08-27 12:09:14] Item features построены за 0:00:00.281253: 208 товаров
[2025-08-27 12:09:14] Создание UI-признаков (данные остаются на диске)
[2025-08-27 12:09:14] Создано 2 файлов UI-признаков в: /home/root6/python/e_cup/rec_system/data/processed/ui_features_distributed
[2025-08-27 12:09:14] User-Item features созданы в: /home/root6/python/e_cup/rec_system/data/processed/ui_features_distributed
[2025-08-27 12:09:14] Количество файлов: 2
[2025-08-27 12:09:14] User-Item features построены за 0:00:00.014286
[2025-08-27 12:09:14] Предварительный расчет признаков завершен за 0:00:01.806520
[2025-08-27 12:09:14] === ПОДГОТОВКА ДАННЫХ ДЛЯ LightGBM ===
[2025-08-27 12:09:14] Подготовка данных для LightGBM (streaming)...

=== ОБЩЕЕ ВРЕМЯ ВЫПОЛНЕНИЯ: 0:00:07.539139 ===
