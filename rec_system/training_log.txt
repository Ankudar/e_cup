=== НАЧАЛО ОБУЧЕНИЯ 2025-08-28 12:52:14 ===

[2025-08-28 12:52:14] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-08-28 12:52:14] Пользователей: все
[2025-08-28 12:52:14] Данных: 100.0%
[2025-08-28 12:52:14] === ЗАГРУЗКА ДАННЫХ ===
[2025-08-28 12:52:14] Загружаем данные...
[2025-08-28 12:52:14] orders: 18,887,122 строк (использовано 5 из 5 партиций), ~828.1 MB
[2025-08-28 12:52:15] tracker: 100,000,000 строк (использовано 200 из 200 партиций), ~270.0 MB
[2025-08-28 12:52:22] items: 6,439,422 строк (использовано 200 из 200 партиций), ~1134.2 MB
[2025-08-28 12:52:22] categories: 7,012 строк (использовано 1 из 1 партиций), ~1.7 MB
[2025-08-28 12:52:22] test_users: 470,347 строк (использовано 1 из 1 партиций), ~1.8 MB
[2025-08-28 12:52:22] Данные загружены
[2025-08-28 12:52:22] Фильтрация данных...
[2025-08-28 12:52:22] Фильтрация завершена
[2025-08-28 12:52:22] Загрузка данных завершена за 0:00:07.884748
[2025-08-28 12:52:22] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-08-28 12:52:22] Оптимизированная потоковая загрузка эмбеддингов...
[2025-08-28 12:52:42] Загружено эмбеддингов для 6342024 товаров
[2025-08-28 12:53:23] Пример ключей в embeddings_dict: [400301, 678602, 746401, 872829, 893255]
[2025-08-28 12:53:23] Пример значения: [ 0.32023853  0.11766258 -0.784552    0.4168199  -0.24610527]
[2025-08-28 12:53:23] Загрузка эмбеддингов завершена за 0:01:01.032743
[2025-08-28 12:53:23] Загружено эмбеддингов: 6342024
[2025-08-28 12:53:23] === SPLIT ДАННЫХ ===
[2025-08-28 12:53:31] Split данных завершен за 0:00:08.070707
[2025-08-28 12:53:31] Train orders: 14341462, Test orders: 3585364
[2025-08-28 12:53:31] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-08-28 12:53:31] Формируем матрицу взаимодействий по батчам...
[2025-08-28 12:53:31] ... для orders
[2025-08-28 12:53:35] Сохранен orders-батч 0-14341462
[2025-08-28 12:53:35] ... для tracker
[2025-08-28 12:53:37] Сохранен tracker-партиция 0
[2025-08-28 12:53:37] Все батчи сохранены на диск.
[2025-08-28 12:53:37] Подготовка взаимодействий завершена за 0:00:06.074836
[2025-08-28 12:53:37] Создано файлов взаимодействий: 2
[2025-08-28 12:53:37] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-08-28 12:53:39] Словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/recent_items_map.pkl
[2025-08-28 12:53:39] Построение recent items map завершено за 0:00:02.379534
[2025-08-28 12:53:39] Пользователей с recent items: 872198
[2025-08-28 12:53:39] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-08-28 12:53:39] Первый проход: построение маппингов...
[2025-08-28 12:53:41] Маппинги построены. Уников: users=872198, items=3938327
[2025-08-28 12:53:41] item_map сохранен: /home/root6/python/e_cup/rec_system/data/processed/item_map.pkl
[2025-08-28 12:53:41] Сохранение батчей на диск...
[2025-08-28 12:53:41] Постепенное обучение...
[2025-08-28 12:53:54] Очистка временных файлов...
[2025-08-28 12:53:54] Директория батчей удалена
[2025-08-28 12:53:54] Обучение завершено!
[2025-08-28 12:53:55] Считаем глобальную популярность на основе тренировочных данных...
[2025-08-28 12:53:56] Глобальная популярность рассчитана на 14341460 тренировочных заказах
[2025-08-28 12:53:56] Обучение ALS завершено за 0:00:16.413355
[2025-08-28 12:53:56] Пользователей: 872198, Товаров: 3938327
[2025-08-28 12:53:56] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-08-28 12:53:56] Строим co-purchase матрицу для топ-N товаров...
[2025-08-28 12:53:56] Топ-500 популярных товаров определены
[2025-08-28 12:55:32] Обрабатываем 18158 корзин с популярными товарами
[2025-08-28 12:55:32] Уникальных популярных товаров: 500
[2025-08-28 12:55:32] Создаем sparse матрицу из 191808 взаимодействий...
[2025-08-28 12:55:32] Sparse матрица построена: torch.Size([500, 500]), ненулевых элементов: 9247
[2025-08-28 12:55:32] Формируем рекомендации...
[2025-08-28 12:55:33] Co-purchase словарь построен для 500 товаров
[2025-08-28 12:55:33] В среднем 8.8 рекомендаций на товар
[2025-08-28 12:55:33] Co-purchase map построен: 500 товаров
[2025-08-28 12:55:39] Построение категорийных маппингов...
[2025-08-28 12:55:41] Категорийные маппинги построены: 6342024 товаров, 478 категорий
[2025-08-28 12:55:41] Построение дополнительных данных завершено за 0:01:45.718877
[2025-08-28 12:55:41] === ПРЕДВАРИТЕЛЬНЫЙ РАСЧЕТ ПРИЗНАКОВ ДЛЯ LGBM ===
[2025-08-28 12:55:41] Построение словаря пользовательских признаков...
[2025-08-28 12:55:42] Агрегация по заказам...
[2025-08-28 12:55:46] Словарь пользовательских признаков построен и сохранён в /home/root6/python/e_cup/rec_system/data/processed/cat_to_items.pkl. Записей: 872199
[2025-08-28 12:55:46] User features построены за 0:00:04.819513: 872199 пользователей
[2025-08-28 12:55:46] Построение словаря товарных признаков...
[2025-08-28 12:55:52] Добавление данных из items_df...
[2025-08-28 12:56:22] Добавление эмбеддингов...
[2025-08-28 12:56:34] Словарь товарных признаков построен. Записей: 3938328
[2025-08-28 12:56:40] Item features: 3938328 товаров, размер вектора: 12 признаков
[2025-08-28 12:56:40] Порядок признаков: ['item_count', 'item_mean', 'item_sum', 'item_max', 'item_min', 'item_orders_count', 'item_category', 'fclip_embed_0', 'fclip_embed_1', 'fclip_embed_2']...
[2025-08-28 12:56:40] item_features_dict[8050678] type=<class 'numpy.ndarray'>, shape=(12,), example=[1.       7.135582 7.135582 7.135582 7.135582]
[2025-08-28 12:56:40] item_features_dict[299411973] type=<class 'numpy.ndarray'>, shape=(12,), example=[1.       7.593918 7.593918 7.593918 7.593918]
[2025-08-28 12:56:40] item_features_dict[13448019] type=<class 'numpy.ndarray'>, shape=(12,), example=[ 5.          3.3094256  16.547129    8.080412    0.16394912]
[2025-08-28 12:56:40] item_features_dict[None] type=<class 'numpy.ndarray'>, shape=(12,), example=[0. 0. 0. 0. 0.]
[2025-08-28 12:56:40] item_features_dict[93013532] type=<class 'numpy.ndarray'>, shape=(12,), example=[1.        1.8000137 1.8000137 1.8000137 1.8000137]
[2025-08-28 12:56:50] Item features построены за 0:01:03.281673
[2025-08-28 12:56:50] === ПОДГОТОВКА ДАННЫХ ДЛЯ LightGBM ===
[2025-08-28 12:56:50] Подготовка данных для LightGBM (streaming, polars lazy, векторно)...
[2025-08-28 12:57:06] Negatives к positive: 0
[2025-08-28 12:57:16] ✅ Данные подготовлены (streaming lazy polars, векторно)
[2025-08-28 12:57:17] Размер train: 17092384, validation: 4257573
[2025-08-28 12:57:17] Признаки: 19
[2025-08-28 12:57:17] Подготовка данных для LightGBM завершена за 0:00:26.935736
[2025-08-28 12:57:17] === ДЕТАЛЬНАЯ ПРОВЕРКА FEATURE GENERATION ===
[2025-08-28 12:57:17] --- ПРОВЕРКА USER FEATURES ---
[2025-08-28 12:57:17] Пример user features для пользователя 4573511:
[2025-08-28 12:57:17]   user_count: 1
[2025-08-28 12:57:17]   user_mean: 2.821973947420524
[2025-08-28 12:57:17]   user_sum: 2.821973947420524
[2025-08-28 12:57:17]   user_max: 2.821973947420524
[2025-08-28 12:57:17]   user_min: 2.821973947420524
[2025-08-28 12:57:17]   user_orders_count: 0
[2025-08-28 12:57:17] Пользователей с features: 872199
[2025-08-28 12:57:17] Пользователей с НЕнулевыми features: 872199
[2025-08-28 12:57:17] --- ПРОВЕРКА ITEM FEATURES ---
[2025-08-28 12:57:17] Пример item features для товара 8050678:
[2025-08-28 12:57:17]   emb_0: 1.0
[2025-08-28 12:57:17]   emb_1: 7.135581970214844
[2025-08-28 12:57:17]   emb_2: 7.135581970214844
[2025-08-28 12:57:17]   emb_3: 7.135581970214844
[2025-08-28 12:57:17]   emb_4: 7.135581970214844
[2025-08-28 12:57:17]   emb_5: 1.0
[2025-08-28 12:57:17]   emb_6: 7512.0
[2025-08-28 12:57:17]   emb_7: 0.27680501341819763
[2025-08-28 12:57:17]   emb_8: -1.1508772373199463
[2025-08-28 12:57:17]   emb_9: -0.19046422839164734
[2025-08-28 12:57:17]   emb_10: 0.23561039566993713
[2025-08-28 12:57:17]   emb_11: 0.12351789325475693
[2025-08-28 12:57:24] Товаров с features: 3938328
[2025-08-28 12:57:24] Товаров с НЕнулевыми features: 3938328
[2025-08-28 12:57:24] --- ПРОВЕРКА ЭМБЕДДИНГОВ ---
[2025-08-28 12:57:24] Пример эмбеддинга для товара 400301: shape (512,)
[2025-08-28 12:57:24] Эмбеддингов загружено: 6342024
[2025-08-28 12:57:24] Пример значений: [ 0.32023853  0.11766258 -0.784552    0.4168199  -0.24610527]
[2025-08-28 12:57:24] --- ПРОВЕРКА CO-PURCHASE MAP ---
[2025-08-28 12:57:24] Пример co-purchase для товара 51974017: 10 товаров
[2025-08-28 12:57:24] Co-purchase записей: 500
[2025-08-28 12:57:24] --- ПРОВЕРКА КАТЕГОРИЙНЫХ МАППИНГОВ ---
[2025-08-28 12:57:24] Товар 400301 -> категория 17080
[2025-08-28 12:57:24] Категория 17080 -> 16555 товаров
[2025-08-28 12:57:24] Товаров в маппинге: 6342024
[2025-08-28 12:57:24] Категорий в маппинге: 478
[2025-08-28 12:57:24] Проверка признаков завершена за 0:00:07.539743
[2025-08-28 12:57:24] === ОБУЧЕНИЕ LightGBM ===
[2025-08-28 12:57:27] === ДЕБАГ ИНФОРМАЦИЯ: TRAIN ===
[2025-08-28 12:57:27] Размер: 17092384 строк
[2025-08-28 12:57:27] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'user_count_right', 'user_mean_right', 'user_sum_right', 'user_max_right', 'user_min_right', 'user_orders_count_right', 'emb_0_right', 'emb_1_right', 'emb_2_right', 'emb_3_right', 'emb_4_right', 'emb_5_right', 'emb_6_right', 'emb_7_right', 'emb_8_right', 'emb_9_right', 'emb_10_right', 'emb_11_right', 'copurchase_count']
[2025-08-28 12:57:27] ✅ Все признаки присутствуют
[2025-08-28 12:57:27] Целевая переменная: {1: np.int64(9352544), 0: np.int64(7739840)}
[2025-08-28 12:57:27] Пример первой строки:
[2025-08-28 12:57:27]   item_id: 94759031
[2025-08-28 12:57:27]   user_id: 11810
[2025-08-28 12:57:27]   created_timestamp: 2025-01-14 20:14:24.813000
[2025-08-28 12:57:27]   last_status: canceled_orders
[2025-08-28 12:57:27]   target: 0
[2025-08-28 12:57:27]   weight: 8.431994767851144
[2025-08-28 12:57:27]   user_count: 38.0
[2025-08-28 12:57:27]   user_mean: 4.248439460003616
[2025-08-28 12:57:27]   user_sum: 161.4406994801374
[2025-08-28 12:57:27]   user_max: 8.64350666630459
[2025-08-28 12:57:27]   user_min: 0.06557964564598175
[2025-08-28 12:57:27]   user_orders_count: 39.0
[2025-08-28 12:57:27]   emb_0: 53.0
[2025-08-28 12:57:27]   emb_1: 5.979867458343506
[2025-08-28 12:57:27]   emb_2: 316.9329833984375
[2025-08-28 12:57:27]   emb_3: 8.702330589294434
[2025-08-28 12:57:27]   emb_4: 0.4765509068965912
[2025-08-28 12:57:27]   emb_5: 66.0
[2025-08-28 12:57:27]   emb_6: 7559.0
[2025-08-28 12:57:27]   emb_7: 0.0038151144981384277
[2025-08-28 12:57:27]   emb_8: -0.8347775936126709
[2025-08-28 12:57:27]   emb_9: -0.3548562228679657
[2025-08-28 12:57:27]   emb_10: 0.3515736758708954
[2025-08-28 12:57:27]   emb_11: 0.34977754950523376
[2025-08-28 12:57:27]   user_count_right: 38.0
[2025-08-28 12:57:27]   user_mean_right: 4.248439460003616
[2025-08-28 12:57:27]   user_sum_right: 161.4406994801374
[2025-08-28 12:57:27]   user_max_right: 8.64350666630459
[2025-08-28 12:57:27]   user_min_right: 0.06557964564598175
[2025-08-28 12:57:27]   user_orders_count_right: 39.0
[2025-08-28 12:57:27]   emb_0_right: 53.0
[2025-08-28 12:57:27]   emb_1_right: 5.979867458343506
[2025-08-28 12:57:27]   emb_2_right: 316.9329833984375
[2025-08-28 12:57:27]   emb_3_right: 8.702330589294434
[2025-08-28 12:57:27]   emb_4_right: 0.4765509068965912
[2025-08-28 12:57:27]   emb_5_right: 66.0
[2025-08-28 12:57:27]   emb_6_right: 7559.0
[2025-08-28 12:57:27]   emb_7_right: 0.0038151144981384277
[2025-08-28 12:57:27]   emb_8_right: -0.8347775936126709
[2025-08-28 12:57:27]   emb_9_right: -0.3548562228679657
[2025-08-28 12:57:27]   emb_10_right: 0.3515736758708954
[2025-08-28 12:57:27]   emb_11_right: 0.34977754950523376
[2025-08-28 12:57:27]   copurchase_count: 0.0
[2025-08-28 12:57:27] === ДЕБАГ ИНФОРМАЦИЯ: VAL ===
[2025-08-28 12:57:27] Размер: 4257573 строк
[2025-08-28 12:57:27] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'user_count_right', 'user_mean_right', 'user_sum_right', 'user_max_right', 'user_min_right', 'user_orders_count_right', 'emb_0_right', 'emb_1_right', 'emb_2_right', 'emb_3_right', 'emb_4_right', 'emb_5_right', 'emb_6_right', 'emb_7_right', 'emb_8_right', 'emb_9_right', 'emb_10_right', 'emb_11_right', 'copurchase_count']
[2025-08-28 12:57:27] ✅ Все признаки присутствуют
[2025-08-28 12:57:27] Целевая переменная: {1: np.int64(2277657), 0: np.int64(1979916)}
[2025-08-28 12:57:27] Пример первой строки:
[2025-08-28 12:57:27]   item_id: 134663480
[2025-08-28 12:57:27]   user_id: 1569251
[2025-08-28 12:57:27]   created_timestamp: 2025-05-14 12:28:07.920000
[2025-08-28 12:57:27]   last_status: delivered_orders
[2025-08-28 12:57:27]   target: 1
[2025-08-28 12:57:27]   weight: 1.6823611831060648
[2025-08-28 12:57:27]   user_count: 41
[2025-08-28 12:57:27]   user_mean: 3.9597258077679296
[2025-08-28 12:57:27]   user_sum: 162.3487581184851
[2025-08-28 12:57:27]   user_max: 8.583982153772999
[2025-08-28 12:57:27]   user_min: 0.47655089902162434
[2025-08-28 12:57:27]   user_orders_count: 34
[2025-08-28 12:57:27]   emb_0: 11.0
[2025-08-28 12:57:27]   emb_1: 1.7681821584701538
[2025-08-28 12:57:27]   emb_2: 19.450002670288086
[2025-08-28 12:57:27]   emb_3: 5.148097038269043
[2025-08-28 12:57:27]   emb_4: 0.163949117064476
[2025-08-28 12:57:27]   emb_5: 11.0
[2025-08-28 12:57:27]   emb_6: 36484.0
[2025-08-28 12:57:27]   emb_7: -0.054585907608270645
[2025-08-28 12:57:27]   emb_8: 0.18316370248794556
[2025-08-28 12:57:27]   emb_9: -0.6606302261352539
[2025-08-28 12:57:27]   emb_10: 0.07622577250003815
[2025-08-28 12:57:27]   emb_11: -0.02429545670747757
[2025-08-28 12:57:27]   user_count_right: 41
[2025-08-28 12:57:27]   user_mean_right: 3.9597258077679296
[2025-08-28 12:57:27]   user_sum_right: 162.3487581184851
[2025-08-28 12:57:27]   user_max_right: 8.583982153772999
[2025-08-28 12:57:27]   user_min_right: 0.47655089902162434
[2025-08-28 12:57:27]   user_orders_count_right: 34
[2025-08-28 12:57:27]   emb_0_right: 11.0
[2025-08-28 12:57:27]   emb_1_right: 1.7681821584701538
[2025-08-28 12:57:27]   emb_2_right: 19.450002670288086
[2025-08-28 12:57:27]   emb_3_right: 5.148097038269043
[2025-08-28 12:57:27]   emb_4_right: 0.163949117064476
[2025-08-28 12:57:27]   emb_5_right: 11.0
[2025-08-28 12:57:27]   emb_6_right: 36484.0
[2025-08-28 12:57:27]   emb_7_right: -0.054585907608270645
[2025-08-28 12:57:27]   emb_8_right: 0.18316370248794556
[2025-08-28 12:57:27]   emb_9_right: -0.6606302261352539
[2025-08-28 12:57:27]   emb_10_right: 0.07622577250003815
[2025-08-28 12:57:27]   emb_11_right: -0.02429545670747757
[2025-08-28 12:57:27]   copurchase_count: 0.0
[2025-08-28 12:57:27] Feature columns: ['copurchase_count', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11']
[2025-08-28 12:57:27] Размер train: 17092384
[2025-08-28 12:57:27] Используемые признаки: ['copurchase_count', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11']
[2025-08-28 12:57:27] Пример данных: {'copurchase_count': 0.0, 'user_count': 38.0, 'user_mean': 4.248439460003616, 'user_sum': 161.4406994801374, 'user_max': 8.64350666630459, 'user_min': 0.06557964564598175, 'user_orders_count': 39.0, 'emb_0': 53.0, 'emb_1': 5.979867458343506, 'emb_2': 316.9329833984375, 'emb_3': 8.702330589294434, 'emb_4': 0.4765509068965912, 'emb_5': 66.0, 'emb_6': 7559.0, 'emb_7': 0.0038151144981384277, 'emb_8': -0.8347775936126709, 'emb_9': -0.3548562228679657, 'emb_10': 0.3515736758708954, 'emb_11': 0.34977754950523376}
[2025-08-28 12:57:27] Категориальные признаки: ['user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count']
[2025-08-28 12:57:27] Размер val: 4257573
[2025-08-28 12:57:30] [Iter 0] train_binary_logloss:0.6867, valid_binary_logloss:0.6895
[2025-08-28 12:57:51] [Iter 50] train_binary_logloss:0.6136, valid_binary_logloss:0.6249
[2025-08-28 12:58:12] [Iter 100] train_binary_logloss:0.5892, valid_binary_logloss:0.6027
[2025-08-28 12:58:30] [Iter 150] train_binary_logloss:0.5786, valid_binary_logloss:0.5923
[2025-08-28 12:58:49] [Iter 200] train_binary_logloss:0.5726, valid_binary_logloss:0.5865
[2025-08-28 12:59:05] [Iter 250] train_binary_logloss:0.5688, valid_binary_logloss:0.5826
[2025-08-28 12:59:23] [Iter 300] train_binary_logloss:0.5659, valid_binary_logloss:0.5801
[2025-08-28 12:59:38] [Iter 350] train_binary_logloss:0.5637, valid_binary_logloss:0.5784
[2025-08-28 12:59:55] [Iter 400] train_binary_logloss:0.5618, valid_binary_logloss:0.5768
[2025-08-28 13:00:10] [Iter 450] train_binary_logloss:0.5602, valid_binary_logloss:0.5756
[2025-08-28 13:00:24] [Iter 500] train_binary_logloss:0.5588, valid_binary_logloss:0.5745
[2025-08-28 13:00:40] [Iter 550] train_binary_logloss:0.5573, valid_binary_logloss:0.5734
[2025-08-28 13:00:54] [Iter 600] train_binary_logloss:0.5561, valid_binary_logloss:0.5725
[2025-08-28 13:01:10] [Iter 650] train_binary_logloss:0.5549, valid_binary_logloss:0.5716
[2025-08-28 13:01:23] [Iter 700] train_binary_logloss:0.5539, valid_binary_logloss:0.5709
[2025-08-28 13:01:40] [Iter 750] train_binary_logloss:0.5529, valid_binary_logloss:0.5703
[2025-08-28 13:01:53] [Iter 800] train_binary_logloss:0.5520, valid_binary_logloss:0.5696
[2025-08-28 13:02:09] [Iter 850] train_binary_logloss:0.5511, valid_binary_logloss:0.5688
[2025-08-28 13:02:22] [Iter 900] train_binary_logloss:0.5503, valid_binary_logloss:0.5683
[2025-08-28 13:02:35] [Iter 950] train_binary_logloss:0.5495, valid_binary_logloss:0.5678
[2025-08-28 13:02:50] [Iter 1000] train_binary_logloss:0.5488, valid_binary_logloss:0.5674
[2025-08-28 13:03:02] [Iter 1050] train_binary_logloss:0.5481, valid_binary_logloss:0.5668
[2025-08-28 13:03:18] [Iter 1100] train_binary_logloss:0.5473, valid_binary_logloss:0.5663
[2025-08-28 13:03:31] [Iter 1150] train_binary_logloss:0.5467, valid_binary_logloss:0.5658
[2025-08-28 13:03:44] [Iter 1200] train_binary_logloss:0.5461, valid_binary_logloss:0.5654
[2025-08-28 13:03:59] [Iter 1250] train_binary_logloss:0.5457, valid_binary_logloss:0.5650
[2025-08-28 13:04:12] [Iter 1300] train_binary_logloss:0.5451, valid_binary_logloss:0.5647
[2025-08-28 13:04:26] [Iter 1350] train_binary_logloss:0.5446, valid_binary_logloss:0.5644
[2025-08-28 13:04:39] [Iter 1400] train_binary_logloss:0.5441, valid_binary_logloss:0.5641
[2025-08-28 13:04:52] [Iter 1450] train_binary_logloss:0.5437, valid_binary_logloss:0.5638
[2025-08-28 13:05:06] [Iter 1500] train_binary_logloss:0.5433, valid_binary_logloss:0.5635
[2025-08-28 13:05:20] [Iter 1550] train_binary_logloss:0.5428, valid_binary_logloss:0.5632
[2025-08-28 13:05:35] [Iter 1600] train_binary_logloss:0.5425, valid_binary_logloss:0.5631
[2025-08-28 13:05:47] [Iter 1650] train_binary_logloss:0.5421, valid_binary_logloss:0.5628
[2025-08-28 13:05:59] [Iter 1700] train_binary_logloss:0.5417, valid_binary_logloss:0.5626
[2025-08-28 13:06:15] [Iter 1750] train_binary_logloss:0.5414, valid_binary_logloss:0.5623
[2025-08-28 13:06:27] [Iter 1800] train_binary_logloss:0.5411, valid_binary_logloss:0.5622
[2025-08-28 13:06:40] [Iter 1850] train_binary_logloss:0.5408, valid_binary_logloss:0.5620
[2025-08-28 13:06:54] [Iter 1900] train_binary_logloss:0.5405, valid_binary_logloss:0.5618
[2025-08-28 13:07:07] [Iter 1950] train_binary_logloss:0.5402, valid_binary_logloss:0.5617
[2025-08-28 13:07:22] [Iter 2000] train_binary_logloss:0.5398, valid_binary_logloss:0.5614
[2025-08-28 13:07:34] [Iter 2050] train_binary_logloss:0.5395, valid_binary_logloss:0.5613
[2025-08-28 13:07:47] [Iter 2100] train_binary_logloss:0.5393, valid_binary_logloss:0.5611
[2025-08-28 13:08:01] [Iter 2150] train_binary_logloss:0.5391, valid_binary_logloss:0.5610
[2025-08-28 13:08:14] [Iter 2200] train_binary_logloss:0.5388, valid_binary_logloss:0.5609
[2025-08-28 13:08:29] [Iter 2250] train_binary_logloss:0.5386, valid_binary_logloss:0.5607
[2025-08-28 13:08:42] [Iter 2300] train_binary_logloss:0.5384, valid_binary_logloss:0.5605
[2025-08-28 13:08:54] [Iter 2350] train_binary_logloss:0.5382, valid_binary_logloss:0.5605
[2025-08-28 13:09:08] [Iter 2400] train_binary_logloss:0.5379, valid_binary_logloss:0.5604
[2025-08-28 13:09:20] [Iter 2450] train_binary_logloss:0.5377, valid_binary_logloss:0.5603
[2025-08-28 13:09:32] [Iter 2500] train_binary_logloss:0.5376, valid_binary_logloss:0.5602
[2025-08-28 13:09:45] [Iter 2550] train_binary_logloss:0.5374, valid_binary_logloss:0.5600
[2025-08-28 13:09:57] [Iter 2600] train_binary_logloss:0.5372, valid_binary_logloss:0.5599
[2025-08-28 13:10:10] [Iter 2650] train_binary_logloss:0.5370, valid_binary_logloss:0.5598
[2025-08-28 13:10:23] [Iter 2700] train_binary_logloss:0.5368, valid_binary_logloss:0.5597
[2025-08-28 13:10:36] [Iter 2750] train_binary_logloss:0.5367, valid_binary_logloss:0.5596
[2025-08-28 13:10:48] [Iter 2800] train_binary_logloss:0.5365, valid_binary_logloss:0.5596
[2025-08-28 13:11:02] [Iter 2850] train_binary_logloss:0.5363, valid_binary_logloss:0.5595
[2025-08-28 13:11:13] [Iter 2900] train_binary_logloss:0.5362, valid_binary_logloss:0.5593
[2025-08-28 13:11:25] [Iter 2950] train_binary_logloss:0.5360, valid_binary_logloss:0.5592
[2025-08-28 13:11:38] [Iter 3000] train_binary_logloss:0.5359, valid_binary_logloss:0.5592
[2025-08-28 13:11:49] [Iter 3050] train_binary_logloss:0.5357, valid_binary_logloss:0.5590
[2025-08-28 13:12:00] [Iter 3100] train_binary_logloss:0.5356, valid_binary_logloss:0.5590
[2025-08-28 13:12:14] [Iter 3150] train_binary_logloss:0.5354, valid_binary_logloss:0.5590
[2025-08-28 13:12:26] [Iter 3200] train_binary_logloss:0.5353, valid_binary_logloss:0.5589
[2025-08-28 13:12:37] [Iter 3250] train_binary_logloss:0.5352, valid_binary_logloss:0.5588
[2025-08-28 13:12:51] [Iter 3300] train_binary_logloss:0.5350, valid_binary_logloss:0.5588
[2025-08-28 13:13:02] [Iter 3350] train_binary_logloss:0.5349, valid_binary_logloss:0.5587
[2025-08-28 13:13:13] [Iter 3400] train_binary_logloss:0.5348, valid_binary_logloss:0.5586
[2025-08-28 13:13:25] [Iter 3450] train_binary_logloss:0.5346, valid_binary_logloss:0.5586
[2025-08-28 13:13:36] [Iter 3500] train_binary_logloss:0.5345, valid_binary_logloss:0.5585
[2025-08-28 13:13:47] [Iter 3550] train_binary_logloss:0.5344, valid_binary_logloss:0.5584
[2025-08-28 13:14:00] [Iter 3600] train_binary_logloss:0.5342, valid_binary_logloss:0.5584
[2025-08-28 13:14:13] [Iter 3650] train_binary_logloss:0.5341, valid_binary_logloss:0.5583
[2025-08-28 13:14:27] [Iter 3700] train_binary_logloss:0.5340, valid_binary_logloss:0.5582
[2025-08-28 13:14:39] [Iter 3750] train_binary_logloss:0.5339, valid_binary_logloss:0.5582
[2025-08-28 13:14:50] [Iter 3800] train_binary_logloss:0.5337, valid_binary_logloss:0.5581
[2025-08-28 13:15:03] [Iter 3850] train_binary_logloss:0.5336, valid_binary_logloss:0.5580
[2025-08-28 13:15:14] [Iter 3900] train_binary_logloss:0.5335, valid_binary_logloss:0.5579
[2025-08-28 13:15:25] [Iter 3950] train_binary_logloss:0.5334, valid_binary_logloss:0.5578
[2025-08-28 13:15:38] [Iter 4000] train_binary_logloss:0.5333, valid_binary_logloss:0.5578
[2025-08-28 13:19:14] NDCG@100 на валидации: 0.7663
[2025-08-28 13:19:14] Обучение LightGBM завершено за 0:21:49.517763
[2025-08-28 13:19:14] === ВАЖНОСТЬ ПРИЗНАКОВ ===
[2025-08-28 13:19:14] Топ-20 важных признаков:
[2025-08-28 13:19:14]   user_sum: 48750
[2025-08-28 13:19:14]   user_count: 46195
[2025-08-28 13:19:14]   user_orders_count: 45211
[2025-08-28 13:19:14]   emb_6: 18136
[2025-08-28 13:19:14]   emb_3: 9735
[2025-08-28 13:19:14]   emb_0: 8371
[2025-08-28 13:19:14]   emb_8: 8009
[2025-08-28 13:19:14]   emb_9: 7239
[2025-08-28 13:19:14]   emb_2: 7166
[2025-08-28 13:19:14]   emb_5: 6590
[2025-08-28 13:19:14]   emb_10: 6429
[2025-08-28 13:19:14]   user_max: 5836
[2025-08-28 13:19:14]   emb_7: 5800
[2025-08-28 13:19:14]   emb_1: 5797
[2025-08-28 13:19:14]   emb_4: 5374
[2025-08-28 13:19:14]   emb_11: 5306
[2025-08-28 13:19:14]   user_mean: 2631
[2025-08-28 13:19:14]   user_min: 1851
[2025-08-28 13:19:14]   copurchase_count: 660
[2025-08-28 13:19:14] Анализ важности признаков завершен за 0:00:00.005169
[2025-08-28 13:19:14] === СОХРАНЕНИЕ МОДЕЛИ И ПРИЗНАКОВ ===
[2025-08-28 13:19:29] Сохранение модели завершено за 0:00:15.606752
[2025-08-28 13:19:29] Модель сохранена в: /home/root6/python/e_cup/rec_system/src/models/lgbm_model_full.pkl
[2025-08-28 13:19:29] === ОБУЧЕНИЕ И ПРЕДСКАЗАНИЯ ЗАВЕРШЕНЫ УСПЕШНО ===
[2025-08-28 13:19:29] Общее время выполнения: 0:27:15.282809
[2025-08-28 13:19:29] Пользователей: 872198
[2025-08-28 13:19:29] Товаров: 3938327
[2025-08-28 13:19:29] Признаков: 19
[2025-08-28 13:19:29] === СИСТЕМНАЯ ИНФОРМАЦИЯ ===
[2025-08-28 13:19:29] Видеокарта: NVIDIA GeForce RTX 4090
[2025-08-28 13:19:29] Память GPU: 24.0 GB
[2025-08-28 13:19:29] Процессор: 35.8% загрузки
[2025-08-28 13:19:29] Ядра CPU: 32
[2025-08-28 13:19:29] Частота CPU: 2995.2 MHz
[2025-08-28 13:19:29] Оперативная память: 94.2 GB всего, 89.0 GB использовано
[2025-08-28 13:19:29] Частота RAM: информация требует дополнительных библиотек
[2025-08-28 13:19:29] ==========================================
[2025-08-28 13:19:29] ВСЕ ЭТАПЫ ВЫПОЛНЕНЫ УСПЕШНО!
[2025-08-28 13:19:29] ==========================================

=== ОБЩЕЕ ВРЕМЯ ВЫПОЛНЕНИЯ: 0:27:15.305105 ===
