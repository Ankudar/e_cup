=== НАЧАЛО ОБУЧЕНИЯ 2025-08-27 19:06:45 ===

[2025-08-27 19:06:45] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-08-27 19:06:45] Пользователей: все
[2025-08-27 19:06:45] Данных: 100.0%
[2025-08-27 19:06:45] === ЗАГРУЗКА ДАННЫХ ===
[2025-08-27 19:06:45] Загружаем данные...
[2025-08-27 19:06:45] orders: 1,000 строк (использовано 5 из 5 партиций), ~0.0 MB
[2025-08-27 19:06:46] tracker: 1,000 строк (использовано 200 из 200 партиций), ~0.0 MB
[2025-08-27 19:06:47] items: 1,000 строк (использовано 200 из 200 партиций), ~0.2 MB
[2025-08-27 19:06:47] categories: 1,000 строк (использовано 1 из 1 партиций), ~0.2 MB
[2025-08-27 19:06:47] test_users: 1,000 строк (использовано 1 из 1 партиций), ~0.0 MB
[2025-08-27 19:06:47] Данные загружены
[2025-08-27 19:06:47] Фильтрация данных...
[2025-08-27 19:06:47] Фильтрация завершена
[2025-08-27 19:06:47] Загрузка данных завершена за 0:00:02.101550
[2025-08-27 19:06:47] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-08-27 19:06:47] Оптимизированная потоковая загрузка эмбеддингов...
[2025-08-27 19:06:47] Загружено эмбеддингов для 990 товаров
[2025-08-27 19:06:47] Загрузка эмбеддингов завершена за 0:00:00.769018
[2025-08-27 19:06:47] Загружено эмбеддингов: 990
[2025-08-27 19:06:47] === SPLIT ДАННЫХ ===
[2025-08-27 19:06:48] Split данных завершен за 0:00:00.300273
[2025-08-27 19:06:48] Train orders: 753, Test orders: 187
[2025-08-27 19:06:48] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-08-27 19:06:48] Формируем матрицу взаимодействий по батчам...
[2025-08-27 19:06:48] ... для orders
[2025-08-27 19:06:48] Сохранен orders-батч 0-753
[2025-08-27 19:06:48] ... для tracker
[2025-08-27 19:06:49] Сохранен tracker-партиция 0
[2025-08-27 19:06:49] Все батчи сохранены на диск.
[2025-08-27 19:06:49] Подготовка взаимодействий завершена за 0:00:00.885231
[2025-08-27 19:06:49] Создано файлов взаимодействий: 2
[2025-08-27 19:06:49] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-08-27 19:06:49] Словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/recent_items_map.pkl
[2025-08-27 19:06:49] Построение recent items map завершено за 0:00:00.024520
[2025-08-27 19:06:49] Пользователей с recent items: 1195
[2025-08-27 19:06:49] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-08-27 19:06:49] Первый проход: построение маппингов...
[2025-08-27 19:06:49] Маппинги построены. Уников: users=1195, items=207
[2025-08-27 19:06:49] item_map сохранен: /home/root6/python/e_cup/rec_system/data/processed/item_map.pkl
[2025-08-27 19:06:49] Сохранение батчей на диск...
[2025-08-27 19:06:49] Постепенное обучение...
[2025-08-27 19:06:49] Очистка временных файлов...
[2025-08-27 19:06:49] Директория батчей удалена
[2025-08-27 19:06:49] Обучение завершено!
[2025-08-27 19:06:49] Считаем глобальную популярность на основе тренировочных данных...
[2025-08-27 19:06:49] Глобальная популярность рассчитана на 752 тренировочных заказах
[2025-08-27 19:06:49] Обучение ALS завершено за 0:00:00.858334
[2025-08-27 19:06:49] Пользователей: 1195, Товаров: 207
[2025-08-27 19:06:49] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-08-27 19:06:49] Строим co-purchase матрицу для топ-N товаров...
[2025-08-27 19:06:49] Топ-207 популярных товаров определены
[2025-08-27 19:06:49] Обрабатываем 3 корзин с популярными товарами
[2025-08-27 19:06:49] Уникальных популярных товаров: 207
[2025-08-27 19:06:49] Создаем sparse матрицу из 6 взаимодействий...
[2025-08-27 19:06:49] Sparse матрица построена: torch.Size([207, 207]), ненулевых элементов: 3
[2025-08-27 19:06:49] Формируем рекомендации...
[2025-08-27 19:06:50] Co-purchase словарь построен для 3 товаров
[2025-08-27 19:06:50] В среднем 1.0 рекомендаций на товар
[2025-08-27 19:06:50] Co-purchase словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/copurchase_map.pkl
[2025-08-27 19:06:50] Co-purchase map построен: 3 товаров
[2025-08-27 19:06:50] Построение категорийных маппингов...
[2025-08-27 19:06:50] Сохранено: item_to_cat.pkl и extended_cat_to_items.pkl в /home/root6/python/e_cup/rec_system/data/processed/
[2025-08-27 19:06:50] Категорийные маппинги построены: 990 товаров, 223 категорий
[2025-08-27 19:06:50] Построение дополнительных данных завершено за 0:00:00.282381
[2025-08-27 19:06:50] === ПРЕДВАРИТЕЛЬНЫЙ РАСЧЕТ ПРИЗНАКОВ ДЛЯ LGBM ===
[2025-08-27 19:06:50] Построение словаря пользовательских признаков...
[2025-08-27 19:06:50] Агрегация по заказам...
[2025-08-27 19:06:50] Словарь пользовательских признаков построен и сохранён в /home/root6/python/e_cup/rec_system/data/processed/user_features_dict.pkl. Записей: 1196
[2025-08-27 19:06:50] User features построены за 0:00:00.308113: 1196 пользователей
[2025-08-27 19:06:50] Построение словаря товарных признаков...
[2025-08-27 19:06:50] Добавление данных из items_df...
[2025-08-27 19:06:50] Добавление эмбеддингов...
[2025-08-27 19:06:50] Словарь товарных признаков построен. Записей: 208
[2025-08-27 19:06:50] Словарь сохранён в /home/root6/python/e_cup/rec_system/data/processed/item_features_dict.pkl
[2025-08-27 19:06:50] Item features построены за 0:00:00.288947: 208 товаров
[2025-08-27 19:06:50] Предварительный расчет признаков завершен за 0:00:00.597192
[2025-08-27 19:06:50] === ПОДГОТОВКА ДАННЫХ ДЛЯ LightGBM ===
[2025-08-27 19:06:50] Подготовка данных для LightGBM (streaming)...
[2025-08-27 19:06:53] !!! ОШИБКА ВЫПОЛНЕНИЯ !!!
[2025-08-27 19:06:53] Ошибка: No objects to concatenate
[2025-08-27 19:06:53] Время до ошибки: 0:00:08.360344
[2025-08-27 19:06:53] Трассировка ошибки:
[2025-08-27 19:06:53] Traceback (most recent call last):
  File "/home/root6/python/e_cup/rec_system/src/prepare/with_ml.py", line 2099, in <module>
    train_data, val_data = recommender.prepare_training_data(
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root6/python/e_cup/rec_system/src/prepare/with_ml.py", line 1354, in prepare_training_data
    val_data = pd.concat(val_data_batches, ignore_index=True)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root6/python/e_cup/venv/lib/python3.12/site-packages/pandas/core/reshape/concat.py", line 382, in concat
    op = _Concatenator(
         ^^^^^^^^^^^^^^
  File "/home/root6/python/e_cup/venv/lib/python3.12/site-packages/pandas/core/reshape/concat.py", line 445, in __init__
    objs, keys = self._clean_keys_and_objs(objs, keys)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root6/python/e_cup/venv/lib/python3.12/site-packages/pandas/core/reshape/concat.py", line 507, in _clean_keys_and_objs
    raise ValueError("No objects to concatenate")
ValueError: No objects to concatenate


=== ОБЩЕЕ ВРЕМЯ ВЫПОЛНЕНИЯ: 0:00:08.361211 ===
