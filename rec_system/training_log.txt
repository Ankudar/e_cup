=== НАЧАЛО ОБУЧЕНИЯ 2025-09-02 20:14:26 ===

[2025-09-02 20:14:26] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-09-02 20:14:26] Пользователей: все
[2025-09-02 20:14:26] Данных: 100.0%
[2025-09-02 20:14:26] === ЗАГРУЗКА ДАННЫХ ===
[2025-09-02 20:14:26] Загружаем данные...
[2025-09-02 20:14:26] orders: найдено 5 файлов, используем 5
[2025-09-02 20:14:28] orders: ограничено 100,000 из 18,887,122 строк (семплирование 0.5%, использовано 5 файлов), ~4.5 MB
[2025-09-02 20:14:28] tracker: найдено 200 файлов, используем 200
[2025-09-02 20:16:26] tracker: ограничено 100,003 из 1,644,982,482 строк (семплирование 0.0%, использовано 200 файлов), ~4.0 MB
[2025-09-02 20:16:26] items: найдено 100 файлов, используем 100
[2025-09-02 20:16:39] items: ограничено 99,999 из 6,439,422 строк (семплирование 1.6%, использовано 100 файлов), ~17.6 MB
[2025-09-02 20:16:39] categories: найдено 1 файлов, используем 1
[2025-09-02 20:16:39] categories: 7,012 строк (использовано 1 файлов), ~1.7 MB
[2025-09-02 20:16:39] test_users: найдено 1 файлов, используем 1
[2025-09-02 20:16:39] test_users: ограничено 100,000 из 470,347 строк (семплирование 21.3%, использовано 1 файлов), ~1.1 MB
[2025-09-02 20:16:39] Данные загружены
[2025-09-02 20:16:39] Фильтрация данных...
[2025-09-02 20:16:39] Фильтрация завершена
[2025-09-02 20:16:39] Загрузка данных завершена за 0:02:13.111226
[2025-09-02 20:16:39] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-09-02 20:16:39] Оптимизированная потоковая загрузка эмбеддингов... без PCA
[2025-09-02 20:16:45] Загружено эмбеддингов для 99965 товаров
[2025-09-02 20:16:46] Загружено сырых эмбеддингов: 99965
[2025-09-02 20:16:46] Размерность исходных эмбеддингов: 512
[2025-09-02 20:16:46] Анализ дисперсии эмбеддингов...
[2025-09-02 20:16:47] Оптимальное число компонент PCA: 354
[2025-09-02 20:16:47] Объясненная дисперсия: 95.052%
[2025-09-02 20:16:48] График PCA сохранен: /home/root6/python/e_cup/rec_system/pca_variance.png
[2025-09-02 20:16:48] Используем 30 компонент PCA (оптимально: 354, лимит: 30)
[2025-09-02 20:16:54] Обучение PCA на выборке из 99965 эмбеддингов...
[2025-09-02 20:16:58] PCA: сохранено 42.03% дисперсии в 30 компонентах
[2025-09-02 20:16:58] Применение PCA ко всем 99965 эмбеддингам батчами...
[2025-09-02 20:16:58] PCA трансформация завершена
[2025-09-02 20:16:58] Модель PCA сохранена: /home/root6/python/e_cup/rec_system/data/processed/embeddings_pca_pca.pkl
[2025-09-02 20:16:58] Модель Scaler сохранена: /home/root6/python/e_cup/rec_system/data/processed/embeddings_pca_scaler.pkl
[2025-09-02 20:16:58] Пример ключей в embeddings_dict: [313302306, 323611609, 313930510, 20238674, 113158168]
[2025-09-02 20:16:58] Пример значения после PCA: [ 9.4003105  4.4986963  1.5495423  5.7485657 -3.060239 ]
[2025-09-02 20:16:58] Размерность после PCA: 30
[2025-09-02 20:16:58] Загрузка эмбеддингов с PCA завершена за 0:00:18.967467
[2025-09-02 20:16:58] Загружено эмбеддингов: 99965
[2025-09-02 20:16:59] === SPLIT ДАННЫХ ===
[2025-09-02 20:16:59] Split данных завершен за 0:00:00.954143
[2025-09-02 20:16:59] Train orders: 75927, Test orders: 18981
[2025-09-02 20:16:59] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-09-02 20:16:59] Формируем матрицу взаимодействий по батчам...
[2025-09-02 20:16:59] ... обработка orders
[2025-09-02 20:16:59] Сохранен orders-батч 0-75927
[2025-09-02 20:17:00] ... обработка tracker
[2025-09-02 20:17:00] Обрабатываем 10 файлов tracker
[2025-09-02 20:17:01] Обработан tracker файл 0: 5188929 строк
[2025-09-02 20:17:02] Обработан tracker файл 1: 5073468 строк
[2025-09-02 20:17:03] Обработан tracker файл 2: 5029377 строк
[2025-09-02 20:17:05] Обработан tracker файл 3: 4971688 строк
[2025-09-02 20:17:06] Обработан tracker файл 4: 4974471 строк
[2025-09-02 20:17:07] Обработан tracker файл 5: 5203839 строк
[2025-09-02 20:17:09] Обработан tracker файл 6: 5015217 строк
[2025-09-02 20:17:12] Обработан tracker файл 7: 5170396 строк
[2025-09-02 20:17:13] Обработан tracker файл 8: 5105038 строк
[2025-09-02 20:17:15] Обработан tracker файл 9: 5052613 строк
[2025-09-02 20:17:15] ✅ Все файлы успешно созданы
[2025-09-02 20:17:15] Всего файлов взаимодействий: 11
[2025-09-02 20:17:15] Подготовка взаимодействий завершена за 0:00:15.226009
[2025-09-02 20:17:15] Создано файлов взаимодействий: 11
[2025-09-02 20:17:15] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-09-02 20:17:22] Словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/recent_items_map.pkl
[2025-09-02 20:17:22] Построение recent items map завершено за 0:00:07.343264
[2025-09-02 20:17:22] Пользователей с recent items: 942062
[2025-09-02 20:17:22] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-09-02 20:17:22] Первый проход: построение маппингов...
[2025-09-02 20:17:23] Маппинги построены. Уников: users=942062, items=305026
[2025-09-02 20:17:23] item_map сохранен: /home/root6/python/e_cup/rec_system/data/processed/item_map.pkl
[2025-09-02 20:17:23] Сохранение батчей на диск...
[2025-09-02 20:17:24] Обучение als_model...
[2025-09-02 20:17:30] Очистка временных файлов...
[2025-09-02 20:17:30] Директория батчей удалена
[2025-09-02 20:17:30] Обучение завершено!
[2025-09-02 20:17:30] Считаем глобальную популярность на основе тренировочных данных...
[2025-09-02 20:17:30] Глобальная популярность рассчитана на 75926 тренировочных заказах
[2025-09-02 20:17:30] Обучение ALS завершено за 0:00:08.434559
[2025-09-02 20:17:30] Пользователей: 942062, Товаров: 305026
[2025-09-02 20:17:30] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-09-02 20:17:30] Строим co-purchase матрицу для топ-N товаров...
[2025-09-02 20:17:30] Топ-1000 популярных товаров определены
[2025-09-02 20:17:31] Обрабатываем 2 корзин с популярными товарами
[2025-09-02 20:17:31] Уникальных популярных товаров: 1000
[2025-09-02 20:17:31] Создаем sparse матрицу из 4 взаимодействий...
[2025-09-02 20:17:31] Sparse матрица построена: torch.Size([1000, 1000]), ненулевых элементов: 4
[2025-09-02 20:17:31] Формируем рекомендации...
[2025-09-02 20:17:32] Co-purchase словарь построен для 4 товаров
[2025-09-02 20:17:32] В среднем 1.0 рекомендаций на товар
[2025-09-02 20:17:32] Co-purchase map построен: 4 товаров
[2025-09-02 20:17:37] Построение категорийных маппингов...
[2025-09-02 20:17:37] Категорийные маппинги построены: 99965 товаров, 430 категорий
[2025-09-02 20:17:37] Построение дополнительных данных завершено за 0:00:06.841896
[2025-09-02 20:17:37] === ПРЕДВАРИТЕЛЬНЫЙ РАСЧЕТ ПРИЗНАКОВ ДЛЯ LGBM ===
[2025-09-02 20:17:37] Построение словаря пользовательских признаков из ТРЕНИРОВОЧНЫХ данных...
[2025-09-02 20:17:38] Агрегация по ЗАКАЗАМ (train)...
[2025-09-02 20:17:39] Словарь пользовательских признаков построен. Записей: 942062
[2025-09-02 20:17:39] User features построены за 0:00:01.733744: 942062 пользователей
[2025-09-02 20:17:39] Построение словаря товарных признаков из ТРЕНИРОВОЧНЫХ данных...
[2025-09-02 20:17:40] Обработка ЗАКАЗОВ (train)...
[2025-09-02 20:17:40] Словарь товарных признаков построен. Записей: 305026
[2025-09-02 20:17:40] Item features: 305026 товаров, размер вектора: 6 признаков
[2025-09-02 20:17:40] Порядок признаков: ['item_mean', 'item_orders_count', 'item_count', 'item_max', 'item_min', 'item_sum']
[2025-09-02 20:17:40] item_features_dict[27262977] type=<class 'numpy.ndarray'>, shape=(6,), example=[ 7.191743  0.       78.       33.603752  5.888878]
[2025-09-02 20:17:40] item_features_dict[298844161] type=<class 'numpy.ndarray'>, shape=(6,), example=[ 8.129327   0.        13.        31.945831   4.7590923]
[2025-09-02 20:17:40] item_features_dict[286261250] type=<class 'numpy.ndarray'>, shape=(6,), example=[12.424533  1.        1.       12.424533 12.424533]
[2025-09-02 20:17:40] item_features_dict[251658241] type=<class 'numpy.ndarray'>, shape=(6,), example=[ 5.656591   0.        26.        27.6001     1.5769147]
[2025-09-02 20:17:40] item_features_dict[71303174] type=<class 'numpy.ndarray'>, shape=(6,), example=[ 7.2219725   0.         21.         17.005987    0.36464313]
[2025-09-02 20:17:41] Item features построены за 0:00:01.859334
[2025-09-02 20:17:41] === ПОДГОТОВКА ДАННЫХ ДЛЯ МОДЕЛИ ===
[2025-09-02 20:17:41] Подготовка данных для модели (streaming, polars lazy, батчи)...
[2025-09-02 20:17:41] Тестовые заказы отсутствуют, используем только тренировочные
[2025-09-02 20:17:43] Разделение данных по времени: 2024-12-31 23:09:46 -> 2025-04-27 18:36:30.440000 (train) | 2025-04-27 18:36:30.440000 -> 2025-05-26 23:28:11.550000 (val)
[2025-09-02 20:17:49] ✅ Данные подготовлены. Train: 80652 строк, Val: 24706 строк
[2025-09-02 20:17:49] Размер train: 80652, validation: 24706
[2025-09-02 20:17:49] Признаки: 42
[2025-09-02 20:17:49] Подготовка данных для модели завершена за 0:00:08.190713
[2025-09-02 20:17:49] === ДЕТАЛЬНАЯ ПРОВЕРКА FEATURE GENERATION ===
[2025-09-02 20:17:49] --- ПРОВЕРКА USER FEATURES ---
[2025-09-02 20:17:49] Пример user features для пользователя 4987991:
[2025-09-02 20:17:49]   user_count: 7
[2025-09-02 20:17:49]   user_mean: 2.3554543849508605
[2025-09-02 20:17:49]   user_sum: 16.488180694656023
[2025-09-02 20:17:49]   user_max: 3.7125959807312525
[2025-09-02 20:17:49]   user_min: 0.36464311358790924
[2025-09-02 20:17:49]   user_orders_count: 0
[2025-09-02 20:17:49] Пользователей с features: 942062
[2025-09-02 20:17:49] Пользователей с НЕнулевыми features: 942062
[2025-09-02 20:17:49] --- ПРОВЕРКА ITEM FEATURES ---
[2025-09-02 20:17:49] Пример item features для товара 27262977:
[2025-09-02 20:17:49]   emb_0: 7.191742897033691
[2025-09-02 20:17:49]   emb_1: 0.0
[2025-09-02 20:17:49]   emb_2: 78.0
[2025-09-02 20:17:49]   emb_3: 33.60375213623047
[2025-09-02 20:17:49]   emb_4: 5.888877868652344
[2025-09-02 20:17:49]   emb_5: 560.9559326171875
[2025-09-02 20:17:50] Товаров с features: 305026
[2025-09-02 20:17:50] Товаров с НЕнулевыми features: 305026
[2025-09-02 20:17:50] --- ПРОВЕРКА ЭМБЕДДИНГОВ ---
[2025-09-02 20:17:50] Пример эмбеддинга для товара 313302306: shape (30,)
[2025-09-02 20:17:50] Эмбеддингов загружено: 99965
[2025-09-02 20:17:50] Пример значений: [ 9.4003105  4.4986963  1.5495423  5.7485657 -3.060239 ]
[2025-09-02 20:17:50] --- ПРОВЕРКА CO-PURCHASE MAP ---
[2025-09-02 20:17:50] Пример co-purchase для товара 229404153: 1 товаров
[2025-09-02 20:17:50] Co-purchase записей: 4
[2025-09-02 20:17:50] --- ПРОВЕРКА КАТЕГОРИЙНЫХ МАППИНГОВ ---
[2025-09-02 20:17:50] Товар 313302306 -> категория 7646
[2025-09-02 20:17:50] Категория 7646 -> 493 товаров
[2025-09-02 20:17:50] Товаров в маппинге: 99965
[2025-09-02 20:17:50] Категорий в маппинге: 430
[2025-09-02 20:17:50] Проверка признаков завершена за 0:00:00.505141
[2025-09-02 20:17:50] === ОБУЧЕНИЕ МОДЕЛИ ===
[2025-09-02 20:17:50] === ДЕБАГ ИНФОРМАЦИЯ: TRAIN ===
[2025-09-02 20:17:50] Размер: 80652 строк
[2025-09-02 20:17:50] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'timestamp', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'item_feat_0', 'item_feat_1', 'item_feat_2', 'item_feat_3', 'item_feat_4', 'item_feat_5', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'emb_12', 'emb_13', 'emb_14', 'emb_15', 'emb_16', 'emb_17', 'emb_18', 'emb_19', 'emb_20', 'emb_21', 'emb_22', 'emb_23', 'emb_24', 'emb_25', 'emb_26', 'emb_27', 'emb_28', 'emb_29']
[2025-09-02 20:17:50] ✅ Все признаки присутствуют
[2025-09-02 20:17:50] Целевая переменная: {1: np.int64(44722), 0: np.int64(35930)}
[2025-09-02 20:17:50] Пример первой строки:
[2025-09-02 20:17:50]   item_id: 88170092
[2025-09-02 20:17:50]   user_id: 2499810
[2025-09-02 20:17:50]   created_timestamp: 2025-03-20 12:44:16.013000
[2025-09-02 20:17:50]   last_status: delivered_orders
[2025-09-02 20:17:50]   target: 1
[2025-09-02 20:17:50]   timestamp: 2025-03-20 12:44:16.013000
[2025-09-02 20:17:50]   weight: 13.336140632629395
[2025-09-02 20:17:50]   user_count: 97.0
[2025-09-02 20:17:50]   user_mean: 6.048169505907726
[2025-09-02 20:17:50]   user_sum: 586.6724420730494
[2025-09-02 20:17:50]   user_max: 34.011973816621555
[2025-09-02 20:17:50]   user_min: 0.36464311358790924
[2025-09-02 20:17:50]   user_orders_count: 1.0
[2025-09-02 20:17:50]   item_feat_0: 13.336140632629395
[2025-09-02 20:17:50]   item_feat_1: 1.0
[2025-09-02 20:17:50]   item_feat_2: 1.0
[2025-09-02 20:17:50]   item_feat_3: 13.336140632629395
[2025-09-02 20:17:50]   item_feat_4: 13.336140632629395
[2025-09-02 20:17:50]   item_feat_5: 13.336140632629395
[2025-09-02 20:17:50]   emb_0: -5.13609504699707
[2025-09-02 20:17:50]   emb_1: 1.112060308456421
[2025-09-02 20:17:50]   emb_2: -1.2407925128936768
[2025-09-02 20:17:50]   emb_3: -4.286283493041992
[2025-09-02 20:17:50]   emb_4: 2.2593414783477783
[2025-09-02 20:17:50]   emb_5: 0.600287914276123
[2025-09-02 20:17:50]   emb_6: -5.196605682373047
[2025-09-02 20:17:50]   emb_7: -4.115002632141113
[2025-09-02 20:17:50]   emb_8: -4.629369258880615
[2025-09-02 20:17:50]   emb_9: -1.433375597000122
[2025-09-02 20:17:50]   emb_10: 6.384012222290039
[2025-09-02 20:17:50]   emb_11: -1.7133502960205078
[2025-09-02 20:17:50]   emb_12: 7.103966236114502
[2025-09-02 20:17:50]   emb_13: -0.6713266372680664
[2025-09-02 20:17:50]   emb_14: 1.3893464803695679
[2025-09-02 20:17:50]   emb_15: 2.062088966369629
[2025-09-02 20:17:50]   emb_16: -0.47765690088272095
[2025-09-02 20:17:50]   emb_17: -0.0835854709148407
[2025-09-02 20:17:50]   emb_18: -1.122560977935791
[2025-09-02 20:17:50]   emb_19: -1.0626581907272339
[2025-09-02 20:17:50]   emb_20: -0.5109571814537048
[2025-09-02 20:17:50]   emb_21: -1.5122160911560059
[2025-09-02 20:17:50]   emb_22: -0.43860292434692383
[2025-09-02 20:17:50]   emb_23: -3.493290424346924
[2025-09-02 20:17:50]   emb_24: 0.09685487300157547
[2025-09-02 20:17:50]   emb_25: 2.325176239013672
[2025-09-02 20:17:50]   emb_26: 0.9996365904808044
[2025-09-02 20:17:50]   emb_27: 0.26244789361953735
[2025-09-02 20:17:50]   emb_28: -0.7475874423980713
[2025-09-02 20:17:50]   emb_29: 0.4198390245437622
[2025-09-02 20:17:50] === ДЕБАГ ИНФОРМАЦИЯ: VAL ===
[2025-09-02 20:17:50] Размер: 24706 строк
[2025-09-02 20:17:50] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'timestamp', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'item_feat_0', 'item_feat_1', 'item_feat_2', 'item_feat_3', 'item_feat_4', 'item_feat_5', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'emb_12', 'emb_13', 'emb_14', 'emb_15', 'emb_16', 'emb_17', 'emb_18', 'emb_19', 'emb_20', 'emb_21', 'emb_22', 'emb_23', 'emb_24', 'emb_25', 'emb_26', 'emb_27', 'emb_28', 'emb_29']
[2025-09-02 20:17:50] ✅ Все признаки присутствуют
[2025-09-02 20:17:50] Целевая переменная: {1: np.int64(13964), 0: np.int64(10742)}
[2025-09-02 20:17:50] Пример первой строки:
[2025-09-02 20:17:50]   item_id: 66203013
[2025-09-02 20:17:50]   user_id: 4949691
[2025-09-02 20:17:50]   created_timestamp: 2025-04-27 23:07:28.193000
[2025-09-02 20:17:50]   last_status: delivered_orders
[2025-09-02 20:17:50]   target: 1
[2025-09-02 20:17:50]   timestamp: 2025-04-27 23:07:28.193000
[2025-09-02 20:17:50]   weight: 9.584612846374512
[2025-09-02 20:17:50]   user_count: 458.0
[2025-09-02 20:17:50]   user_mean: 7.194146949872823
[2025-09-02 20:17:50]   user_sum: 3294.9193030417528
[2025-09-02 20:17:50]   user_max: 34.011973816621555
[2025-09-02 20:17:50]   user_min: 1.1755733298042381
[2025-09-02 20:17:50]   user_orders_count: 1.0
[2025-09-02 20:17:50]   item_feat_0: 9.584612846374512
[2025-09-02 20:17:50]   item_feat_1: 1.0
[2025-09-02 20:17:50]   item_feat_2: 1.0
[2025-09-02 20:17:50]   item_feat_3: 9.584612846374512
[2025-09-02 20:17:50]   item_feat_4: 9.584612846374512
[2025-09-02 20:17:50]   item_feat_5: 9.584612846374512
[2025-09-02 20:17:50]   emb_0: -0.21126338839530945
[2025-09-02 20:17:50]   emb_1: -7.9917707443237305
[2025-09-02 20:17:50]   emb_2: 4.880442142486572
[2025-09-02 20:17:50]   emb_3: 1.3534729480743408
[2025-09-02 20:17:50]   emb_4: -1.9214568138122559
[2025-09-02 20:17:50]   emb_5: 6.531264781951904
[2025-09-02 20:17:50]   emb_6: -0.6564199328422546
[2025-09-02 20:17:50]   emb_7: -0.4744755029678345
[2025-09-02 20:17:50]   emb_8: 0.19033615291118622
[2025-09-02 20:17:50]   emb_9: 2.8358006477355957
[2025-09-02 20:17:50]   emb_10: 0.5867300629615784
[2025-09-02 20:17:50]   emb_11: 0.3217942416667938
[2025-09-02 20:17:50]   emb_12: -1.432550311088562
[2025-09-02 20:17:50]   emb_13: -0.4457077383995056
[2025-09-02 20:17:50]   emb_14: -2.0623021125793457
[2025-09-02 20:17:50]   emb_15: 1.771357536315918
[2025-09-02 20:17:50]   emb_16: 0.7232105731964111
[2025-09-02 20:17:50]   emb_17: -0.052475281059741974
[2025-09-02 20:17:50]   emb_18: -0.9548344612121582
[2025-09-02 20:17:50]   emb_19: 0.29795756936073303
[2025-09-02 20:17:50]   emb_20: -2.851491689682007
[2025-09-02 20:17:50]   emb_21: -0.49834078550338745
[2025-09-02 20:17:50]   emb_22: -0.5372157096862793
[2025-09-02 20:17:50]   emb_23: -0.3624943494796753
[2025-09-02 20:17:50]   emb_24: 1.4478034973144531
[2025-09-02 20:17:50]   emb_25: -0.9675109386444092
[2025-09-02 20:17:50]   emb_26: 1.5824170112609863
[2025-09-02 20:17:50]   emb_27: 0.22077512741088867
[2025-09-02 20:17:50]   emb_28: -2.442293882369995
[2025-09-02 20:17:50]   emb_29: 2.0849199295043945
[2025-09-02 20:17:50] Feature columns: ['user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'item_feat_0', 'item_feat_1', 'item_feat_2', 'item_feat_3', 'item_feat_4', 'item_feat_5', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'emb_12', 'emb_13', 'emb_14', 'emb_15', 'emb_16', 'emb_17', 'emb_18', 'emb_19', 'emb_20', 'emb_21', 'emb_22', 'emb_23', 'emb_24', 'emb_25', 'emb_26', 'emb_27', 'emb_28', 'emb_29']
[2025-09-02 20:17:50] 📊 Всего данных для обработки: 80652 строк
[2025-09-02 20:17:50] 📦 Чанк 1/1 (80652 строк)
[2025-09-02 20:17:50] 💾 Модель сохранена после чанка 1
[2025-09-02 20:17:51] 🎯 Финальный NDCG@100 на валидации: 0.951498
[2025-09-02 20:17:51] Обучение модели завершено за 0:00:01.442946
[2025-09-02 20:17:51] === ОЦЕНКА МОДЕЛИ ===
[2025-09-02 20:17:54] NDCG@100 train: 0.9346
[2025-09-02 20:17:54] NDCG@100 val: 0.9515
[2025-09-02 20:17:54] === СОХРАНЕНИЕ МОДЕЛИ И ПРИЗНАКОВ ===
[2025-09-02 20:17:56] Сохранение модели завершено за 0:00:01.760363
[2025-09-02 20:17:56] Модель сохранена в: /home/root6/python/e_cup/rec_system/src/models/model.pkl
[2025-09-02 20:17:56] === ОБУЧЕНИЕ И ПРЕДСКАЗАНИЯ ЗАВЕРШЕНЫ УСПЕШНО ===
[2025-09-02 20:17:56] Общее время выполнения: 0:03:29.840575
[2025-09-02 20:17:56] Пользователей: 942062
[2025-09-02 20:17:56] Товаров: 305026
[2025-09-02 20:17:56] Признаков: 42
[2025-09-02 20:17:56] === СИСТЕМНАЯ ИНФОРМАЦИЯ ===
[2025-09-02 20:17:56] Видеокарта: NVIDIA GeForce RTX 4090
[2025-09-02 20:17:56] Память GPU: 24.0 GB
[2025-09-02 20:17:56] Процессор: 29.6% загрузки
[2025-09-02 20:17:56] Ядра CPU: 32
[2025-09-02 20:17:56] Частота CPU: 2995.2 MHz
[2025-09-02 20:17:56] Оперативная память: 94.2 GB всего, 61.5 GB использовано
[2025-09-02 20:17:56] ==========================================
[2025-09-02 20:17:56] ВСЕ ЭТАПЫ ВЫПОЛНЕНЫ УСПЕШНО!
[2025-09-02 20:17:56] ==========================================

=== ОБЩЕЕ ВРЕМЯ ВЫПОЛНЕНИЯ: 0:03:29.841524 ===
