=== НАЧАЛО ОБУЧЕНИЯ 2025-09-02 23:58:14 ===

[2025-09-02 23:58:14] === РЕЖИМ МАСШТАБИРОВАНИЯ: FULL ===
[2025-09-02 23:58:14] Пользователей: все
[2025-09-02 23:58:14] Данных: 100.0%
[2025-09-02 23:58:14] === ЗАГРУЗКА ДАННЫХ ===
[2025-09-02 23:58:14] Загружаем данные...
[2025-09-02 23:58:14] orders: найдено 5 файлов, используем 5
[2025-09-02 23:58:15] orders: 18,887,122 строк (использовано 5 файлов), ~828.1 MB
[2025-09-02 23:58:15] tracker: найдено 200 файлов, используем 200
[2025-09-02 23:58:30] tracker: 1,644,982,482 строк (использовано 200 файлов), ~65693.4 MB
[2025-09-02 23:58:30] items: найдено 100 файлов, используем 100
[2025-09-02 23:58:36] items: 6,439,422 строк (использовано 100 файлов), ~1134.2 MB
[2025-09-02 23:58:36] categories: найдено 1 файлов, используем 1
[2025-09-02 23:58:36] categories: 7,012 строк (использовано 1 файлов), ~1.7 MB
[2025-09-02 23:58:36] test_users: найдено 1 файлов, используем 1
[2025-09-02 23:58:36] test_users: 470,347 строк (использовано 1 файлов), ~1.8 MB
[2025-09-02 23:58:36] Данные загружены
[2025-09-02 23:58:36] Фильтрация данных...
[2025-09-02 23:58:36] Фильтрация завершена
[2025-09-02 23:58:36] Загрузка данных завершена за 0:00:21.915237
[2025-09-02 23:58:36] === ЗАГРУЗКА ЭМБЕДДИНГОВ ===
[2025-09-02 23:58:36] Оптимизированная потоковая загрузка эмбеддингов... без PCA
[2025-09-02 23:58:58] Загружено эмбеддингов для 6342024 товаров
[2025-09-02 23:58:59] Загружено сырых эмбеддингов: 6342024
[2025-09-02 23:58:59] Размерность исходных эмбеддингов: 512
[2025-09-02 23:58:59] Анализ дисперсии эмбеддингов...
[2025-09-02 23:59:58] Оптимальное число компонент PCA: 354
[2025-09-02 23:59:58] Объясненная дисперсия: 95.033%
[2025-09-03 00:00:35] График PCA сохранен: /home/root6/python/e_cup/rec_system/pca_variance.png
[2025-09-03 00:00:35] Используем 200 компонент PCA (оптимально: 354, лимит: 200)
[2025-09-03 00:00:44] Обучение PCA на выборке из 100000 эмбеддингов...
[2025-09-03 00:00:50] PCA: сохранено 82.05% дисперсии в 200 компонентах
[2025-09-03 00:00:51] Применение PCA ко всем 6342024 эмбеддингам батчами...
[2025-09-03 00:01:18] PCA трансформация завершена
[2025-09-03 00:01:47] Модель PCA сохранена: /home/root6/python/e_cup/rec_system/data/processed/embeddings_pca_pca.pkl
[2025-09-03 00:01:47] Модель Scaler сохранена: /home/root6/python/e_cup/rec_system/data/processed/embeddings_pca_scaler.pkl
[2025-09-03 00:01:47] Пример ключей в embeddings_dict: [16450600, 26171495, 32624500, 50387994, 87041801]
[2025-09-03 00:01:47] Пример значения после PCA: [1.7731793 0.1931155 1.4446561 5.2884903 3.7086983]
[2025-09-03 00:01:47] Размерность после PCA: 200
[2025-09-03 00:01:47] Загрузка эмбеддингов с PCA завершена за 0:03:10.833662
[2025-09-03 00:01:47] Загружено эмбеддингов: 6342024
[2025-09-03 00:01:48] === SPLIT ДАННЫХ ===
[2025-09-03 00:01:58] Split данных завершен за 0:00:09.502445
[2025-09-03 00:01:58] Train orders: 13755583, Test orders: 3438892
[2025-09-03 00:01:58] === ПОДГОТОВКА ВЗАИМОДЕЙСТВИЙ ===
[2025-09-03 00:01:58] Формируем матрицу взаимодействий по батчам...
[2025-09-03 00:01:58] ... обработка orders
[2025-09-03 00:01:58] Сохранен orders-батч 0-1000000
[2025-09-03 00:01:58] Сохранен orders-батч 1000000-2000000
[2025-09-03 00:01:58] Сохранен orders-батч 2000000-3000000
[2025-09-03 00:01:58] Сохранен orders-батч 3000000-4000000
[2025-09-03 00:01:58] Сохранен orders-батч 4000000-5000000
[2025-09-03 00:01:59] Сохранен orders-батч 5000000-6000000
[2025-09-03 00:01:59] Сохранен orders-батч 6000000-7000000
[2025-09-03 00:01:59] Сохранен orders-батч 7000000-8000000
[2025-09-03 00:01:59] Сохранен orders-батч 8000000-9000000
[2025-09-03 00:02:00] Сохранен orders-батч 9000000-10000000
[2025-09-03 00:02:00] Сохранен orders-батч 10000000-11000000
[2025-09-03 00:02:00] Сохранен orders-батч 11000000-12000000
[2025-09-03 00:02:00] Сохранен orders-батч 12000000-13000000
[2025-09-03 00:02:00] Сохранен orders-батч 13000000-13755583
[2025-09-03 00:02:00] ... обработка tracker
[2025-09-03 00:02:00] Обрабатываем 10 файлов tracker
[2025-09-03 00:02:02] Обработан tracker файл 0: 5204228 строк
[2025-09-03 00:02:03] Обработан tracker файл 1: 5088402 строк
[2025-09-03 00:02:04] Обработан tracker файл 2: 5045487 строк
[2025-09-03 00:02:05] Обработан tracker файл 3: 4987285 строк
[2025-09-03 00:02:07] Обработан tracker файл 4: 4989096 строк
[2025-09-03 00:02:08] Обработан tracker файл 5: 5219465 строк
[2025-09-03 00:02:09] Обработан tracker файл 6: 5030300 строк
[2025-09-03 00:02:11] Обработан tracker файл 7: 5186810 строк
[2025-09-03 00:02:14] Обработан tracker файл 8: 5120177 строк
[2025-09-03 00:02:15] Обработан tracker файл 9: 5067673 строк
[2025-09-03 00:02:15] ✅ Все файлы успешно созданы
[2025-09-03 00:02:15] Всего файлов взаимодействий: 24
[2025-09-03 00:02:15] Подготовка взаимодействий завершена за 0:00:17.874151
[2025-09-03 00:02:15] Создано файлов взаимодействий: 24
[2025-09-03 00:02:15] === ПОСЛЕДНИЕ ТОВАРЫ ===
[2025-09-03 00:02:30] Словарь сохранен в /home/root6/python/e_cup/rec_system/data/processed/recent_items_map.pkl
[2025-09-03 00:02:30] Построение recent items map завершено за 0:00:14.682838
[2025-09-03 00:02:30] Пользователей с recent items: 960818
[2025-09-03 00:02:30] === ОБУЧЕНИЕ ALS ДЛЯ ПРИЗНАКОВ ===
[2025-09-03 00:02:30] Первый проход: построение маппингов...
[2025-09-03 00:02:34] Маппинги построены. Уников: users=960818, items=3972133
[2025-09-03 00:02:34] item_map сохранен: /home/root6/python/e_cup/rec_system/data/processed/item_map.pkl
[2025-09-03 00:02:34] Сохранение батчей на диск...
[2025-09-03 00:02:36] Обучение als_model...
[2025-09-03 00:02:51] Очистка временных файлов...
[2025-09-03 00:02:51] Директория батчей удалена
[2025-09-03 00:02:51] Обучение завершено!
[2025-09-03 00:02:51] Считаем глобальную популярность на основе тренировочных данных...
[2025-09-03 00:02:52] Глобальная популярность рассчитана на 13755580 тренировочных заказах
[2025-09-03 00:02:52] Обучение ALS завершено за 0:00:22.376111
[2025-09-03 00:02:52] Пользователей: 960818, Товаров: 3972133
[2025-09-03 00:02:52] === ПОСТРОЕНИЕ ДОПОЛНИТЕЛЬНЫХ ДАННЫХ ===
[2025-09-03 00:02:52] Строим co-purchase матрицу для топ-N товаров...
[2025-09-03 00:02:53] Топ-1000 популярных товаров определены
[2025-09-03 00:04:32] Обрабатываем 15477 корзин с популярными товарами
[2025-09-03 00:04:32] Уникальных популярных товаров: 1000
[2025-09-03 00:04:32] Создаем sparse матрицу из 42752 взаимодействий...
[2025-09-03 00:04:32] Sparse матрица построена: torch.Size([1000, 1000]), ненулевых элементов: 17546
[2025-09-03 00:04:32] Формируем рекомендации...
[2025-09-03 00:04:35] Co-purchase словарь построен для 996 товаров
[2025-09-03 00:04:35] В среднем 12.9 рекомендаций на товар
[2025-09-03 00:04:35] Co-purchase map построен: 996 товаров
[2025-09-03 00:04:42] Построение категорийных маппингов...
[2025-09-03 00:04:44] Категорийные маппинги построены: 6342024 товаров, 478 категорий
[2025-09-03 00:04:44] Построение дополнительных данных завершено за 0:01:52.027699
[2025-09-03 00:04:44] === ПРЕДВАРИТЕЛЬНЫЙ РАСЧЕТ ПРИЗНАКОВ ===
[2025-09-03 00:04:44] Построение словаря пользовательских признаков из ТРЕНИРОВОЧНЫХ данных...
[2025-09-03 00:04:45] Агрегация по ЗАКАЗАМ (train)...
[2025-09-03 00:04:47] Словарь пользовательских признаков построен. Записей: 960818
[2025-09-03 00:04:47] User features построены за 0:00:02.336559: 960818 пользователей
[2025-09-03 00:04:47] Построение словаря товарных признаков из ТРЕНИРОВОЧНЫХ данных...
[2025-09-03 00:04:49] Обработка ЗАКАЗОВ (train)...
[2025-09-03 00:04:53] Словарь товарных признаков построен. Записей: 3972133
[2025-09-03 00:04:56] Item features: 3972133 товаров, размер вектора: 6 признаков
[2025-09-03 00:04:56] Порядок признаков: ['item_min', 'item_sum', 'item_count', 'item_mean', 'item_orders_count', 'item_max']
[2025-09-03 00:04:56] item_features_dict[251658241] type=<class 'numpy.ndarray'>, shape=(6,), example=[  1.5769147 154.25311    27.          5.7130785   1.       ]
[2025-09-03 00:04:56] item_features_dict[192937988] type=<class 'numpy.ndarray'>, shape=(6,), example=[16.479185 16.479185  1.       16.479185  1.      ]
[2025-09-03 00:04:56] item_features_dict[184549381] type=<class 'numpy.ndarray'>, shape=(6,), example=[14.722195 14.722195  1.       14.722195  1.      ]
[2025-09-03 00:04:56] item_features_dict[75497478] type=<class 'numpy.ndarray'>, shape=(6,), example=[15.545305 15.545305  1.       15.545305  1.      ]
[2025-09-03 00:04:56] item_features_dict[25165834] type=<class 'numpy.ndarray'>, shape=(6,), example=[4.7775574 4.7775574 1.        4.7775574 1.       ]
[2025-09-03 00:05:07] Item features построены за 0:00:20.381508
[2025-09-03 00:05:07] === ПОДГОТОВКА ДАННЫХ ДЛЯ МОДЕЛИ ===
[2025-09-03 00:05:07] Подготовка данных для модели (streaming, polars lazy, батчи)...
[2025-09-03 00:05:07] Тестовые заказы отсутствуют, используем только тренировочные
[2025-09-03 00:05:11] Разделение данных по времени: 2024-12-05 06:00:08 -> 2025-04-22 19:41:17.896000 (train) | 2025-04-22 19:41:17.896000 -> 2025-05-27 11:06:35.370000 (val)
[2025-09-03 00:06:02] ✅ Данные подготовлены. Train: 13896566 строк, Val: 5360460 строк
[2025-09-03 00:06:02] Размер train: 13896566, validation: 5360460
[2025-09-03 00:06:02] Признаки: 212
[2025-09-03 00:06:02] Подготовка данных для модели завершена за 0:00:55.263081
[2025-09-03 00:06:02] === ДЕТАЛЬНАЯ ПРОВЕРКА FEATURE GENERATION ===
[2025-09-03 00:06:02] --- ПРОВЕРКА USER FEATURES ---
[2025-09-03 00:06:02] Пример user features для пользователя 4834101:
[2025-09-03 00:06:02]   user_count: 9
[2025-09-03 00:06:02]   user_mean: 7.599712210142346
[2025-09-03 00:06:02]   user_sum: 68.39740989128111
[2025-09-03 00:06:02]   user_max: 25.01435951739211
[2025-09-03 00:06:02]   user_min: 4.8672267108008995
[2025-09-03 00:06:02]   user_orders_count: 0
[2025-09-03 00:06:03] Пользователей с features: 960818
[2025-09-03 00:06:03] Пользователей с НЕнулевыми features: 960818
[2025-09-03 00:06:03] --- ПРОВЕРКА ITEM FEATURES ---
[2025-09-03 00:06:03] Пример item features для товара 251658241:
[2025-09-03 00:06:03]   emb_0: 1.576914668083191
[2025-09-03 00:06:03]   emb_1: 154.25311279296875
[2025-09-03 00:06:03]   emb_2: 27.0
[2025-09-03 00:06:03]   emb_3: 5.713078498840332
[2025-09-03 00:06:03]   emb_4: 1.0
[2025-09-03 00:06:03]   emb_5: 27.725887298583984
[2025-09-03 00:06:08] Товаров с features: 3972133
[2025-09-03 00:06:08] Товаров с НЕнулевыми features: 3972133
[2025-09-03 00:06:08] --- ПРОВЕРКА ЭМБЕДДИНГОВ ---
[2025-09-03 00:06:08] Пример эмбеддинга для товара 16450600: shape (200,)
[2025-09-03 00:06:08] Эмбеддингов загружено: 6342024
[2025-09-03 00:06:08] Пример значений: [1.7731793 0.1931155 1.4446561 5.2884903 3.7086983]
[2025-09-03 00:06:08] --- ПРОВЕРКА CO-PURCHASE MAP ---
[2025-09-03 00:06:08] Пример co-purchase для товара 51974017: 20 товаров
[2025-09-03 00:06:08] Co-purchase записей: 996
[2025-09-03 00:06:08] --- ПРОВЕРКА КАТЕГОРИЙНЫХ МАППИНГОВ ---
[2025-09-03 00:06:08] Товар 5264590 -> категория 36517
[2025-09-03 00:06:08] Категория 36517 -> 12044 товаров
[2025-09-03 00:06:08] Товаров в маппинге: 6342024
[2025-09-03 00:06:08] Категорий в маппинге: 478
[2025-09-03 00:06:08] Проверка признаков завершена за 0:00:05.309621
[2025-09-03 00:06:08] === ОБУЧЕНИЕ МОДЕЛИ ===
[2025-09-03 00:06:26] === ДЕБАГ ИНФОРМАЦИЯ: TRAIN ===
[2025-09-03 00:06:26] Размер: 13896566 строк
[2025-09-03 00:06:26] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'timestamp', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'item_feat_0', 'item_feat_1', 'item_feat_2', 'item_feat_3', 'item_feat_4', 'item_feat_5', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'emb_12', 'emb_13', 'emb_14', 'emb_15', 'emb_16', 'emb_17', 'emb_18', 'emb_19', 'emb_20', 'emb_21', 'emb_22', 'emb_23', 'emb_24', 'emb_25', 'emb_26', 'emb_27', 'emb_28', 'emb_29', 'emb_30', 'emb_31', 'emb_32', 'emb_33', 'emb_34', 'emb_35', 'emb_36', 'emb_37', 'emb_38', 'emb_39', 'emb_40', 'emb_41', 'emb_42', 'emb_43', 'emb_44', 'emb_45', 'emb_46', 'emb_47', 'emb_48', 'emb_49', 'emb_50', 'emb_51', 'emb_52', 'emb_53', 'emb_54', 'emb_55', 'emb_56', 'emb_57', 'emb_58', 'emb_59', 'emb_60', 'emb_61', 'emb_62', 'emb_63', 'emb_64', 'emb_65', 'emb_66', 'emb_67', 'emb_68', 'emb_69', 'emb_70', 'emb_71', 'emb_72', 'emb_73', 'emb_74', 'emb_75', 'emb_76', 'emb_77', 'emb_78', 'emb_79', 'emb_80', 'emb_81', 'emb_82', 'emb_83', 'emb_84', 'emb_85', 'emb_86', 'emb_87', 'emb_88', 'emb_89', 'emb_90', 'emb_91', 'emb_92', 'emb_93', 'emb_94', 'emb_95', 'emb_96', 'emb_97', 'emb_98', 'emb_99', 'emb_100', 'emb_101', 'emb_102', 'emb_103', 'emb_104', 'emb_105', 'emb_106', 'emb_107', 'emb_108', 'emb_109', 'emb_110', 'emb_111', 'emb_112', 'emb_113', 'emb_114', 'emb_115', 'emb_116', 'emb_117', 'emb_118', 'emb_119', 'emb_120', 'emb_121', 'emb_122', 'emb_123', 'emb_124', 'emb_125', 'emb_126', 'emb_127', 'emb_128', 'emb_129', 'emb_130', 'emb_131', 'emb_132', 'emb_133', 'emb_134', 'emb_135', 'emb_136', 'emb_137', 'emb_138', 'emb_139', 'emb_140', 'emb_141', 'emb_142', 'emb_143', 'emb_144', 'emb_145', 'emb_146', 'emb_147', 'emb_148', 'emb_149', 'emb_150', 'emb_151', 'emb_152', 'emb_153', 'emb_154', 'emb_155', 'emb_156', 'emb_157', 'emb_158', 'emb_159', 'emb_160', 'emb_161', 'emb_162', 'emb_163', 'emb_164', 'emb_165', 'emb_166', 'emb_167', 'emb_168', 'emb_169', 'emb_170', 'emb_171', 'emb_172', 'emb_173', 'emb_174', 'emb_175', 'emb_176', 'emb_177', 'emb_178', 'emb_179', 'emb_180', 'emb_181', 'emb_182', 'emb_183', 'emb_184', 'emb_185', 'emb_186', 'emb_187', 'emb_188', 'emb_189', 'emb_190', 'emb_191', 'emb_192', 'emb_193', 'emb_194', 'emb_195', 'emb_196', 'emb_197', 'emb_198', 'emb_199']
[2025-09-03 00:06:26] ✅ Все признаки присутствуют
[2025-09-03 00:06:27] Целевая переменная: {1: np.int64(7852347), 0: np.int64(6044219)}
[2025-09-03 00:06:27] Пример первой строки:
[2025-09-03 00:06:27]   item_id: 291073667
[2025-09-03 00:06:27]   user_id: 627281
[2025-09-03 00:06:27]   created_timestamp: 2025-01-01 23:58:25.463000
[2025-09-03 00:06:27]   last_status: delivered_orders
[2025-09-03 00:06:27]   target: 1
[2025-09-03 00:06:27]   timestamp: 2025-01-01 23:58:25.463000
[2025-09-03 00:06:27]   weight: 17.0059871673584
[2025-09-03 00:06:27]   user_count: 115.0
[2025-09-03 00:06:27]   user_mean: 5.928806875435734
[2025-09-03 00:06:27]   user_sum: 681.8127906751095
[2025-09-03 00:06:27]   user_max: 17.005986908310778
[2025-09-03 00:06:27]   user_min: 0.36464311358790924
[2025-09-03 00:06:27]   user_orders_count: 11.0
[2025-09-03 00:06:27]   item_feat_0: 7.630281448364258
[2025-09-03 00:06:27]   item_feat_1: 235.5639190673828
[2025-09-03 00:06:27]   item_feat_2: 18.0
[2025-09-03 00:06:27]   item_feat_3: 13.086884498596191
[2025-09-03 00:06:27]   item_feat_4: 18.0
[2025-09-03 00:06:27]   item_feat_5: 17.0059871673584
[2025-09-03 00:06:27]   emb_0: 3.2376084327697754
[2025-09-03 00:06:27]   emb_1: -10.93852424621582
[2025-09-03 00:06:27]   emb_2: -0.6616462469100952
[2025-09-03 00:06:27]   emb_3: -4.671825408935547
[2025-09-03 00:06:27]   emb_4: 0.3815857470035553
[2025-09-03 00:06:27]   emb_5: 1.0811690092086792
[2025-09-03 00:06:27]   emb_6: -0.6399321556091309
[2025-09-03 00:06:27]   emb_7: -2.5193238258361816
[2025-09-03 00:06:27]   emb_8: 1.4846277236938477
[2025-09-03 00:06:27]   emb_9: 1.3764928579330444
[2025-09-03 00:06:27]   emb_10: 1.3686074018478394
[2025-09-03 00:06:27]   emb_11: 0.47084346413612366
[2025-09-03 00:06:27]   emb_12: 0.49608901143074036
[2025-09-03 00:06:27]   emb_13: 1.6085755825042725
[2025-09-03 00:06:27]   emb_14: 2.845043897628784
[2025-09-03 00:06:27]   emb_15: -0.22962456941604614
[2025-09-03 00:06:27]   emb_16: -0.25616273283958435
[2025-09-03 00:06:27]   emb_17: 1.1942169666290283
[2025-09-03 00:06:27]   emb_18: 0.7326726913452148
[2025-09-03 00:06:27]   emb_19: 3.5990309715270996
[2025-09-03 00:06:27]   emb_20: -1.8475019931793213
[2025-09-03 00:06:27]   emb_21: -2.3143205642700195
[2025-09-03 00:06:27]   emb_22: 0.0713043361902237
[2025-09-03 00:06:27]   emb_23: -0.5622915029525757
[2025-09-03 00:06:27]   emb_24: -2.02437162399292
[2025-09-03 00:06:27]   emb_25: -1.3302621841430664
[2025-09-03 00:06:27]   emb_26: 0.14470773935317993
[2025-09-03 00:06:27]   emb_27: 3.8258750438690186
[2025-09-03 00:06:27]   emb_28: 0.8329079747200012
[2025-09-03 00:06:27]   emb_29: 0.32810357213020325
[2025-09-03 00:06:27]   emb_30: 3.284625768661499
[2025-09-03 00:06:27]   emb_31: 0.9609093070030212
[2025-09-03 00:06:27]   emb_32: -2.9325461387634277
[2025-09-03 00:06:27]   emb_33: -3.540433168411255
[2025-09-03 00:06:27]   emb_34: -0.678910493850708
[2025-09-03 00:06:27]   emb_35: -1.5770339965820312
[2025-09-03 00:06:27]   emb_36: -0.9466356039047241
[2025-09-03 00:06:27]   emb_37: 0.8658400774002075
[2025-09-03 00:06:27]   emb_38: 2.023193597793579
[2025-09-03 00:06:27]   emb_39: 1.1741591691970825
[2025-09-03 00:06:27]   emb_40: -1.3831982612609863
[2025-09-03 00:06:27]   emb_41: 1.7348835468292236
[2025-09-03 00:06:27]   emb_42: 1.2096071243286133
[2025-09-03 00:06:27]   emb_43: 0.13596180081367493
[2025-09-03 00:06:27]   emb_44: -0.6720914244651794
[2025-09-03 00:06:27]   emb_45: 0.06021767109632492
[2025-09-03 00:06:27]   emb_46: 0.10572994500398636
[2025-09-03 00:06:27]   emb_47: 0.29056698083877563
[2025-09-03 00:06:27]   emb_48: 3.985647201538086
[2025-09-03 00:06:27]   emb_49: 1.941841959953308
[2025-09-03 00:06:27]   emb_50: -1.1219117641448975
[2025-09-03 00:06:27]   emb_51: 0.7967253923416138
[2025-09-03 00:06:27]   emb_52: 1.5372294187545776
[2025-09-03 00:06:27]   emb_53: 1.7422921657562256
[2025-09-03 00:06:27]   emb_54: 1.419737458229065
[2025-09-03 00:06:27]   emb_55: 1.0919915437698364
[2025-09-03 00:06:27]   emb_56: 1.3657832145690918
[2025-09-03 00:06:27]   emb_57: 1.7331430912017822
[2025-09-03 00:06:27]   emb_58: -1.102612853050232
[2025-09-03 00:06:27]   emb_59: 1.8429975509643555
[2025-09-03 00:06:27]   emb_60: -1.8253757953643799
[2025-09-03 00:06:27]   emb_61: -0.7074891328811646
[2025-09-03 00:06:27]   emb_62: -0.19860345125198364
[2025-09-03 00:06:27]   emb_63: 1.5069222450256348
[2025-09-03 00:06:27]   emb_64: -0.7395728230476379
[2025-09-03 00:06:27]   emb_65: -0.17512404918670654
[2025-09-03 00:06:27]   emb_66: 0.23834586143493652
[2025-09-03 00:06:27]   emb_67: 1.0419504642486572
[2025-09-03 00:06:27]   emb_68: -1.2836652994155884
[2025-09-03 00:06:27]   emb_69: -0.42228949069976807
[2025-09-03 00:06:27]   emb_70: -0.7591230869293213
[2025-09-03 00:06:27]   emb_71: 1.6378390789031982
[2025-09-03 00:06:27]   emb_72: -0.33291929960250854
[2025-09-03 00:06:27]   emb_73: -0.18521344661712646
[2025-09-03 00:06:27]   emb_74: 1.601933479309082
[2025-09-03 00:06:27]   emb_75: -0.4579361081123352
[2025-09-03 00:06:27]   emb_76: -0.06143265590071678
[2025-09-03 00:06:27]   emb_77: -0.8927098512649536
[2025-09-03 00:06:27]   emb_78: 1.4463417530059814
[2025-09-03 00:06:27]   emb_79: 0.9348112344741821
[2025-09-03 00:06:27]   emb_80: -1.6553088426589966
[2025-09-03 00:06:27]   emb_81: -2.325171947479248
[2025-09-03 00:06:27]   emb_82: 1.8146291971206665
[2025-09-03 00:06:27]   emb_83: 0.5729402899742126
[2025-09-03 00:06:27]   emb_84: -0.6442957520484924
[2025-09-03 00:06:27]   emb_85: 0.2434312403202057
[2025-09-03 00:06:27]   emb_86: -0.5903735756874084
[2025-09-03 00:06:27]   emb_87: -1.7377067804336548
[2025-09-03 00:06:27]   emb_88: 0.740054190158844
[2025-09-03 00:06:27]   emb_89: 0.11787477135658264
[2025-09-03 00:06:27]   emb_90: 0.2746373414993286
[2025-09-03 00:06:27]   emb_91: 1.3411405086517334
[2025-09-03 00:06:27]   emb_92: 0.02177233248949051
[2025-09-03 00:06:27]   emb_93: -0.2784716784954071
[2025-09-03 00:06:27]   emb_94: 1.3460817337036133
[2025-09-03 00:06:27]   emb_95: -0.3885040283203125
[2025-09-03 00:06:27]   emb_96: -0.9396630525588989
[2025-09-03 00:06:27]   emb_97: 0.6737452149391174
[2025-09-03 00:06:27]   emb_98: 0.6529691219329834
[2025-09-03 00:06:27]   emb_99: 0.6957716941833496
[2025-09-03 00:06:27]   emb_100: -1.2901313304901123
[2025-09-03 00:06:27]   emb_101: -0.5389202833175659
[2025-09-03 00:06:27]   emb_102: -0.09507579356431961
[2025-09-03 00:06:27]   emb_103: 0.35569679737091064
[2025-09-03 00:06:27]   emb_104: -0.7566721439361572
[2025-09-03 00:06:27]   emb_105: -0.7733854055404663
[2025-09-03 00:06:27]   emb_106: -1.9533132314682007
[2025-09-03 00:06:27]   emb_107: -0.8978966474533081
[2025-09-03 00:06:27]   emb_108: -1.2105021476745605
[2025-09-03 00:06:27]   emb_109: 0.2433726042509079
[2025-09-03 00:06:27]   emb_110: -1.6139390468597412
[2025-09-03 00:06:27]   emb_111: -0.021527770906686783
[2025-09-03 00:06:27]   emb_112: 0.5048655271530151
[2025-09-03 00:06:27]   emb_113: 0.7404654622077942
[2025-09-03 00:06:27]   emb_114: -0.47435447573661804
[2025-09-03 00:06:27]   emb_115: 0.14500263333320618
[2025-09-03 00:06:27]   emb_116: 0.3338749408721924
[2025-09-03 00:06:27]   emb_117: -0.5421114563941956
[2025-09-03 00:06:27]   emb_118: -0.39435887336730957
[2025-09-03 00:06:27]   emb_119: -0.4837692975997925
[2025-09-03 00:06:27]   emb_120: 0.9326662421226501
[2025-09-03 00:06:27]   emb_121: -1.1029402017593384
[2025-09-03 00:06:27]   emb_122: -0.5525735020637512
[2025-09-03 00:06:27]   emb_123: -1.3228697776794434
[2025-09-03 00:06:27]   emb_124: -1.8835006952285767
[2025-09-03 00:06:27]   emb_125: 1.2973507642745972
[2025-09-03 00:06:27]   emb_126: -0.38569876551628113
[2025-09-03 00:06:27]   emb_127: -0.30209043622016907
[2025-09-03 00:06:27]   emb_128: -0.3159051537513733
[2025-09-03 00:06:27]   emb_129: -0.48233187198638916
[2025-09-03 00:06:27]   emb_130: -0.3944464325904846
[2025-09-03 00:06:27]   emb_131: -0.4014645218849182
[2025-09-03 00:06:27]   emb_132: -0.9913264513015747
[2025-09-03 00:06:27]   emb_133: 1.1075797080993652
[2025-09-03 00:06:27]   emb_134: 1.108269453048706
[2025-09-03 00:06:27]   emb_135: 0.7457586526870728
[2025-09-03 00:06:27]   emb_136: 0.009602826088666916
[2025-09-03 00:06:27]   emb_137: -1.6896421909332275
[2025-09-03 00:06:27]   emb_138: 2.7939257621765137
[2025-09-03 00:06:27]   emb_139: 0.12747813761234283
[2025-09-03 00:06:27]   emb_140: 0.06009861081838608
[2025-09-03 00:06:27]   emb_141: -0.6725244522094727
[2025-09-03 00:06:27]   emb_142: -1.6731503009796143
[2025-09-03 00:06:27]   emb_143: 1.9303264617919922
[2025-09-03 00:06:27]   emb_144: -0.8757355213165283
[2025-09-03 00:06:27]   emb_145: -0.350458025932312
[2025-09-03 00:06:27]   emb_146: 0.5734115242958069
[2025-09-03 00:06:27]   emb_147: 0.16383567452430725
[2025-09-03 00:06:27]   emb_148: 0.2894112765789032
[2025-09-03 00:06:27]   emb_149: 0.49042972922325134
[2025-09-03 00:06:27]   emb_150: 0.9656167030334473
[2025-09-03 00:06:27]   emb_151: -0.487209677696228
[2025-09-03 00:06:27]   emb_152: -2.5985116958618164
[2025-09-03 00:06:27]   emb_153: 1.03318190574646
[2025-09-03 00:06:27]   emb_154: -0.339290976524353
[2025-09-03 00:06:27]   emb_155: 0.5175580382347107
[2025-09-03 00:06:27]   emb_156: -0.04834076762199402
[2025-09-03 00:06:27]   emb_157: -0.46831849217414856
[2025-09-03 00:06:27]   emb_158: 1.2581288814544678
[2025-09-03 00:06:27]   emb_159: -0.20777268707752228
[2025-09-03 00:06:27]   emb_160: -0.34526631236076355
[2025-09-03 00:06:27]   emb_161: 1.4558042287826538
[2025-09-03 00:06:27]   emb_162: -0.9559008479118347
[2025-09-03 00:06:27]   emb_163: 0.6831316351890564
[2025-09-03 00:06:27]   emb_164: -0.6245310306549072
[2025-09-03 00:06:27]   emb_165: 0.6639798879623413
[2025-09-03 00:06:27]   emb_166: -0.4077094495296478
[2025-09-03 00:06:27]   emb_167: -0.7214858531951904
[2025-09-03 00:06:27]   emb_168: 0.35711467266082764
[2025-09-03 00:06:27]   emb_169: 0.09687123447656631
[2025-09-03 00:06:27]   emb_170: 0.7061776518821716
[2025-09-03 00:06:27]   emb_171: 1.3557385206222534
[2025-09-03 00:06:27]   emb_172: -0.5343321561813354
[2025-09-03 00:06:27]   emb_173: -0.622533917427063
[2025-09-03 00:06:27]   emb_174: 0.5348291993141174
[2025-09-03 00:06:27]   emb_175: -0.1535300612449646
[2025-09-03 00:06:27]   emb_176: 1.016804575920105
[2025-09-03 00:06:27]   emb_177: 0.08241575211286545
[2025-09-03 00:06:27]   emb_178: 0.04839340224862099
[2025-09-03 00:06:27]   emb_179: -1.33768892288208
[2025-09-03 00:06:27]   emb_180: -0.06732650846242905
[2025-09-03 00:06:27]   emb_181: 0.45776739716529846
[2025-09-03 00:06:27]   emb_182: -0.24707478284835815
[2025-09-03 00:06:27]   emb_183: -1.3763549327850342
[2025-09-03 00:06:27]   emb_184: -0.47606438398361206
[2025-09-03 00:06:27]   emb_185: -0.12499035149812698
[2025-09-03 00:06:27]   emb_186: -0.9576682448387146
[2025-09-03 00:06:27]   emb_187: -0.23142243921756744
[2025-09-03 00:06:27]   emb_188: -0.08301214873790741
[2025-09-03 00:06:27]   emb_189: -0.4724854528903961
[2025-09-03 00:06:27]   emb_190: -0.4577908515930176
[2025-09-03 00:06:27]   emb_191: -0.9171302914619446
[2025-09-03 00:06:27]   emb_192: 0.9417473673820496
[2025-09-03 00:06:27]   emb_193: 0.23377926647663116
[2025-09-03 00:06:27]   emb_194: 0.5313012599945068
[2025-09-03 00:06:27]   emb_195: -0.5414719581604004
[2025-09-03 00:06:27]   emb_196: 0.1175156757235527
[2025-09-03 00:06:27]   emb_197: 1.0141335725784302
[2025-09-03 00:06:27]   emb_198: 0.2873222827911377
[2025-09-03 00:06:27]   emb_199: -0.4321317672729492
[2025-09-03 00:06:27] === ДЕБАГ ИНФОРМАЦИЯ: VAL ===
[2025-09-03 00:06:27] Размер: 5360460 строк
[2025-09-03 00:06:27] Колонки: ['item_id', 'user_id', 'created_timestamp', 'last_status', 'target', 'timestamp', 'weight', 'user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'item_feat_0', 'item_feat_1', 'item_feat_2', 'item_feat_3', 'item_feat_4', 'item_feat_5', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'emb_12', 'emb_13', 'emb_14', 'emb_15', 'emb_16', 'emb_17', 'emb_18', 'emb_19', 'emb_20', 'emb_21', 'emb_22', 'emb_23', 'emb_24', 'emb_25', 'emb_26', 'emb_27', 'emb_28', 'emb_29', 'emb_30', 'emb_31', 'emb_32', 'emb_33', 'emb_34', 'emb_35', 'emb_36', 'emb_37', 'emb_38', 'emb_39', 'emb_40', 'emb_41', 'emb_42', 'emb_43', 'emb_44', 'emb_45', 'emb_46', 'emb_47', 'emb_48', 'emb_49', 'emb_50', 'emb_51', 'emb_52', 'emb_53', 'emb_54', 'emb_55', 'emb_56', 'emb_57', 'emb_58', 'emb_59', 'emb_60', 'emb_61', 'emb_62', 'emb_63', 'emb_64', 'emb_65', 'emb_66', 'emb_67', 'emb_68', 'emb_69', 'emb_70', 'emb_71', 'emb_72', 'emb_73', 'emb_74', 'emb_75', 'emb_76', 'emb_77', 'emb_78', 'emb_79', 'emb_80', 'emb_81', 'emb_82', 'emb_83', 'emb_84', 'emb_85', 'emb_86', 'emb_87', 'emb_88', 'emb_89', 'emb_90', 'emb_91', 'emb_92', 'emb_93', 'emb_94', 'emb_95', 'emb_96', 'emb_97', 'emb_98', 'emb_99', 'emb_100', 'emb_101', 'emb_102', 'emb_103', 'emb_104', 'emb_105', 'emb_106', 'emb_107', 'emb_108', 'emb_109', 'emb_110', 'emb_111', 'emb_112', 'emb_113', 'emb_114', 'emb_115', 'emb_116', 'emb_117', 'emb_118', 'emb_119', 'emb_120', 'emb_121', 'emb_122', 'emb_123', 'emb_124', 'emb_125', 'emb_126', 'emb_127', 'emb_128', 'emb_129', 'emb_130', 'emb_131', 'emb_132', 'emb_133', 'emb_134', 'emb_135', 'emb_136', 'emb_137', 'emb_138', 'emb_139', 'emb_140', 'emb_141', 'emb_142', 'emb_143', 'emb_144', 'emb_145', 'emb_146', 'emb_147', 'emb_148', 'emb_149', 'emb_150', 'emb_151', 'emb_152', 'emb_153', 'emb_154', 'emb_155', 'emb_156', 'emb_157', 'emb_158', 'emb_159', 'emb_160', 'emb_161', 'emb_162', 'emb_163', 'emb_164', 'emb_165', 'emb_166', 'emb_167', 'emb_168', 'emb_169', 'emb_170', 'emb_171', 'emb_172', 'emb_173', 'emb_174', 'emb_175', 'emb_176', 'emb_177', 'emb_178', 'emb_179', 'emb_180', 'emb_181', 'emb_182', 'emb_183', 'emb_184', 'emb_185', 'emb_186', 'emb_187', 'emb_188', 'emb_189', 'emb_190', 'emb_191', 'emb_192', 'emb_193', 'emb_194', 'emb_195', 'emb_196', 'emb_197', 'emb_198', 'emb_199']
[2025-09-03 00:06:27] ✅ Все признаки присутствуют
[2025-09-03 00:06:27] Целевая переменная: {1: np.int64(2965348), 0: np.int64(2395112)}
[2025-09-03 00:06:27] Пример первой строки:
[2025-09-03 00:06:27]   item_id: 215476411
[2025-09-03 00:06:27]   user_id: 3949260
[2025-09-03 00:06:27]   created_timestamp: 2025-05-13 22:35:37.643000
[2025-09-03 00:06:27]   last_status: canceled_orders
[2025-09-03 00:06:27]   target: 0
[2025-09-03 00:06:27]   timestamp: 2025-05-13 22:35:37.643000
[2025-09-03 00:06:27]   weight: 6.404669284820557
[2025-09-03 00:06:27]   user_count: 28.0
[2025-09-03 00:06:27]   user_mean: 6.13036661877055
[2025-09-03 00:06:27]   user_sum: 171.6502653255754
[2025-09-03 00:06:27]   user_max: 17.005986908310778
[2025-09-03 00:06:27]   user_min: 0.36464311358790924
[2025-09-03 00:06:27]   user_orders_count: 12.0
[2025-09-03 00:06:27]   item_feat_0: 6.404669284820557
[2025-09-03 00:06:27]   item_feat_1: 37.69453811645508
[2025-09-03 00:06:27]   item_feat_2: 3.0
[2025-09-03 00:06:27]   item_feat_3: 12.56484603881836
[2025-09-03 00:06:27]   item_feat_4: 3.0
[2025-09-03 00:06:27]   item_feat_5: 15.972915649414062
[2025-09-03 00:06:27]   emb_0: 2.174837112426758
[2025-09-03 00:06:27]   emb_1: 2.725212335586548
[2025-09-03 00:06:27]   emb_2: -0.5076518058776855
[2025-09-03 00:06:27]   emb_3: -2.080277442932129
[2025-09-03 00:06:27]   emb_4: -2.4923110008239746
[2025-09-03 00:06:27]   emb_5: 4.449596405029297
[2025-09-03 00:06:27]   emb_6: -0.1776481419801712
[2025-09-03 00:06:27]   emb_7: -1.5045936107635498
[2025-09-03 00:06:27]   emb_8: 0.5287789106369019
[2025-09-03 00:06:27]   emb_9: -2.779172897338867
[2025-09-03 00:06:27]   emb_10: -1.014644980430603
[2025-09-03 00:06:27]   emb_11: 2.9891951084136963
[2025-09-03 00:06:27]   emb_12: 2.1997318267822266
[2025-09-03 00:06:27]   emb_13: 3.6414637565612793
[2025-09-03 00:06:27]   emb_14: 2.049628496170044
[2025-09-03 00:06:27]   emb_15: 3.0170583724975586
[2025-09-03 00:06:27]   emb_16: 4.36802339553833
[2025-09-03 00:06:27]   emb_17: -0.72010338306427
[2025-09-03 00:06:27]   emb_18: -4.767380714416504
[2025-09-03 00:06:27]   emb_19: 0.6136386394500732
[2025-09-03 00:06:27]   emb_20: -0.7526886463165283
[2025-09-03 00:06:27]   emb_21: 0.1990957260131836
[2025-09-03 00:06:27]   emb_22: -0.975121259689331
[2025-09-03 00:06:27]   emb_23: 2.7897214889526367
[2025-09-03 00:06:27]   emb_24: 1.220414638519287
[2025-09-03 00:06:27]   emb_25: -1.6209337711334229
[2025-09-03 00:06:27]   emb_26: -2.370901584625244
[2025-09-03 00:06:27]   emb_27: 2.279755115509033
[2025-09-03 00:06:27]   emb_28: 1.794933795928955
[2025-09-03 00:06:27]   emb_29: 3.462658405303955
[2025-09-03 00:06:27]   emb_30: -3.523545503616333
[2025-09-03 00:06:27]   emb_31: -2.8767521381378174
[2025-09-03 00:06:27]   emb_32: 2.240309953689575
[2025-09-03 00:06:27]   emb_33: -2.3346734046936035
[2025-09-03 00:06:27]   emb_34: 1.1033806800842285
[2025-09-03 00:06:27]   emb_35: -0.2208922952413559
[2025-09-03 00:06:27]   emb_36: -2.667494773864746
[2025-09-03 00:06:27]   emb_37: -1.2955188751220703
[2025-09-03 00:06:27]   emb_38: 1.1226446628570557
[2025-09-03 00:06:27]   emb_39: 1.3083674907684326
[2025-09-03 00:06:27]   emb_40: -0.15999607741832733
[2025-09-03 00:06:27]   emb_41: 0.7406464219093323
[2025-09-03 00:06:27]   emb_42: 2.1461970806121826
[2025-09-03 00:06:27]   emb_43: -1.183038592338562
[2025-09-03 00:06:27]   emb_44: 6.236422538757324
[2025-09-03 00:06:27]   emb_45: -0.5892021059989929
[2025-09-03 00:06:27]   emb_46: 0.0825452134013176
[2025-09-03 00:06:27]   emb_47: 0.21313905715942383
[2025-09-03 00:06:27]   emb_48: -3.0711522102355957
[2025-09-03 00:06:27]   emb_49: 0.29149824380874634
[2025-09-03 00:06:27]   emb_50: -2.215409517288208
[2025-09-03 00:06:27]   emb_51: -2.4021904468536377
[2025-09-03 00:06:27]   emb_52: 0.8844202756881714
[2025-09-03 00:06:27]   emb_53: 0.3912297785282135
[2025-09-03 00:06:27]   emb_54: 2.6558098793029785
[2025-09-03 00:06:27]   emb_55: -0.9707613587379456
[2025-09-03 00:06:27]   emb_56: -1.3243358135223389
[2025-09-03 00:06:27]   emb_57: 3.1437015533447266
[2025-09-03 00:06:27]   emb_58: 0.6603620052337646
[2025-09-03 00:06:27]   emb_59: 0.2627074420452118
[2025-09-03 00:06:27]   emb_60: 0.8250616788864136
[2025-09-03 00:06:27]   emb_61: 0.9936395287513733
[2025-09-03 00:06:27]   emb_62: -1.349618673324585
[2025-09-03 00:06:27]   emb_63: -2.27775502204895
[2025-09-03 00:06:27]   emb_64: 1.0668545961380005
[2025-09-03 00:06:27]   emb_65: -0.5797327756881714
[2025-09-03 00:06:27]   emb_66: 2.0995094776153564
[2025-09-03 00:06:27]   emb_67: 1.7446057796478271
[2025-09-03 00:06:27]   emb_68: 0.7793245315551758
[2025-09-03 00:06:27]   emb_69: 1.7418708801269531
[2025-09-03 00:06:27]   emb_70: -0.15340793132781982
[2025-09-03 00:06:27]   emb_71: -1.0090700387954712
[2025-09-03 00:06:27]   emb_72: -2.1937613487243652
[2025-09-03 00:06:27]   emb_73: 1.3663239479064941
[2025-09-03 00:06:27]   emb_74: -0.2880702614784241
[2025-09-03 00:06:27]   emb_75: 0.5252217650413513
[2025-09-03 00:06:27]   emb_76: -2.0973424911499023
[2025-09-03 00:06:27]   emb_77: 1.0504405498504639
[2025-09-03 00:06:27]   emb_78: 0.48196324706077576
[2025-09-03 00:06:27]   emb_79: 1.6461971998214722
[2025-09-03 00:06:27]   emb_80: -0.022884225472807884
[2025-09-03 00:06:27]   emb_81: 1.171461820602417
[2025-09-03 00:06:27]   emb_82: -0.05701947584748268
[2025-09-03 00:06:27]   emb_83: -1.4985322952270508
[2025-09-03 00:06:27]   emb_84: 0.4696047306060791
[2025-09-03 00:06:27]   emb_85: -0.502737283706665
[2025-09-03 00:06:27]   emb_86: -0.7405084371566772
[2025-09-03 00:06:27]   emb_87: -1.6692112684249878
[2025-09-03 00:06:27]   emb_88: -0.7142674326896667
[2025-09-03 00:06:27]   emb_89: -0.7929842472076416
[2025-09-03 00:06:27]   emb_90: -1.872302770614624
[2025-09-03 00:06:27]   emb_91: -1.4154562950134277
[2025-09-03 00:06:27]   emb_92: 1.0169602632522583
[2025-09-03 00:06:27]   emb_93: 0.28487375378608704
[2025-09-03 00:06:27]   emb_94: -3.0819287300109863
[2025-09-03 00:06:27]   emb_95: -0.17129060626029968
[2025-09-03 00:06:27]   emb_96: -1.2360600233078003
[2025-09-03 00:06:27]   emb_97: -0.6151032447814941
[2025-09-03 00:06:27]   emb_98: 0.06044204905629158
[2025-09-03 00:06:27]   emb_99: 1.3379454612731934
[2025-09-03 00:06:27]   emb_100: 0.9583529829978943
[2025-09-03 00:06:27]   emb_101: 1.124708652496338
[2025-09-03 00:06:27]   emb_102: -0.8815711736679077
[2025-09-03 00:06:27]   emb_103: -1.0812373161315918
[2025-09-03 00:06:27]   emb_104: 0.7431570291519165
[2025-09-03 00:06:27]   emb_105: -0.20920729637145996
[2025-09-03 00:06:27]   emb_106: 2.052503824234009
[2025-09-03 00:06:27]   emb_107: -0.2610877752304077
[2025-09-03 00:06:27]   emb_108: -1.5195070505142212
[2025-09-03 00:06:27]   emb_109: 0.5691989660263062
[2025-09-03 00:06:27]   emb_110: -1.8947978019714355
[2025-09-03 00:06:27]   emb_111: -1.6084346771240234
[2025-09-03 00:06:27]   emb_112: 1.489450454711914
[2025-09-03 00:06:27]   emb_113: -0.7624396085739136
[2025-09-03 00:06:27]   emb_114: 0.8461754322052002
[2025-09-03 00:06:27]   emb_115: -0.0984509065747261
[2025-09-03 00:06:27]   emb_116: -1.908496379852295
[2025-09-03 00:06:27]   emb_117: 0.9357914924621582
[2025-09-03 00:06:27]   emb_118: -0.594343900680542
[2025-09-03 00:06:27]   emb_119: -1.4068360328674316
[2025-09-03 00:06:27]   emb_120: 1.4946198463439941
[2025-09-03 00:06:27]   emb_121: -0.3022277355194092
[2025-09-03 00:06:27]   emb_122: 0.5398320555686951
[2025-09-03 00:06:27]   emb_123: 0.07939913123846054
[2025-09-03 00:06:27]   emb_124: 0.8185805678367615
[2025-09-03 00:06:27]   emb_125: 1.1864962577819824
[2025-09-03 00:06:27]   emb_126: 1.125527024269104
[2025-09-03 00:06:27]   emb_127: 0.7447822093963623
[2025-09-03 00:06:27]   emb_128: -0.34647271037101746
[2025-09-03 00:06:27]   emb_129: -1.3589545488357544
[2025-09-03 00:06:27]   emb_130: -0.36414554715156555
[2025-09-03 00:06:27]   emb_131: 0.20352156460285187
[2025-09-03 00:06:27]   emb_132: -1.5023027658462524
[2025-09-03 00:06:27]   emb_133: -1.0926622152328491
[2025-09-03 00:06:27]   emb_134: -0.7508649826049805
[2025-09-03 00:06:27]   emb_135: 0.16839665174484253
[2025-09-03 00:06:27]   emb_136: -0.3630637228488922
[2025-09-03 00:06:27]   emb_137: 1.4643628597259521
[2025-09-03 00:06:27]   emb_138: 0.11532305181026459
[2025-09-03 00:06:27]   emb_139: 0.03936054930090904
[2025-09-03 00:06:27]   emb_140: 0.47407814860343933
[2025-09-03 00:06:27]   emb_141: 0.7737290859222412
[2025-09-03 00:06:27]   emb_142: -1.24817955493927
[2025-09-03 00:06:27]   emb_143: -0.250534325838089
[2025-09-03 00:06:27]   emb_144: -0.6871556043624878
[2025-09-03 00:06:27]   emb_145: 1.0212774276733398
[2025-09-03 00:06:27]   emb_146: 1.329571008682251
[2025-09-03 00:06:27]   emb_147: -0.5674809217453003
[2025-09-03 00:06:27]   emb_148: -1.181715488433838
[2025-09-03 00:06:27]   emb_149: -1.405572533607483
[2025-09-03 00:06:27]   emb_150: 0.24722474813461304
[2025-09-03 00:06:27]   emb_151: -0.9294465184211731
[2025-09-03 00:06:27]   emb_152: 2.0153965950012207
[2025-09-03 00:06:27]   emb_153: 1.145267367362976
[2025-09-03 00:06:27]   emb_154: 0.14526313543319702
[2025-09-03 00:06:27]   emb_155: -0.7844278812408447
[2025-09-03 00:06:27]   emb_156: -0.08574745059013367
[2025-09-03 00:06:27]   emb_157: -0.015765482559800148
[2025-09-03 00:06:27]   emb_158: 0.1652325838804245
[2025-09-03 00:06:27]   emb_159: -0.11589778959751129
[2025-09-03 00:06:27]   emb_160: 0.6194179058074951
[2025-09-03 00:06:27]   emb_161: -0.9800378084182739
[2025-09-03 00:06:27]   emb_162: -0.74760901927948
[2025-09-03 00:06:27]   emb_163: 0.6296977996826172
[2025-09-03 00:06:27]   emb_164: 0.8524183630943298
[2025-09-03 00:06:27]   emb_165: 0.5605802536010742
[2025-09-03 00:06:27]   emb_166: -0.19686490297317505
[2025-09-03 00:06:27]   emb_167: 0.310736745595932
[2025-09-03 00:06:27]   emb_168: 0.3836956024169922
[2025-09-03 00:06:27]   emb_169: 1.6881070137023926
[2025-09-03 00:06:27]   emb_170: -0.6238846182823181
[2025-09-03 00:06:27]   emb_171: 0.362649142742157
[2025-09-03 00:06:27]   emb_172: 0.7522951364517212
[2025-09-03 00:06:27]   emb_173: -0.7556260824203491
[2025-09-03 00:06:27]   emb_174: -0.22074644267559052
[2025-09-03 00:06:27]   emb_175: 0.08632470667362213
[2025-09-03 00:06:27]   emb_176: -1.6649272441864014
[2025-09-03 00:06:27]   emb_177: 0.5167726874351501
[2025-09-03 00:06:27]   emb_178: -0.5703766345977783
[2025-09-03 00:06:27]   emb_179: 0.5855849385261536
[2025-09-03 00:06:27]   emb_180: -0.4310172498226166
[2025-09-03 00:06:27]   emb_181: -0.07914742827415466
[2025-09-03 00:06:27]   emb_182: -0.16450536251068115
[2025-09-03 00:06:27]   emb_183: 0.7213140726089478
[2025-09-03 00:06:27]   emb_184: -0.37885582447052
[2025-09-03 00:06:27]   emb_185: -0.15913963317871094
[2025-09-03 00:06:27]   emb_186: -0.9851953983306885
[2025-09-03 00:06:27]   emb_187: 0.6399409770965576
[2025-09-03 00:06:27]   emb_188: 0.42032110691070557
[2025-09-03 00:06:27]   emb_189: 0.1363925039768219
[2025-09-03 00:06:27]   emb_190: -0.45517003536224365
[2025-09-03 00:06:27]   emb_191: -0.1067935898900032
[2025-09-03 00:06:27]   emb_192: 0.7795607447624207
[2025-09-03 00:06:27]   emb_193: 0.4538614749908447
[2025-09-03 00:06:27]   emb_194: -0.41880521178245544
[2025-09-03 00:06:27]   emb_195: -0.5642616748809814
[2025-09-03 00:06:27]   emb_196: 0.3132670521736145
[2025-09-03 00:06:27]   emb_197: -0.6669920086860657
[2025-09-03 00:06:27]   emb_198: 0.7915345430374146
[2025-09-03 00:06:27]   emb_199: 0.22698910534381866
[2025-09-03 00:06:27] Feature columns: ['user_count', 'user_mean', 'user_sum', 'user_max', 'user_min', 'user_orders_count', 'item_feat_0', 'item_feat_1', 'item_feat_2', 'item_feat_3', 'item_feat_4', 'item_feat_5', 'emb_0', 'emb_1', 'emb_2', 'emb_3', 'emb_4', 'emb_5', 'emb_6', 'emb_7', 'emb_8', 'emb_9', 'emb_10', 'emb_11', 'emb_12', 'emb_13', 'emb_14', 'emb_15', 'emb_16', 'emb_17', 'emb_18', 'emb_19', 'emb_20', 'emb_21', 'emb_22', 'emb_23', 'emb_24', 'emb_25', 'emb_26', 'emb_27', 'emb_28', 'emb_29', 'emb_30', 'emb_31', 'emb_32', 'emb_33', 'emb_34', 'emb_35', 'emb_36', 'emb_37', 'emb_38', 'emb_39', 'emb_40', 'emb_41', 'emb_42', 'emb_43', 'emb_44', 'emb_45', 'emb_46', 'emb_47', 'emb_48', 'emb_49', 'emb_50', 'emb_51', 'emb_52', 'emb_53', 'emb_54', 'emb_55', 'emb_56', 'emb_57', 'emb_58', 'emb_59', 'emb_60', 'emb_61', 'emb_62', 'emb_63', 'emb_64', 'emb_65', 'emb_66', 'emb_67', 'emb_68', 'emb_69', 'emb_70', 'emb_71', 'emb_72', 'emb_73', 'emb_74', 'emb_75', 'emb_76', 'emb_77', 'emb_78', 'emb_79', 'emb_80', 'emb_81', 'emb_82', 'emb_83', 'emb_84', 'emb_85', 'emb_86', 'emb_87', 'emb_88', 'emb_89', 'emb_90', 'emb_91', 'emb_92', 'emb_93', 'emb_94', 'emb_95', 'emb_96', 'emb_97', 'emb_98', 'emb_99', 'emb_100', 'emb_101', 'emb_102', 'emb_103', 'emb_104', 'emb_105', 'emb_106', 'emb_107', 'emb_108', 'emb_109', 'emb_110', 'emb_111', 'emb_112', 'emb_113', 'emb_114', 'emb_115', 'emb_116', 'emb_117', 'emb_118', 'emb_119', 'emb_120', 'emb_121', 'emb_122', 'emb_123', 'emb_124', 'emb_125', 'emb_126', 'emb_127', 'emb_128', 'emb_129', 'emb_130', 'emb_131', 'emb_132', 'emb_133', 'emb_134', 'emb_135', 'emb_136', 'emb_137', 'emb_138', 'emb_139', 'emb_140', 'emb_141', 'emb_142', 'emb_143', 'emb_144', 'emb_145', 'emb_146', 'emb_147', 'emb_148', 'emb_149', 'emb_150', 'emb_151', 'emb_152', 'emb_153', 'emb_154', 'emb_155', 'emb_156', 'emb_157', 'emb_158', 'emb_159', 'emb_160', 'emb_161', 'emb_162', 'emb_163', 'emb_164', 'emb_165', 'emb_166', 'emb_167', 'emb_168', 'emb_169', 'emb_170', 'emb_171', 'emb_172', 'emb_173', 'emb_174', 'emb_175', 'emb_176', 'emb_177', 'emb_178', 'emb_179', 'emb_180', 'emb_181', 'emb_182', 'emb_183', 'emb_184', 'emb_185', 'emb_186', 'emb_187', 'emb_188', 'emb_189', 'emb_190', 'emb_191', 'emb_192', 'emb_193', 'emb_194', 'emb_195', 'emb_196', 'emb_197', 'emb_198', 'emb_199']
[2025-09-03 00:06:27] 📊 Всего данных для обработки: 13896566 строк
[2025-09-03 00:06:27] 📦 Чанк 1/14 (1000000 строк)
[2025-09-03 00:08:36] 💾 Модель сохранена после чанка 1
[2025-09-03 00:08:36] 📦 Чанк 2/14 (1000000 строк)
[2025-09-03 00:09:48] 💾 Модель сохранена после чанка 2
[2025-09-03 00:09:48] 📦 Чанк 3/14 (1000000 строк)
[2025-09-03 00:10:10] 💾 Модель сохранена после чанка 3
[2025-09-03 00:10:10] 📦 Чанк 4/14 (1000000 строк)
[2025-09-03 00:11:23] 💾 Модель сохранена после чанка 4
[2025-09-03 00:11:23] 📦 Чанк 5/14 (1000000 строк)
[2025-09-03 00:12:36] 💾 Модель сохранена после чанка 5
[2025-09-03 00:12:36] 📦 Чанк 6/14 (1000000 строк)
[2025-09-03 00:13:51] 💾 Модель сохранена после чанка 6
[2025-09-03 00:13:51] 📦 Чанк 7/14 (1000000 строк)
[2025-09-03 00:15:06] 💾 Модель сохранена после чанка 7
[2025-09-03 00:15:06] 📦 Чанк 8/14 (1000000 строк)
[2025-09-03 00:16:25] 💾 Модель сохранена после чанка 8
[2025-09-03 00:16:25] 📦 Чанк 9/14 (1000000 строк)
[2025-09-03 00:17:47] 💾 Модель сохранена после чанка 9
[2025-09-03 00:17:48] 📦 Чанк 10/14 (1000000 строк)
[2025-09-03 00:19:05] 💾 Модель сохранена после чанка 10
[2025-09-03 00:19:05] 📦 Чанк 11/14 (1000000 строк)
[2025-09-03 00:19:38] 💾 Модель сохранена после чанка 11
[2025-09-03 00:19:38] 📦 Чанк 12/14 (1000000 строк)
[2025-09-03 00:20:09] 💾 Модель сохранена после чанка 12
[2025-09-03 00:20:09] 📦 Чанк 13/14 (1000000 строк)
[2025-09-03 00:20:40] 💾 Модель сохранена после чанка 13
[2025-09-03 00:20:40] 📦 Чанк 14/14 (896566 строк)
[2025-09-03 00:21:13] 💾 Модель сохранена после чанка 14
[2025-09-03 00:24:27] 🎯 Финальный NDCG@100 на валидации: 0.906366
[2025-09-03 00:24:27] Обучение модели завершено за 0:18:19.738738
[2025-09-03 00:24:27] === СОХРАНЕНИЕ МОДЕЛИ И ПРИЗНАКОВ ===
[2025-09-03 00:24:56] Сохранение модели завершено за 0:00:28.628367
[2025-09-03 00:24:56] Модель сохранена в: /home/root6/python/e_cup/rec_system/src/models/model.pkl
[2025-09-03 00:24:56] === ОБУЧЕНИЕ И ПРЕДСКАЗАНИЯ ЗАВЕРШЕНЫ УСПЕШНО ===
[2025-09-03 00:24:56] Общее время выполнения: 0:26:41.724394
[2025-09-03 00:24:56] Пользователей: 960818
[2025-09-03 00:24:56] Товаров: 3972133
[2025-09-03 00:24:56] Признаков: 212
[2025-09-03 00:24:56] === СИСТЕМНАЯ ИНФОРМАЦИЯ ===
[2025-09-03 00:24:56] Видеокарта: NVIDIA GeForce RTX 4090
[2025-09-03 00:24:56] Память GPU: 24.0 GB
[2025-09-03 00:24:56] Процессор: 24.3% загрузки
[2025-09-03 00:24:56] Ядра CPU: 32
[2025-09-03 00:24:56] Частота CPU: 2995.2 MHz
[2025-09-03 00:24:56] Оперативная память: 94.2 GB всего, 74.2 GB использовано
[2025-09-03 00:24:56] ==========================================
[2025-09-03 00:24:56] ВСЕ ЭТАПЫ ВЫПОЛНЕНЫ УСПЕШНО!
[2025-09-03 00:24:56] ==========================================

=== ОБЩЕЕ ВРЕМЯ ВЫПОЛНЕНИЯ: 0:26:41.752115 ===
